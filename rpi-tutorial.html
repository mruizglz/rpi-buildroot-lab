

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SCOPE &mdash; Example 0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=2709fde1"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="More features here" href="another-feature.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Example
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="some-feature.html">Some feature</a></li>
<li class="toctree-l1"><a class="reference internal" href="another-feature.html">More features here</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">SCOPE</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#document-overview">Document Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#acronyms">Acronyms</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#referenced-documents">REFERENCED DOCUMENTS</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#building-linux-using-buildroot">Building linux using buildroot</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#elements-needed-for-the-execution-of-these-labs">Elements needed for the execution of these LABS</a></li>
<li class="toctree-l2"><a class="reference internal" href="#starting-the-vmware">Starting the VMware</a></li>
<li class="toctree-l2"><a class="reference internal" href="#configuring-buildroot-for-rpi3">Configuring Buildroot for RPI3.</a></li>
<li class="toctree-l2"><a class="reference internal" href="#compiling-buildroot">Compiling buildroot</a></li>
<li class="toctree-l2"><a class="reference internal" href="#buildroot-output">Buildroot Output.</a></li>
<li class="toctree-l2"><a class="reference internal" href="#booting-the-raspberry-pi">Booting the Raspberry Pi.</a></li>
<li class="toctree-l2"><a class="reference internal" href="#connecting-the-rpi-to-the-network">Connecting the RPI to the network</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#inspecting-the-configuration-of-the-network-interface-generated-automatically-by-buildroot">Inspecting the configuration of the network interface generated automatically by Buildroot</a></li>
<li class="toctree-l3"><a class="reference internal" href="#adding-wifi-support">Adding WIFI support</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#adding-the-broadcom-firmware-support-for-wireless-hardware">Adding the Broadcom firmware support for Wireless hardware</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#using-the-integrated-development-environment-eclipse-cdt">Using the integrated development environment Eclipse/CDT</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#eclipse-ide-for-c-c-developers">Eclipse IDE for C/C++ developers</a></li>
<li class="toctree-l2"><a class="reference internal" href="#cross-compiling-applications-using-eclipse">Cross-Compiling applications using Eclipse</a></li>
<li class="toctree-l2"><a class="reference internal" href="#building-a-project">Building a project</a></li>
<li class="toctree-l2"><a class="reference internal" href="#moving-the-binary-to-the-target">Moving the binary to the target</a></li>
<li class="toctree-l2"><a class="reference internal" href="#executing-the-application">Executing the application</a></li>
<li class="toctree-l2"><a class="reference internal" href="#automatic-debugging-using-gdb-and-gdbserver">Automatic debugging using gdb and gdbserver</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#preparing-the-linux-virtual-machine">Preparing the linux virtual machine.</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#download-vmware-workstation-player">Download VMware Workstation Player.</a></li>
<li class="toctree-l2"><a class="reference internal" href="#installing-ubuntu-22-04-lts-as-a-virtual-machine">Installing Ubuntu 22.04 LTS as a virtual machine.</a></li>
<li class="toctree-l2"><a class="reference internal" href="#installing-synaptic">Installing synaptic</a></li>
<li class="toctree-l2"><a class="reference internal" href="#installing-putty">Installing putty</a></li>
<li class="toctree-l2"><a class="reference internal" href="#installing-packages-for-supporting-buildroot">Installing packages for supporting Buildroot.</a></li>
<li class="toctree-l2"><a class="reference internal" href="#installing-packages-supporting-eclipse">Installing packages supporting Eclipse</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Example</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">SCOPE</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/rpi-tutorial.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <img alt="_images/image1.jpeg" src="_images/image1.jpeg" />
<p><strong>Acknowledgements</strong></p>
<p>This document is based on a previous work of Dr. Sergio Esquembri and
Dr. Francisco Javier Jiménez from the Department of Telematics and
Electronics Engineering of Madrid’s Technical University using RPI Model
B.</p>
<p><a class="reference internal" href="_images/image2.png"><img alt="image1" src="_images/image2.png" style="width: 0.91667in; height: 0.32292in;" /></a>Embedded Linux Systems: Using Buildroot for building Embedded
Linux Systems on Raspberry Pi 3 Model B by Mariano Ruiz is licensed
under a <a class="reference external" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International
License</a>.</p>
<p>Table of contents</p>
<p><a class="reference external" href="#scope">1 SCOPE</a> <a class="reference external" href="#scope">5</a></p>
<p><a class="reference external" href="#document-overview">1.1 Document Overview</a>
<a class="reference external" href="#document-overview">5</a></p>
<p><a class="reference external" href="#acronyms">1.2 Acronyms</a> <a class="reference external" href="#acronyms">5</a></p>
<p><a class="reference external" href="#referenced-documents">2 REFERENCED DOCUMENTS</a>
<a class="reference external" href="#referenced-documents">6</a></p>
<p><a class="reference external" href="#references">2.1 References</a> <a class="reference external" href="#references">6</a></p>
<p><a class="reference external" href="#building-linux-using-buildroot">3 Building linux using buildroot</a>
<a class="reference external" href="#building-linux-using-buildroot">7</a></p>
<p><a class="reference external" href="#elements-needed-for-the-execution-of-these-labs">3.1 Elements needed for the execution of these
LABS</a>
<a class="reference external" href="#elements-needed-for-the-execution-of-these-labs">7</a></p>
<p><a class="reference external" href="#starting-the-vmware">3.2 Starting the VMware</a>
<a class="reference external" href="#starting-the-vmware">7</a></p>
<p><a class="reference external" href="#configuring-buildroot-for-rpi3.">3.3 Configuring Buildroot for
RPI3.</a>
<a class="reference external" href="#configuring-buildroot-for-rpi3.">11</a></p>
<p><a class="reference external" href="#compiling-buildroot">3.4 Compiling buildroot</a>
<a class="reference external" href="#compiling-buildroot">15</a></p>
<p><a class="reference external" href="#buildroot-output.">3.5 Buildroot Output.</a>
<a class="reference external" href="#buildroot-output.">16</a></p>
<p><a class="reference external" href="#booting-the-raspberry-pi.">3.6 Booting the Raspberry Pi.</a>
<a class="reference external" href="#booting-the-raspberry-pi.">17</a></p>
<p><a class="reference external" href="#connecting-the-rpi-to-the-network">3.7 Connecting the RPI to the
network</a>
<a class="reference external" href="#connecting-the-rpi-to-the-network">23</a></p>
<p><a class="reference external" href="#inspecting-the-configuration-of-the-network-interface-generated-automatically-by-buildroot">3.7.1 Inspecting the configuration of the network interface generated
automatically by
Buildroot</a>
<a class="reference external" href="#inspecting-the-configuration-of-the-network-interface-generated-automatically-by-buildroot">23</a></p>
<p><a class="reference external" href="#adding-wifi-support">3.7.2 Adding WIFI support</a>
<a class="reference external" href="#adding-wifi-support">23</a></p>
<p><a class="reference external" href="#using-the-integrated-development-environment-eclipsecdt">4 Using the integrated development environment
Eclipse/CDT</a>
<a class="reference external" href="#using-the-integrated-development-environment-eclipsecdt">26</a></p>
<p><a class="reference external" href="#eclipse-ide-for-cc-developers">4.1 Eclipse IDE for C/C++
developers</a>
<a class="reference external" href="#eclipse-ide-for-cc-developers">26</a></p>
<p><a class="reference external" href="#cross-compiling-applications-using-eclipse">4.2 Cross-Compiling applications using
Eclipse</a>
<a class="reference external" href="#cross-compiling-applications-using-eclipse">26</a></p>
<p><a class="reference external" href="#building-a-project">4.3 Building a project</a>
<a class="reference external" href="#building-a-project">32</a></p>
<p><a class="reference external" href="#moving-the-binary-to-the-target">4.4 Moving the binary to the
target</a>
<a class="reference external" href="#moving-the-binary-to-the-target">32</a></p>
<p><a class="reference external" href="#executing-the-application">4.5 Executing the application</a>
<a class="reference external" href="#executing-the-application">33</a></p>
<p><a class="reference external" href="#_Toc151662631">4.6 Automatic debugging using gdb and gdbserver</a>
<a class="reference external" href="#_Toc151662631">33</a></p>
<p><a class="reference external" href="#preparing-the-linux-virtual-machine.">5 Preparing the linux virtual
machine.</a>
<a class="reference external" href="#preparing-the-linux-virtual-machine.">36</a></p>
<p><a class="reference external" href="#download-vmware-workstation-player.">5.1 Download VMware Workstation
Player.</a>
<a class="reference external" href="#download-vmware-workstation-player.">36</a></p>
<p><a class="reference external" href="#installing-ubuntu-22.04-lts-as-a-virtual-machine.">5.2 Installing Ubuntu 22.04 LTS as a virtual
machine.</a>
<a class="reference external" href="#installing-ubuntu-22.04-lts-as-a-virtual-machine.">36</a></p>
<p><a class="reference external" href="#installing-synaptic">5.3 Installing synaptic</a>
<a class="reference external" href="#installing-synaptic">36</a></p>
<p><a class="reference external" href="#installing-putty">5.4 Installing putty</a> <a class="reference external" href="#installing-putty">37</a></p>
<p><a class="reference external" href="#installing-packages-for-supporting-buildroot.">5.5 Installing packages for supporting
Buildroot.</a>
<a class="reference external" href="#installing-packages-for-supporting-buildroot.">37</a></p>
<p><a class="reference external" href="#installing-packages-supporting-eclipse">5.6 Installing packages supporting
Eclipse</a>
<a class="reference external" href="#installing-packages-supporting-eclipse">37</a></p>
<p>Table of Figures</p>
<p><a class="reference external" href="#_Ref353119861">Fig. 1: Main screen of VMware player with some VM available to be
executed.</a> <a class="reference external" href="#_Ref353119861">7</a></p>
<p><a class="reference external" href="#_Ref353085968">Fig. 2: Ubuntu Virtual Machine login screen.</a>
<a class="reference external" href="#_Ref353085968">8</a></p>
<p><a class="reference external" href="#_Ref353086138">Fig. 3 Buildroot home page.</a> <a class="reference external" href="#_Ref353086138">8</a></p>
<p><a class="reference external" href="#_Ref353086156">Fig. 4: Example of Downloading buildroot source
code.</a> <a class="reference external" href="#_Ref353086156">9</a></p>
<p><a class="reference external" href="#_Ref353086170">Fig. 5: Buildroot folder (the folder name depends on the version
downloaded).</a> <a class="reference external" href="#_Ref353086170">10</a></p>
<p><a class="reference external" href="#_Ref409608190">Fig. 6: Dash home, Terminal application</a>
<a class="reference external" href="#_Ref409608190">10</a></p>
<p><a class="reference external" href="#_Ref353086440">Fig. 7: Buildroot setup screen.</a>
<a class="reference external" href="#_Ref353086440">11</a></p>
<p><a class="reference external" href="#_Ref383685240">Fig. 8: Successful compilation and installation of
Buildroot</a> <a class="reference external" href="#_Ref383685240">16</a></p>
<p><a class="reference external" href="#_Ref353089093">Fig. 9: Schematic representation of the Buildroot tool. Buildroot
generates the root file system, the kernel image, the bootloader, and
the toolchain. Figure copied from “Bootlin” training materials
(http://bootlin.com/training/)</a>
<a class="reference external" href="#_Ref353089093">17</a></p>
<p><a class="reference external" href="#_Ref353089256">Fig. 10: images folder contains the binary files for our embedded
system.</a> <a class="reference external" href="#_Ref353089256">17</a></p>
<p><a class="reference external" href="#_Ref354210616">Fig. 11: RaspBerry-Pi 3 Model B+ hardware with main elements
identified.</a> <a class="reference external" href="#_Ref354210616">18</a></p>
<p><a class="reference external" href="#_Ref386001936">Fig. 12: Raspberry-PI 3 header terminal identification. The figure
displays a PI 3 B model.</a> <a class="reference external" href="#_Ref386001936">19</a></p>
<p><a class="reference external" href="#_Ref387343959">Fig. 13: Identification of the terminals in the USB-RS232
adapter</a> <a class="reference external" href="#_Ref387343959">19</a></p>
<p><a class="reference external" href="#_Ref383690275">Fig. 14: Booting process for BCM2837 processor in the
raspberry-pi.</a> <a class="reference external" href="#_Ref383690275">20</a></p>
<p><a class="reference external" href="#_Ref353103213">Fig. 15: Putty program main window.</a>
<a class="reference external" href="#_Ref353103213">22</a></p>
<p><a class="reference external" href="#_Ref511397037">Fig. 16: Linux Running</a> <a class="reference external" href="#_Ref511397037">22</a></p>
<p><a class="reference external" href="#_Ref409071414">Fig. 17: Summary of the different configurations for developing
applications for embedded systems. Figure copied from “Free Electrons”
training materials
(http://free-electrons.com/training/)</a>
<a class="reference external" href="#_Ref409071414">26</a></p>
<p><a class="reference external" href="#_Ref409071789">Fig. 18: Cross-compiling tools installed in the host
computer</a> <a class="reference external" href="#_Ref409071789">27</a></p>
<p><a class="reference external" href="#_Ref355001929">Fig. 19: Selection of the workspace for Eclipse. Use a folder in your
account.</a> <a class="reference external" href="#_Ref355001929">27</a></p>
<p><a class="reference external" href="#_Ref461353829">Fig. 20: Eclipse welcome window.</a>
<a class="reference external" href="#_Ref461353829">28</a></p>
<p><a class="reference external" href="#_Ref355002728">Fig. 21: Eclipse main window.</a>
<a class="reference external" href="#_Ref355002728">28</a></p>
<p><a class="reference external" href="#_Toc66034109">Fig. 22: Basic C project creation in Eclipse</a>
<a class="reference external" href="#_Toc66034109">29</a></p>
<p><a class="reference external" href="#_Toc66034110">Fig. 23: Cross-compiler prefix and path window.</a>
<a class="reference external" href="#_Toc66034110">30</a></p>
<p><a class="reference external" href="#_Toc66034111">Fig. 24: Hello world example.</a> <a class="reference external" href="#_Toc66034111">30</a></p>
<p><a class="reference external" href="#_Toc66034112">Fig. 25: ToolChain Editor should be configured to use Cross
GCC.</a> <a class="reference external" href="#_Toc66034112">31</a></p>
<p><a class="reference external" href="#_Toc66034113">Fig. 26: Cross tools locate on (path). The path shown in this figure is
an example. Use always the path of your toolchain.</a>
<a class="reference external" href="#_Toc66034113">31</a></p>
<p><a class="reference external" href="#_Toc66034114">Fig. 27: Include search path.</a> <a class="reference external" href="#_Toc66034114">32</a></p>
<p><a class="reference external" href="#_Toc66034115">Fig. 28: Libraries search path.</a>
<a class="reference external" href="#_Toc66034115">32</a></p>
<p><a class="reference external" href="#_Ref355010294">Fig. 29: Eclipse project compiled (Binaries has been
generated)</a> <a class="reference external" href="#_Ref355010294">33</a></p>
<p><a class="reference external" href="#_Toc463513961">Fig. 30: “Connect to Server” option in Nautilus
explorer</a> <a class="reference external" href="#_Toc463513961">33</a></p>
<p><a class="reference external" href="#_Toc409091131">Fig. 31: Run test program in Raspberry Pi</a>
<a class="reference external" href="#_Toc409091131">34</a></p>
<p><a class="reference external" href="#_Toc66034119">Fig. 32: Installing additional software in Eclipse</a>
<a class="reference external" href="#_Toc66034119">34</a></p>
<p><a class="reference external" href="#_Ref355014847">Fig. 33: Creating a Debug Configuration</a>
<a class="reference external" href="#_Ref355014847">35</a></p>
<p><a class="reference external" href="#_Ref355015023">Fig. 34: Debug configuration, including the path to locate the cross
gdb tool.</a> <a class="reference external" href="#_Ref355015023">36</a></p>
<p><a class="reference external" href="#_Toc66034122">Fig. 35: Synaptic program from Dash</a>
<a class="reference external" href="#_Toc66034122">38</a></p>
<p><a class="reference external" href="#_Toc472955046">Fig. 36: Synaptic windows</a> <a class="reference external" href="#_Toc472955046">38</a></p>
<section id="scope">
<h1>SCOPE<a class="headerlink" href="#scope" title="Link to this heading"></a></h1>
<p>T</p>
<section id="document-overview">
<h2>Document Overview<a class="headerlink" href="#document-overview" title="Link to this heading"></a></h2>
<p>This document describes the steps to develop an embedded Linux-based
system using the Raspberry PI board. The document has been specifically
written to use a Raspberry PI development system based on the BCM2837
processor. All the software elements used have a GPL license.</p>
<table class="docutils align-default" id="id1">
<caption><span class="caption-text">Table I: Parameters for Buildroot configuration</span><a class="headerlink" href="#id1" title="Link to this table"></a></caption>
<thead>
<tr class="row-odd"><th class="head"><p><a href="#id3"><span class="problematic" id="id4">|im
age2|</span></a></p></th>
<th class="head"><p><strong>[Time to complete the tutorial]:</strong> The time necessary to
complete all the tutorial steps is approximately 8 hours.</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
<td></td>
</tr>
</tbody>
</table>
<p>Read all the instructions carefully before executing the practical part;
otherwise, you will find errors and probably unpredicted errors. In
parallel, you need to review the slides available at the Moodle site or
at [RD1]</p>
</section>
<section id="acronyms">
<h2>Acronyms<a class="headerlink" href="#acronyms" title="Link to this heading"></a></h2>
<table class="docutils align-default" id="id2">
<caption><span class="caption-text">Table 2: Makefile and files for cross-compilation</span><a class="headerlink" href="#id2" title="Link to this table"></a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>CPU</p></th>
<th class="head"><p>Central Processing Unit</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>EABI</p></td>
<td><p>Extended Application Binary Interface</p></td>
</tr>
<tr class="row-odd"><td><p>EHCI</p></td>
<td><p>Enhanced Host Controller Interface</p></td>
</tr>
<tr class="row-even"><td><p>I/O</p></td>
<td><p>Input and Output</p></td>
</tr>
<tr class="row-odd"><td><p>MMC</p></td>
<td><p>Multimedia card</p></td>
</tr>
<tr class="row-even"><td><p>NAND</p></td>
<td><p>Flash memory type for fast sequential read and write</p></td>
</tr>
<tr class="row-odd"><td><p>PCI</p></td>
<td><p>Peripheral Component Interconnect – computer bus standard</p></td>
</tr>
<tr class="row-even"><td><p>PCI
Express</p></td>
<td><p>Peripheral Component Interconnect Express</p></td>
</tr>
<tr class="row-odd"><td><p>OS</p></td>
<td><p>Operating system</p></td>
</tr>
<tr class="row-even"><td><p>UART</p></td>
<td><p>Universal Asynchronous Receiver Transmitter</p></td>
</tr>
<tr class="row-odd"><td><p>USB</p></td>
<td><p>Universal Serial Bus</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="referenced-documents">
<h1>REFERENCED DOCUMENTS<a class="headerlink" href="#referenced-documents" title="Link to this heading"></a></h1>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Link to this heading"></a></h2>
<ol class="arabic">
<li><p>Embedded Linux system development.</p>
<p>Slides at
<a class="reference external" href="https://moodle.upm.es/titulaciones/oficiales/course/view.php">https://moodle.upm.es/titulaciones/oficiales/course/view.php</a>?id=&lt;yourcourse&gt;</p>
</li>
<li><p><a class="reference external" href="https://bootlin.com/training/embedded-linux/">https://bootlin.com/training/embedded-linux/</a></p></li>
<li><p>Mastering Embedded Linux Programming - Second Edition. Packt.
<a class="reference external" href="https://www.packtpub.com/product/mastering-embedded-linux-programming-second-edition/9781787283282">https://www.packtpub.com/product/mastering-embedded-linux-programming-second-edition/9781787283282</a></p></li>
<li><p>Raspberry-Pi User Guide. Reference Manual.</p>
<p><a class="reference external" href="http://www.myraspberry-pi.org/wp-content/.../Raspberry.Pi_.User_.Guide_.pdf‎">www.myraspberry-pi.org/wp-content/…/Raspberry.Pi_.User_.Guide_.pdf‎</a></p>
</li>
</ol>
</section>
</section>
<section id="building-linux-using-buildroot">
<h1>Building linux using buildroot<a class="headerlink" href="#building-linux-using-buildroot" title="Link to this heading"></a></h1>
<section id="elements-needed-for-the-execution-of-these-labs">
<h2>Elements needed for the execution of these LABS<a class="headerlink" href="#elements-needed-for-the-execution-of-these-labs" title="Link to this heading"></a></h2>
<p>In order to execute this lab properly, you need the following elements:</p>
<ol class="arabic simple">
<li><p>The VMware player software version 16.0 or above. Available at
<a class="reference external" href="http://www.wmware.com">www.wmware.com</a> (free download and use).
This software has already been installed on the laboratory desktop
computer.</p></li>
<li><p>A VMWare virtual machine with Ubuntu 22.04 and all the software
packages installed is already available on the Desktop. This virtual
machine is available for your personal use. If you want to set up
your virtual machine by yourself, follow the instructions provided in
<a class="reference external" href="#_annex_i:_Ubuntu">Annex I</a>.</p></li>
<li><p>A Raspberry Pi, accessories and a USB cable are available at the
laboratory.</p></li>
<li><p>Basic knowledge of Linux commands.</p></li>
</ol>
</section>
<section id="starting-the-vmware">
<h2>Starting the VMware<a class="headerlink" href="#starting-the-vmware" title="Link to this heading"></a></h2>
<p>Start VMware Player and open the RPI Virtual Machine. Wait until the
welcome screen is displayed (see Fig. 1 and Fig. 2). Login as
“<em>ubuntu”</em> user using the password “ubuntu”.</p>
<a class="reference internal image-reference" href="_images/image4.png"><img alt="A screenshot of a computer Description automatically generated" src="_images/image4.png" style="width: 4.92027in; height: 3.97031in;" />
</a>
<p>Fig. 1: Main screen of VMware player with some VM available to be
executed.</p>
<a class="reference internal image-reference" href="_images/image5.png"><img alt="A screenshot of a computer Description automatically generated" src="_images/image5.png" style="width: 6.69375in; height: 3.69514in;" />
</a>
<p>Fig. 2: Ubuntu Virtual Machine login screen.</p>
<p>Open the <strong>Firefox</strong> web browser and download from
<a class="reference external" href="https://buildroot.org/">https://buildroot.org/</a>, the version identified as <strong>buidlroot2023-08-3</strong>
(use the download link, see Fig. 3, and navigate searching for earlier
releases if necessary, <a class="reference external" href="https://buildroot.org/downloads/">https://buildroot.org/downloads/</a> ). Save the file
to the <strong>Documents</strong> folder in your account (Fig. 4).</p>
<a class="reference internal image-reference" href="_images/image6.png"><img alt="_images/image6.png" src="_images/image6.png" style="width: 5.97015in; height: 4.03801in;" />
</a>
<p>Fig. 3 Buildroot home page.</p>
<p>Buildroot is a tool to generate embedded Linux systems in our PC, and
then this Linux will be installed in the target.</p>
<a class="reference internal image-reference" href="_images/image7.png"><img alt="_images/image7.png" src="_images/image7.png" style="width: 5.25472in; height: 3.28499in;" />
</a>
<p>Fig. 4: Example of Downloading buildroot source code.</p>
<p>Create a folder “rpi” in “Documentes”. Copy the file to the
“Documents/rpi” folder and decompress the file (Fig. 5).</p>
<a class="reference internal image-reference" href="_images/image8.png"><img alt="A screenshot of a computer Description automatically generated" src="_images/image8.png" style="width: 6.69375in; height: 3.43958in;" />
</a>
<p>Fig. 5: Buildroot folder (the folder name depends on the version
downloaded).</p>
<p>Right-click in the window and execute “Open in Terminal” or execute the
Terminal application from Dash home as shown in Fig. 6 (if “Open in
Terminal” is not available, search how to install it in Ubuntu).</p>
<a class="reference internal image-reference" href="_images/image9.png"><img alt="_images/image9.png" src="_images/image9.png" style="width: 4.20139in; height: 3.25347in;" />
</a>
<p>Fig. 6: Dash home, Terminal application</p>
<p>In some seconds, a command window is displayed. Then, execute these
commands:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><a href="#id5"><span class="problematic" id="id6">|im
age3|</span></a></p></th>
<th class="head"><p><strong>[Help]:</strong> For this course, you will need to become
familiar with the Linux Terminal use. On the Moodle site of
this course, you can find a cheat sheet with the basic Linux
commands.</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
<td></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><a href="#id7"><span class="problematic" id="id8">|im
age4|</span></a></p></th>
<th class="head"><p><strong>[Help]:</strong> In a Linux terminal, the “TAB” key helps you to
autocomplete the commands, folders, and file names. You can
find a description of “make” application at this link
<a class="reference external" href="https://www.gnu.org/software/make/manual/make.pdf">https://www.gnu.org/software/make/manual/make.pdf</a></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
<td></td>
</tr>
</tbody>
</table>
<p>In some seconds, you will see a new window similar to Fig. 7.</p>
<a class="reference internal image-reference" href="_images/image10.png"><img alt="A screenshot of a computer Description automatically generated" src="_images/image10.png" style="width: 6.69375in; height: 3.20208in;" />
</a>
<p>Fig. 7: Buildroot setup screen.</p>
</section>
<section id="configuring-buildroot-for-rpi3">
<h2>Configuring Buildroot for RPI3.<a class="headerlink" href="#configuring-buildroot-for-rpi3" title="Link to this heading"></a></h2>
<p>Once the <strong>Buildroot</strong> configuration is started, it is necessary to
configure the different items. You need to navigate the different menus
and select the installation elements. Table I contains the specific
configuration of <strong>Buildroot</strong> for installing it in the Raspberry Pi.
Depending on the downloaded version, the organization and the items
displayed can differ. If an item of buildroot configuration does not
appear in the Table I leaves it with its default value.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><a href="#id9"><span class="problematic" id="id10">|im
age5|</span></a></p></th>
<th class="head"><p><strong>[Help]:</strong> The Buildroot configuration is an iterative
process. In order to set up your embedded Linux system, you
will need to execute the configuration several times.</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
<td></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Main
Item</strong></p></th>
<th class="head"><p><strong>Subitem</strong></p></th>
<th class="head"><p><strong>Value</strong></p></th>
<th class="head"><p><strong>Comments</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>T
arget</strong>
options</p></td>
<td><p>Target
A
rchitecture</p></td>
<td><p>AArch64 (little endian)</p></td>
<td><p>ARM 64 bits</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>Target
A
rchitecture
Variant</p></td>
<td><p>Cortex-A53</p></td>
<td></td>
</tr>
<tr class="row-even"><td></td>
<td><p>Flo
ating-point
strategy</p></td>
<td><p>VFPv4</p></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>MMU Page
Size</p></td>
<td><p>4kB</p></td>
<td></td>
</tr>
<tr class="row-even"><td></td>
<td><p>Target
Binary
Format</p></td>
<td><p>elf</p></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>Tool
chain</strong></p></td>
<td></td>
<td></td>
<td><p>Cross Compiler,
linker, and
libraries to be
built to compile
our embedded
application</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>Toolchain
Type</p></td>
<td><p>Buildroot toolchain</p></td>
<td><p>The Embedded
system will be
compiled with
tools integrated
into Buildroot</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>Custom
toolchain
vendor name</p></td>
<td><p>buidlroot</p></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>C library</p></td>
<td><p>glibc</p></td>
<td><p>Library
containing the
typical C
libraries used in
Linux
environments
(stdlib, stdio,
etc)</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>Kernel
Headers</p></td>
<td><p>Same as kernel being
built</p></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>Custom
Kernel
Headers
Series</p></td>
<td><p>5.10.x</p></td>
<td></td>
</tr>
<tr class="row-even"><td></td>
<td><p>Binutils
Version</p></td>
<td><p>binutils 2.40</p></td>
<td><p>Binutils contains
tools to manage
the binary files
obtained in the
compilation of
the different
applications</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>GCC
compiler
Version</p></td>
<td><p>gcc 12.x</p></td>
<td><p>GCC tools version
to be installed</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>Enable C++
support</p></td>
<td><p>Yes</p></td>
<td><p>Including support
for C++
programming,
compiling, and
linking.</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>Build cross
gdb for the
host</p></td>
<td><p>yes</p>
<p>Add Python support</p>
</td>
<td><p>Includes the
support for GDB.
GCC debugger.</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>GDB
debugger
version</p></td>
<td><p>Gdb 11.x</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>Build
op
tions</strong></p></td>
<td></td>
<td><p>Default values</p></td>
<td><p>How Buildroot
will build the
code. Leave
default values.</p></td>
</tr>
<tr class="row-even"><td><ul class="simple">
<li></li>
</ul>
<p><em>System
C
onfigur
ation*</em></p>
</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>Root
filesystem
skeleton</p></td>
<td><p>Default target skeleton</p></td>
<td><p>Linux folder
organization for
the embedded
system</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>System
Hostname</p></td>
<td><p><strong>buildroot</strong></p></td>
<td><p>Name of the
embedded system</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>System
Banner</p></td>
<td><p><strong>Linux RPI 3</strong></p></td>
<td><p>Banner</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>Passwords
encoding</p></td>
<td><p>sha-256</p></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>Init System</p></td>
<td><p>Busybox</p></td>
<td></td>
</tr>
<tr class="row-even"><td></td>
<td><p>/dev
management</p></td>
<td><p>Dynamic using devtmpfs
+ mdev</p></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>Path to
permissions
table</p></td>
<td><p><strong>sy
stem/device_table.txt</strong></p></td>
<td><p>Text files with
permissions for
/dev files</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>Enable root
login with
password</p></td>
<td><p>Yes</p></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>Root
password</p></td>
<td><p><strong>rpi</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td></td>
<td><p>/bin/sh</p></td>
<td><p>Busybox’ default shell</p></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>Run a
getty: Port
to run a
getty</p></td>
<td><p><strong>tty PORT: console</strong></p>
<p><strong>Keep kernel default</strong></p>
<p><strong>vt100</strong></p>
</td>
<td><p>Linux device file
with the port to
run getty (login)
process.</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>remount
root
filesystem
read-write
during boot</p></td>
<td><p>Yes</p></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>Network
interface
to
configure
trough DHCP</p></td>
<td><p>eth0</p></td>
<td></td>
</tr>
<tr class="row-even"><td></td>
<td><p>Set the
system’s
default
PATH</p></td>
<td><p>/bin:/
sbin:/usr/bin:/usr/sbin</p></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>Purge
unwanted
locales</p></td>
<td><p>Yes</p></td>
<td></td>
</tr>
<tr class="row-even"><td></td>
<td><p>Custom
scripts to
run before
creating
filesystem
images</p></td>
<td><p>&lt;<a href="#id37"><span class="problematic" id="id38">path_to_</span></a>
buidlroot&gt;/board/raspbe
rrypi3-64/post-build.sh</p></td>
<td><p>&lt;p
ath_to_buidlroot&gt;
path where
buildroot source
is</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>Custom
scripts to
run inside
the
fakeroot
environment</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td></td>
<td><p>Custom
scripts to
run after
creating
filesystem
images</p></td>
<td><p>&lt;<a href="#id39"><span class="problematic" id="id40">path_to_</span></a>
buidlroot&gt;/board/raspbe
rrypi3-64/post-image.sh</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>Linux
K
ernel</strong></p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td></td>
<td><p>Kernel
Version</p></td>
<td><p><strong>Custom tarball</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>URL of
custom
kernel
tarball</p></td>
<td><p><strong>$(call
github,
raspberrypi,linux,0b54d
bda3cca2beb51e236a25738
784e90853b64)/linux-0b5
4dbda3cca2beb51e236a257
38784e90853b64.tar.gz</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td></td>
<td><p>Kernel
co
nfiguration</p></td>
<td><p>Using and in-tree
defconfig file</p></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>Defconfig
name</p></td>
<td><p><strong>bcmrpi3</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td></td>
<td><p>Kernel
binary
format</p></td>
<td><p>Image</p></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>Kernel
compression
format</p></td>
<td><p>Gzip compression</p></td>
<td></td>
</tr>
<tr class="row-even"><td></td>
<td><p>Build a
Device Tree
Blob (DTB)</p></td>
<td><p>yes</p></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>In-tree
Device Tree
Source file
names</p></td>
<td><p>b
roadcom/bcm2710-rpi-3-b
broadc
om/bcm2710-rpi-3-b-plus
b
roadcom/bcm2837-rpi-3-b</p></td>
<td></td>
</tr>
<tr class="row-even"><td></td>
<td><p>Need host
OpenSSL</p></td>
<td><p>Yes</p></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>Linux
Kernel
Extensions</p></td>
<td><p>Nothing</p></td>
<td></td>
</tr>
<tr class="row-even"><td></td>
<td><p>Linux
Kernel
Tools</p></td>
<td><p>Nothing</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><ul class="simple">
<li></li>
</ul>
<p><em>Target
Pac
kages*</em></p>
</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td></td>
<td><p>Busybox</p></td>
<td><p>yes</p></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>Busybox
co
nfiguration
file to use</p></td>
<td><p><strong>package/b
usybox/busybox.config</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td></td>
<td><p>Audio and
video
a
pplications</p></td>
<td><p>Default values</p></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>C
ompresssors
and
de
compressors</p></td>
<td><p>Default values</p></td>
<td></td>
</tr>
<tr class="row-even"><td></td>
<td><p>Debugging,
profiling
and
benchmark</p></td>
<td><p><strong>gdb, gdbserver</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>D
evelopments
tools</p></td>
<td><p>Default values</p></td>
<td></td>
</tr>
<tr class="row-even"><td></td>
<td><p>Filesystem
and flash
utilities</p></td>
<td><p>Default values</p></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>Games</p></td>
<td><p>Default values</p></td>
<td></td>
</tr>
<tr class="row-even"><td></td>
<td><p>Graphic
libraries
and
a
pplications
(gr
aphic/text)</p></td>
<td><p>Default values</p></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>Hardware
handling</p></td>
<td><p><strong>F
irmware-&gt;rpi-firmware</strong></p>
<p><strong>rpi 0/1/2/3
(bootcode.bin, Default,
Extended)</strong></p>
<p><strong>Path to a file stores
as boot/config.txt
board/raspberrypi3-
64/config_3_64bit.txt</strong></p>
<p><strong>Path to a file stored
as boot/cmdline.txt
board/ra
spberrypi/cmdline.txt</strong></p>
<p><strong>install DTB
overlays</strong></p>
</td>
<td></td>
</tr>
<tr class="row-even"><td></td>
<td><p>I
nterpreters
language
and
scripting</p></td>
<td><p>Default values</p></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>Libraries</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td></td>
<td><p>Mi
scellaneous</p></td>
<td><p>Default</p></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>Networking
a
pplications</p></td>
<td><p><strong>ifupdown scripts</strong></p>
<p><strong>open ssh</strong></p>
</td>
<td></td>
</tr>
<tr class="row-even"><td></td>
<td><p>Package
managers</p>
<p>Real Time</p>
<p>Shell and
utilities</p>
<p>System
Tools</p>
<p>Text
Editors and
viewers</p>
</td>
<td><p>Default</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>Fil
esystem
I
mages</strong></p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td></td>
<td><p>ext2/3/4
root
filesystem</p></td>
<td><p>ext4</p>
<p>exact size <strong>400M</strong></p>
<p>Compression method <strong>no
compression</strong></p>
<p><strong>Remaining values-&gt;
default</strong></p>
</td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>tar the
root
filesystem</p></td>
<td><p>no compression</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>Host
util
ities</strong></p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>host
genimage</p></td>
<td><p>Yes</p></td>
<td></td>
</tr>
<tr class="row-even"><td></td>
<td><p>host
dosfstools</p></td>
<td><p>Yes</p></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>host mtools</p></td>
<td><p>Yes</p></td>
<td></td>
</tr>
<tr class="row-even"><td></td>
<td><p>Host
enviro
nment-setup</p></td>
<td><p>Yes</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><ul class="simple">
<li></li>
</ul>
<p><em>Legacy
config
op
tions*</em></p>
</td>
<td></td>
<td><p>Default values</p></td>
<td></td>
</tr>
</tbody>
</table>
<p>Once you have configured all the menus, you need to exit, saving the
values (File-&gt;Quit).</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><a href="#id11"><span class="problematic" id="id12">|im
age6|</span></a></p></th>
<th class="head"><p><strong>[Help]:</strong> The <strong>Buildroot</strong> configuration is stored in a
file named “.config”. You should have a backup of this file.</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
<td></td>
</tr>
</tbody>
</table>
</section>
<section id="compiling-buildroot">
<h2>Compiling buildroot<a class="headerlink" href="#compiling-buildroot" title="Link to this heading"></a></h2>
<p>In the Terminal Window executes the following command:</p>
<p>If everything is correct, you will see a final window similar to the one
represented in Fig. 8.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><a href="#id13"><span class="problematic" id="id14">|im
age7|</span></a></p></th>
<th class="head"><p><strong>[Time for this step]:</strong> In this step, buildroot will
connect, using the internet, to different repositories.
After downloading the code, Buildroot will compile the
applications and generate a lot of files and folders.
Depending on your internet speed access and the
configuration chosen, this step could take up to <strong>one hour
and a half</strong>.</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
<td></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><a href="#id15"><span class="problematic" id="id16">|im
age8|</span></a></p></th>
<th class="head"><p>Warning. If you have errors in the buildroot configuration,
you could obtain errors in this compilation phase. Check
your configuration correctly. Use “make clean” to clean up
your partial compilation.</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
<td></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><a href="#id17"><span class="problematic" id="id18">|im
age9|</span></a></p></th>
<th class="head"><p>Warning. dl subfolder in your buildroot folder contains all
the packages downloaded for the internet. If you want to
move your buildroot configuration from one computer to
another, avoiding the copy of the virtual machine, you can
copy this folder.</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
<td></td>
</tr>
</tbody>
</table>
<a class="reference internal image-reference" href="_images/image12.png"><img alt="_images/image12.png" src="_images/image12.png" style="width: 6.68125in; height: 4.46389in;" />
</a>
<p>Fig. 8: Successful compilation and installation of Buildroot</p>
<p><strong>Buildroot</strong> has generated some folders with different files and
subfolders containing the tools for generating your Embedded Linux
System. The next paragraph explains the main outputs obtained,</p>
</section>
<section id="buildroot-output">
<h2>Buildroot Output.<a class="headerlink" href="#buildroot-output" title="Link to this heading"></a></h2>
<p>The main output files of the execution of the previous steps can be
located in the folder “./images”. Fig. 9 summarizes the use of
<strong>Buildroot</strong>. Buildroot generates a bootloader, a kernel image, and a
file system.</p>
<a class="reference internal image-reference" href="_images/image13.emf"><img alt="_images/image13.emf" src="_images/image13.emf" style="width: 5.77292in; height: 1.81806in;" />
</a>
<p>Fig. 9: Schematic representation of the Buildroot tool. Buildroot
generates the root file system, the kernel image, the bootloader, and
the toolchain. Figure copied from “Bootlin” training materials
(<a class="reference external" href="http://bootlins.com/training/">http://bootlin.com/training/</a>)</p>
<p>In our specific case, the folder content is shown in Fig. 10</p>
<a class="reference internal image-reference" href="_images/image14.png"><img alt="A screenshot of a computer Description automatically generated" src="_images/image14.png" style="width: 5.98081in; height: 3.1266in;" />
</a>
<p>Fig. 10: The images folder contains the binary files for our embedded
system.</p>
<p>Copy the sdcard.img file to your SDcard using this Linux command in the
Buildroot folder (sdb is typically the device assigned to the sdcard,
unless you have other removable devices connected to the system):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ sudo dd if=./images/sdcard.img of=/dev/sd&lt;x&gt; bs=10M //&lt;x&gt; is the identification used by Linux for your microSD card, tipically “b” or “c”, never use “a” because this is the operating system hardisk
</pre></div>
</div>
<p>Remember to format again the microSDcard if you need to repeat this
process (linux gparted is an excellent tool to partition and format the
SD card).</p>
</section>
<section id="booting-the-raspberry-pi">
<h2>Booting the Raspberry Pi.<a class="headerlink" href="#booting-the-raspberry-pi" title="Link to this heading"></a></h2>
<p>Fig. 11 displays a Raspberry Pi. The description of this card, its
functionalities, interfaces, and connectors are explained in the ref
[RD2]. The fundamental connection requires:</p>
<ol class="loweralpha simple">
<li><p>To connect a USB to RS232 adapter (provided) to the raspberry-pi
expansion header (see Fig. 12 and Fig. 13). This adapter provides the
serial line interface as a console in the Linux host operating
system.</p></li>
<li><p>To connect the power supply with the micro-USB connector provided (5
v).</p></li>
<li><p>To connect the Ethernet cable to the RJ45 port if it is available
(not the case of UPM Lab).</p></li>
</ol>
<a class="reference internal image-reference" href="_images/image15.png"><img alt="_images/image15.png" src="_images/image15.png" style="width: 4.41667in; height: 2.94167in;" />
</a>
<p>Fig. 11: RaspBerry-Pi 3 Model B+ hardware with main elements identified.</p>
<p><img alt="image10" src="_images/image16.emf" />iwc</p>
<p>Fig. 12: Raspberry-PI 3 header terminal identification. The figure
displays a PI 3 B model.</p>
<a class="reference internal image-reference" href="_images/image17.emf"><img alt="_images/image17.emf" src="_images/image17.emf" style="width: 6.68819in; height: 2.38333in;" />
</a>
<p>Fig. 13: Identification of the terminals in the USB-RS232 adapter</p>
<p>The booting process of the Raspberry Pi BCM2837B0 processor is depicted
in Fig. 14. Take into account that this System On Chip (SoC), the
BCM2837B0, contains two different processors: a GPU and an ARM
processor. The programs <em>bootcode.bin</em> and <em>start.elf</em> are written
explicitly for the GPU, and the source code is unavailable. Broadcom
only provides details of this to customers who sign a commercial
agreement. The last executable (<em>start.elf</em>) boots the ARM processor and
allows the execution of ARM programs such as Linux OS kernel or other
binaries such as u-boot bootloader.</p>
<img alt="_images/image18.emf" src="_images/image18.emf" />
<p>Fig. 14: Booting process for BCM2837 processor in the raspberry-pi.</p>
<p>The config.txt file contains essential information to boot the Linux OS
and perform the configuration of different hardware elements (look at
<a class="reference external" href="http://elinux.org/RPiconfig">http://elinux.org/RPiconfig</a> and check the meaning of the different
configuration parameters). Verify the content of the config.txt file
generated by buildroot and complete it as depicted below.</p>
<p>In this example, once the ARM is released from reset, it executes the
Image application. This binary application is the Linux Kernel in Image
format. The parameters passed to the application specified in the
kernel=&lt;….&gt; are detailed in the cmdline.txt file. For instance, by
default, Buildroot generates this one:</p>
<p>In the Linux machine, open a Terminal and execute the program putty with
sudo rights (sudo putty), in a second a window appears. Configure the
parameters using the information displayed in Fig. 15 (for the specific
case of putty), and then press “Open”. <strong>Apply the power to the
Raspberry PI,</strong> and you will see the booting messages.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><a href="#id19"><span class="problematic" id="id20">|ima
ge11|</span></a></p></th>
<th class="head"><p><strong>[Serial interface identification in Linux]:</strong> In Linux the
serial devices are identified typically with the names
/dev/ttyS0, /dev/ttyS1, etc. In the figure, the example has
been checked with a serial port implemented with a USB-RS232
converter. This is the reason why the name is /dev/ttyUSB0.
In your computer, you need to find the identification of
your serial port. Use Linux <strong>dmesg</strong> command to do this.</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
<td></td>
</tr>
</tbody>
</table>
<p>Fig. 15: Putty program main window.</p>
<p>After some seconds, you will see a lot of messages displaying in the
terminal. Linux kernel is booting, and the operating system is running
its configuration and initial daemons. If the system boots correctly,
you will see an output like the one represented in Fig. 16. Introduce
the username root, and the Linux shell will be available for you.</p>
<a class="reference internal image-reference" href="_images/image20.png"><img alt="_images/image20.png" src="_images/image20.png" style="width: 6.69514in; height: 2.58472in;" />
</a>
<p>Fig. 16: Linux Running</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><a href="#id21"><span class="problematic" id="id22">|ima
ge12|</span></a></p></th>
<th class="head"><p><strong>[DHCP Server]:</strong> The DHCP server providing the IP address
to the RPI should be active in your network. In the UPM
ETSIST labs, there is no cabled network, only WIFI. If you
are using the RPI at home, the DHCP server is running in
your router. The method used by this should be different
from one manufactures to others. If you want to know the IP
address assigned, you have two options: use a serial cable
connected to the RPI or check the router status web page and
display the table of the DHCP clients connected. Looking for
the MAC in the list, you will obtain the IP address.</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
<td></td>
</tr>
</tbody>
</table>
</section>
<section id="connecting-the-rpi-to-the-network">
<h2>Connecting the RPI to the network<a class="headerlink" href="#connecting-the-rpi-to-the-network" title="Link to this heading"></a></h2>
<section id="inspecting-the-configuration-of-the-network-interface-generated-automatically-by-buildroot">
<h3>Inspecting the configuration of the network interface generated automatically by Buildroot<a class="headerlink" href="#inspecting-the-configuration-of-the-network-interface-generated-automatically-by-buildroot" title="Link to this heading"></a></h3>
<p>Inspect the content of /etc/network/interfaces and
/etc/init.d/S40network. You will see content similar to this in the
interfaces file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span># interface file auto-generated by buildroot

auto lo
iface lo inet loopback

auto eth0
iface eth0 inet dhcp
     pre-up /etc/network/nfs_check
     wait-delay 15
     hostname $(hostname)
</pre></div>
</div>
<p>This configuration activates the use of eth0 with DHCP support. Test the
connectivity, trying to connect to another computer in the laboratory.
Use the ping command.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><a href="#id23"><span class="problematic" id="id24">|ima
ge13|</span></a></p></th>
<th class="head"><p><strong>[Help]:</strong> If you run the ping command in the Raspberry
trying to connect with a computer in the laboratory, you
probably obtain a connection timeout. Consider that
computers running Windows could have the firewall activated.
You can also try to run the ping on a windows computer or on
Linux virtual machine. In this case, the RPI doesn’t have a
firewall running, and the connection should be successful.</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
<td></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><a href="#id25"><span class="problematic" id="id26">|ima
ge14|</span></a></p></th>
<th class="head"><p>[Question] What is the MAC address of your RPI? Is this MAC
the same that your instructor has given you? Use the dmesg
command to see the kernel boot parameters and identify the
method used to get the MAC address from the hardware.</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
<td></td>
</tr>
</tbody>
</table>
</section>
<section id="adding-wifi-support">
<h3>Adding WIFI support<a class="headerlink" href="#adding-wifi-support" title="Link to this heading"></a></h3>
<blockquote>
<div><p>Adding mdev support to Embedded Linux</p>
</div></blockquote>
<hr class="docutils" />
<p>The folder &lt;buildroot-folder&gt;<em>/package/busybox</em> contains two files
named S10mdev and mdev.conf. These files have to be added to the target
filesystem. This step is done by adding these commands to the
<em>&lt;buildroot-folder&gt;/board/raspberrypi3-64/post-build.sh</em> script:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>cp &lt;buildroot-folder&gt;/package/busybox/S10mdev ${TARGET_DIR}/etc/init.d/S10mdev
chmod 755 ${TARGET_DIR}/etc/init.d/S10mdev
cp &lt;buildroot-folder&gt;/package/busybox/mdev.conf ${TARGET_DIR}/etc/mdev.conf
</pre></div>
</div>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><a href="#id27"><span class="problematic" id="id28">|ima
ge15|</span></a></p></th>
<th class="head"><p>[mdev] mdev provides a method to add or remove hotplug
devices in Linux.</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
<td></td>
</tr>
</tbody>
</table>
<section id="adding-the-broadcom-firmware-support-for-wireless-hardware">
<h4>Adding the Broadcom firmware support for Wireless hardware<a class="headerlink" href="#adding-the-broadcom-firmware-support-for-wireless-hardware" title="Link to this heading"></a></h4>
<p>The hardware element included in the RPI-3 for the Wireless
communication is implemented with the BCM43438 chip. It is needed to
include the software packages with the firmware’s chip and the wireless
utilities.</p>
<ol class="arabic simple">
<li><p>Execute “make ……. menuconfig”. Navigate to “Target Packages-&gt;Hardware
Handling-&gt;Firmware-&gt; bcrmfmac-sdio-firmware-rpi” and select the
“bcrmfmac-sdio-firmware-rpi-wifi”.</p></li>
<li><p>Before compiling Buildroot we need to add more software supporting
the configuration of the WIFI.</p>
<ol class="loweralpha simple">
<li><p>Navigate to “Target Packages-&gt;Networking Applications” and select</p>
<ul class="simple">
<li><p>“crda”</p></li>
<li><p>“ifupdown scripts”</p></li>
<li><p>“iw”</p></li>
<li><p>“wireless-regdb”</p></li>
<li><p>“wireless tools”</p></li>
<li><p>“wpa_supplicant”</p>
<ol class="arabic simple">
<li><p>“Enable EAP”</p></li>
<li><p>“Enable WPS”</p></li>
<li><p>“Install wpa_cli binary”</p></li>
<li><p>“Install wpa_client shared library”</p></li>
<li><p>“Instal wpa_passphrase binary”</p></li>
</ol>
</li>
</ul>
</li>
<li><p>Add these lines to ./board/rapsberrypi3-64/post-build.sh.</p></li>
</ol>
</li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>cp &lt;buildroot-folder&gt;/board/raspberrypi3/interfaces ${TARGET_DIR}/etc/network/interfaces
cp &lt;buildroot-folder&gt;/board/raspberrypi3/wpa_supplicant.conf ${TARGET_DIR}/etc/wpa_supplicant.conf
</pre></div>
</div>
<ol class="loweralpha simple" start="3">
<li><p>Create the file <em>&lt;buildroot-folder&gt;</em>/board/raspberrypi3/interfaces
with this new content:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>auto lo
iface lo inet loopback

auto eth0
iface eth0 inet dhcp
     pre-up /etc/network/nfs_check
     wait-delay 15
     hostname $(hostname)

auto wlan0
iface wlan0 inet dhcp
       pre-up wpa_supplicant -B -iwlan0 -c/etc/wpa_supplicant.conf
       post-down killall -q wpa_supplicant
       wait-delay 15
</pre></div>
</div>
<ol class="loweralpha simple" start="4">
<li><p>Create the file
<em>&lt;buildroot-folder&gt;</em>/board/raspberrypi3/wpa_supplicant.conf with this
content (ask professors about the values to be provided as SSID and
Key-passwd). You can as many WIFIs as you want.</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">network</span><span class="o">=</span><span class="p">{</span>
<span class="n">ssid</span><span class="o">=</span><span class="s2">&quot;SSID&quot;</span>
<span class="n">key_mgmt</span><span class="o">=</span><span class="n">WPA</span><span class="o">-</span><span class="n">PSK</span>
<span class="n">psk</span><span class="o">=</span><span class="s2">&quot;PASSWORD&quot;</span>
<span class="n">priority</span><span class="o">=</span><span class="mi">9</span>
<span class="p">}</span>
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Perform a <em>make</em> and burn the new image in the SDcard. Boot the
Raspberry and check that you can connect to the wireless network.</p></li>
</ol>
</section>
</section>
</section>
</section>
<section id="using-the-integrated-development-environment-eclipse-cdt">
<h1>Using the integrated development environment Eclipse/CDT<a class="headerlink" href="#using-the-integrated-development-environment-eclipse-cdt" title="Link to this heading"></a></h1>
<section id="eclipse-ide-for-c-c-developers">
<h2>Eclipse IDE for C/C++ developers<a class="headerlink" href="#eclipse-ide-for-c-c-developers" title="Link to this heading"></a></h2>
<p>The Eclipse IDE CDT is installed in the virtual machine. You can execute
it running eclipse in a window terminal.</p>
</section>
<section id="cross-compiling-applications-using-eclipse">
<h2>Cross-Compiling applications using Eclipse<a class="headerlink" href="#cross-compiling-applications-using-eclipse" title="Link to this heading"></a></h2>
<p>How will a program be compiled? Remember that we are developing cross
applications. We are developing and compiling the code in a Linux x86_64
machine, and we are executing it on an ARM architecture (see Fig. 17).</p>
<a class="reference internal image-reference" href="_images/image21.emf"><img alt="_images/image21.emf" src="_images/image21.emf" style="width: 4.98681in; height: 2.79236in;" />
</a>
<p>Fig. 17: Summary of the different configurations for developing
applications for embedded systems. Figure copied from “Free Electrons”
training materials (<a class="reference external" href="http://free-electrons.com/training/">http://free-electrons.com/training/</a>)</p>
<p>The first question is where the cross-compiler and other cross-tools are
located. The answer is this: in the folder “build/host/usr/bin”. If you
inspect this folder’s content, you can see the entire compiling,
linking, and debugging tools (see Fig. 18). These programs are executed
in your x86_64 computer, but they generate code for the ARM processor.</p>
<a class="reference internal image-reference" href="_images/image22.png"><img alt="_images/image22.png" src="_images/image22.png" style="width: 5.90168in; height: 3.83333in;" />
</a>
<p>Fig. 18: Cross-compiling tools installed in the host computer</p>
<p>In a Terminal window execute the following commands:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ cd build/host
$ source environment-setup
$ eclipse &amp;
</pre></div>
</div>
<p>The <em>environment-setup</em> file contains the code listed below.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>cat &lt;&lt;&#39;EOF&#39;
 _           _ _     _                 _
| |__  _   _(_) | __| |_ __ ___   ___ | |_
| &#39;_ \| | | | | |/ _` | &#39;__/ _ \ / _ \| __|
| |_) | |_| | | | (_| | | | (_) | (_) | |_
|_.__/ \__,_|_|_|\__,_|_|  \___/ \___/ \__|

       Making embedded Linux easy!

Some tips:
* PATH now contains the SDK utilities
* Standard autotools variables (CC, LD, CFLAGS) are exported
* Kernel compilation variables (ARCH, CROSS_COMPILE, KERNELDIR) are exported
* To configure do &quot;./configure $CONFIGURE_FLAGS&quot; or use
  the &quot;configure&quot; alias
* To build CMake-based projects, use the &quot;cmake&quot; alias

EOF
if [ x&quot;$BASH_VERSION&quot; != x&quot;&quot; ] ; then
     SDK_PATH=$(dirname $(realpath &quot;${BASH_SOURCE[0]}&quot;))
elif [ x&quot;$ZSH_VERSION&quot; != x&quot;&quot; ] ; then
     SDK_PATH=$(dirname $(realpath $0))
else
     echo &quot;unsupported shell&quot;
fi
export &quot;AR=aarch64-buildroot-linux-gnu-gcc-ar&quot;
export &quot;AS=aarch64-buildroot-linux-gnu-as&quot;
export &quot;LD=aarch64-buildroot-linux-gnu-ld&quot;
export &quot;NM=aarch64-buildroot-linux-gnu-gcc-nm&quot;
export &quot;CC=aarch64-buildroot-linux-gnu-gcc&quot;
export &quot;GCC=aarch64-buildroot-linux-gnu-gcc&quot;
export &quot;CPP=aarch64-buildroot-linux-gnu-cpp&quot;
export &quot;CXX=aarch64-buildroot-linux-gnu-g++&quot;
export &quot;FC=aarch64-buildroot-linux-gnu-gfortran&quot;
export &quot;F77=aarch64-buildroot-linux-gnu-gfortran&quot;
export &quot;RANLIB=aarch64-buildroot-linux-gnu-gcc-ranlib&quot;
export &quot;READELF=aarch64-buildroot-linux-gnu-readelf&quot;
export &quot;STRIP=aarch64-buildroot-linux-gnu-strip&quot;
export &quot;OBJCOPY=aarch64-buildroot-linux-gnu-objcopy&quot;
export &quot;OBJDUMP=aarch64-buildroot-linux-gnu-objdump&quot;
export &quot;AR_FOR_BUILD=/usr/bin/ar&quot;
export &quot;AS_FOR_BUILD=/usr/bin/as&quot;
export &quot;CC_FOR_BUILD=/usr/bin/gcc&quot;
export &quot;GCC_FOR_BUILD=/usr/bin/gcc&quot;
export &quot;CXX_FOR_BUILD=/usr/bin/g++&quot;
export &quot;LD_FOR_BUILD=/usr/bin/ld&quot;
export &quot;CPPFLAGS_FOR_BUILD=-I$SDK_PATH/include&quot;
export &quot;CFLAGS_FOR_BUILD=-O2 -I$SDK_PATH/include&quot;
export &quot;CXXFLAGS_FOR_BUILD=-O2 -I$SDK_PATH/include&quot;
export &quot;LDFLAGS_FOR_BUILD=-L$SDK_PATH/lib -Wl,-rpath,$SDK_PATH/lib&quot;
export &quot;FCFLAGS_FOR_BUILD=&quot;
export &quot;DEFAULT_ASSEMBLER=aarch64-buildroot-linux-gnu-as&quot;
export &quot;DEFAULT_LINKER=aarch64-buildroot-linux-gnu-ld&quot;
export &quot;CPPFLAGS=-D_LARGEFILE_SOURCE -D_LARGEFILE64_SOURCE -D_FILE_OFFSET_BITS=64&quot;
export &quot;CFLAGS=-D_LARGEFILE_SOURCE -D_LARGEFILE64_SOURCE -D_FILE_OFFSET_BITS=64  -Os -g0 -D_FORTIFY_SOURCE=1&quot;
export &quot;CXXFLAGS=-D_LARGEFILE_SOURCE -D_LARGEFILE64_SOURCE -D_FILE_OFFSET_BITS=64  -Os -g0 -D_FORTIFY_SOURCE=1&quot;
export &quot;LDFLAGS=&quot;
export &quot;FCFLAGS= -Os -g0&quot;
export &quot;FFLAGS= -Os -g0&quot;
export &quot;PKG_CONFIG=pkg-config&quot;
export &quot;STAGING_DIR=$SDK_PATH/aarch64-buildroot-linux-gnu/sysroot&quot;
export &quot;INTLTOOL_PERL=/usr/bin/perl&quot;
export &quot;ARCH=arm64&quot;
export &quot;CROSS_COMPILE=aarch64-buildroot-linux-gnu-&quot;
export &quot;CONFIGURE_FLAGS=--target=aarch64-buildroot-linux-gnu --host=aarch64-buildroot-linux-gnu --build=x86_64-pc-linux-gnu --prefix=/usr --exec-prefix=/usr --sysconfdir=/etc --localstatedir=/var --program-prefix=&quot;
alias configure=&quot;./configure ${CONFIGURE_FLAGS}&quot;
alias cmake=&quot;cmake -DCMAKE_TOOLCHAIN_FILE=$SDK_PATH/share/buildroot/toolchainfile.cmake -DCMAKE_INSTALL_PREFIX=/usr&quot;
export &quot;PATH=$SDK_PATH/bin:$SDK_PATH/sbin:$PATH&quot;
export &quot;KERNELDIR=/home/ubuntu/Documents/rpi/build/build/linux-custom/&quot;
</pre></div>
</div>
<p>This script when is source in a terminal window sets all the environment
variables needed to use the cross-compilation tools and add the folder
of cross-tools to the PATH linux variable.</p>
<p>The execution of eclipse popups a window inviting you to enter the
workspace (see Fig. 19). The workspace is the folder that contain
eclipse projects created by the user. You can have as many workspaces as
you want. Please specify a folder in your account.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><a href="#id29"><span class="problematic" id="id30">|ima
ge16|</span></a></p></th>
<th class="head"><p><strong>[Help]:</strong> The figures displayed in the following
paragraphs can be different depending on the Eclipse version
installed.</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
<td></td>
</tr>
</tbody>
</table>
<a class="reference internal image-reference" href="_images/image23.png"><img alt="_images/image23.png" src="_images/image23.png" style="width: 5.19182in; height: 2.66458in;" />
</a>
<p>Fig. 19: Selection of the workspace for Eclipse. Use a folder in your
account.</p>
<p>Select Ok, and the welcome window of Eclipse will be shown (Fig. 20).
Next, close the welcome window and the main eclipse window will be
displayed (Fig. 21).</p>
<a class="reference internal image-reference" href="_images/image24.png"><img alt="_images/image24.png" src="_images/image24.png" style="width: 5.17708in; height: 4.13683in;" />
</a>
<p>Fig. 20: Eclipse welcome window.</p>
<a class="reference internal image-reference" href="_images/image25.png"><img alt="_images/image25.png" src="_images/image25.png" style="width: 5.78753in; height: 4.35417in;" />
</a>
<p>Fig. 21: Eclipse main window.</p>
<p>In a terminal window create an empty folder. In this folder create the
following files with the content described in the Table 2. The Makefile
uses the environment variables that are defined in the environment where
the makefile is run.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Filename</p></th>
<th class="head"><p>Content</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Makefile</p></td>
<td><p>LIBS= -lpthread -lm #Libraries used if needed</p>
<p>SRCS= main.cpp func.cpp</p>
<p>BIN=app</p>
<p>CFLAGS+= -g -O0</p>
<p>OBJS=$(subst .cpp,.o,$(SRCS))</p>
<p>all : $(BIN)</p>
<p>$(BIN): $(OBJS)</p>
<p>&#64;echo [link] $&#64;</p>
<p>$(CXX) -o $&#64; $(OBJS) $(LDFLAGS) $(LIBS)</p>
<p>%.o: %.cpp</p>
<p>&#64;echo [Compile] $&lt;</p>
<p>$(CXX) -c $(CFLAGS) $&lt; -o $&#64;</p>
<p>clean:</p>
<p>&#64;rm -f $(OBJS) $(BIN)</p>
</td>
</tr>
<tr class="row-odd"><td><p>main.cpp</p></td>
<td><p>#include “func.h”</p>
<p>#include &lt;iostream&gt;</p>
<p>int main(void){</p>
<p>int b=2;</p>
<p>std::cout&lt;&lt;”A is: “&lt;&lt; fun(b) &lt;&lt; std::endl;</p>
<p>}</p>
</td>
</tr>
<tr class="row-even"><td><p>func.h</p></td>
<td><p>#ifndef __FUNC_H</p>
<p>#define __FUNC_H</p>
<p>int fun(int);</p>
<p>#endif</p>
</td>
</tr>
<tr class="row-odd"><td><p>func.cpp</p></td>
<td><p>int fun(int b){</p>
<p>int a=b*2;</p>
<p>return a;</p>
<p>}</p>
</td>
</tr>
</tbody>
</table>
<p>In Eclipse select in the left part of the windows Import <em>projects</em>. A
new window is popup, select then <em>C/C++</em> and the option <em>Existing Code
as Makefile Project</em>. The window shown in Fig. 22 is displayed. Complete
the name of the project, select the folder with the code and check
<em>Cross GCC in Toolchain for Indexer Settings</em>.</p>
<a class="reference internal image-reference" href="_images/image26.png"><img alt="_images/image26.png" src="_images/image26.png" style="width: 4.45148in; height: 4.95833in;" />
</a>
<p>Fig. 22: Selecting the code.</p>
</section>
<section id="building-a-project">
<h2>Building a project<a class="headerlink" href="#building-a-project" title="Link to this heading"></a></h2>
<p>Once you have configured the cross-chain in Eclipse you can build your
project using Project-&gt;Build Project. If everything is correct, you will
see the eclipse project as represented in Fig. 29. You can clean the
project (remove the executable and objects) with <em>Clean</em>.</p>
<a class="reference internal image-reference" href="_images/image27.png"><img alt="A screenshot of a computer Description automatically generated" src="_images/image27.png" style="width: 6.69375in; height: 4.17014in;" />
</a>
<p>Fig. 23: Eclipse project compiled (Binaries has been generated)</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><a href="#id31"><span class="problematic" id="id32">|ima
ge17|</span></a></p></th>
<th class="head"><p><strong>[Console in Eclipse]:</strong> Have a look at the messages
displayed in the Console. You will see how eclipse is
calling the cross compiler with different parameters.</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
<td></td>
</tr>
</tbody>
</table>
</section>
<section id="moving-the-binary-to-the-target">
<h2>Moving the binary to the target<a class="headerlink" href="#moving-the-binary-to-the-target" title="Link to this heading"></a></h2>
<p>In order to copy the executable to the target, you have different
options. You can use the Linux application called “scp” or other similar
applications. In our case, we are going to use the “Other Locations….”
utility included in the nautilus explorer. Specify in Server Address
<a class="reference external" href="ssh:/">ssh:/</a>/&lt;ip address&gt;</p>
<a class="reference internal image-reference" href="_images/image28.png"><img alt="_images/image28.png" src="_images/image28.png" style="width: 5.57399in; height: 2.93365in;" />
</a>
<p>Fig. 24: “Connect to Server” option in Nautilus explorer</p>
</section>
<section id="executing-the-application">
<h2>Executing the application<a class="headerlink" href="#executing-the-application" title="Link to this heading"></a></h2>
<p>You can run the Raspberry PI program using putty (remember that once you
have a network connection available in the RPI you can also use putty to
connect to it).</p>
<a class="reference internal image-reference" href="_images/image29.png"><img alt="A screenshot of a computer Description automatically generated" src="_images/image29.png" style="width: 4.45in; height: 2.90434in;" />
</a>
<p>Fig. 25: Run test program in Raspberry Pi</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><a href="#id33"><span class="problematic" id="id34">|ima
ge18|</span></a></p></th>
<th class="head"><p>Warning. If you experiment problems using ssh, delete the
.ssh folder in your home directory.</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
<td></td>
</tr>
</tbody>
</table>
</section>
<section id="automatic-debugging-using-gdb-and-gdbserver">
<h2>Automatic debugging using gdb and gdbserver<a class="headerlink" href="#automatic-debugging-using-gdb-and-gdbserver" title="Link to this heading"></a></h2>
<p>You can directly debug the program running in the RPI using Eclipse.
There are two methods to do it: manually and automatically. In the
manual method, firstly, you need to copy the executable program to the
RPI, change the file permissions to “executable” and execute the program
to be debugged using <em>gdbserver</em> utility. Of course, this is a
time-consuming process and very inefficient. The alternative solution is
to use automatic debugging. In order to debug your applications, we need
to define a debug session and configure it. Firstly, <em>Select Run-&gt;Debug
Configurations</em> and generate a new configuration under <em>C/C++ Remote
Application</em>. You need to complete the different tabs available in this
window. The first one is the main tab (see Fig. 33). You need to
configure here the path to the C/C++ application to be debugged, the
project name, the connection with the target (you will need to create a
new one using the IP address of your RPI), the remote path where your
executable file will be downloaded, and the mode for the debugging
(Automatic Remote Debugging Launcher). Secondly, in the argument tab,
you can specify the arguments of your executable program. It is very
important here that you can also specify the working directory path
where the executable will be copied and launched (you need to have
rights in this folder).</p>
<a class="reference internal image-reference" href="_images/image30.png"><img alt="A screenshot of a computer Description automatically generated" src="_images/image30.png" style="width: 6.69375in; height: 3.94931in;" />
</a>
<p>Fig. 26: Creating a Debug Configuration</p>
<p>In the debugger window you need to configure the path of your cross gdb
application. Remember that we are working with a cross-compiler, cross
debugging. Therefore, you need to provide here the correct path of your
gdb. The GDB command file (.gdbinit) must be specified, providing a path
with an empty file. In the Gdbserver settings tab, you need to provide
the path to the gdbserver in the target and the TCP/IP port used (by
default 2345).</p>
<a class="reference internal image-reference" href="_images/image30.png"><img alt="A screenshot of a computer Description automatically generated" src="_images/image30.png" style="width: 6.03905in; height: 3.56303in;" />
</a>
<p>Fig. 27: Debug configuration, including the path to locate the cross gdb
tool.</p>
<p>Now, press Debug in Eclipse window, and you can debug your application
remotely.</p>
<a class="reference internal image-reference" href="_images/image31.png"><img alt="A screenshot of a computer Description automatically generated" src="_images/image31.png" style="width: 5.89423in; height: 3.67021in;" />
</a>
<p>Fig. 28: Debugging session on the RPI remotely</p>
</section>
</section>
<section id="preparing-the-linux-virtual-machine">
<h1>Preparing the linux virtual machine.<a class="headerlink" href="#preparing-the-linux-virtual-machine" title="Link to this heading"></a></h1>
<section id="download-vmware-workstation-player">
<h2>Download VMware Workstation Player.<a class="headerlink" href="#download-vmware-workstation-player" title="Link to this heading"></a></h2>
<p>The link <a class="reference external" href="https://www.vmware.com/support/pubs/player_pubs.html">https://www.vmware.com/support/pubs/player_pubs.html</a> contains
documentation describing the installation and basic use of VMware
Workstation Player. Follow the instructions to set up the application on
your computer.</p>
</section>
<section id="installing-ubuntu-22-04-lts-as-a-virtual-machine">
<h2>Installing Ubuntu 22.04 LTS as a virtual machine.<a class="headerlink" href="#installing-ubuntu-22-04-lts-as-a-virtual-machine" title="Link to this heading"></a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><a href="#id35"><span class="problematic" id="id36">|ima
ge19|</span></a></p></th>
<th class="head"><p><strong>[Ubuntu version]:</strong> It is mandatory to install Ubuntu
22.04 version.</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
<td></td>
</tr>
</tbody>
</table>
<p>The first step is to download Ubuntu 22.04.3 (64 bit PC) from Ubuntu web
site using this link: <a class="reference external" href="http://releases.ubuntu.com/">http://releases.ubuntu.com/</a> . You will download an
ISO image with this Linux operating System.Run WMware player and install
Ubuntu using the VMWare player instructions. Consider the following when
creating the virtual machine: you need at least 150Gbytes of hard disk
space (in multiple files), 3GByte of RAM, and, if possible 4 processors.
The installation time will be half an hour, more or less, depending on
your computer. Moving a virtual machine from one computer to another is
a time-consuming task; therefore, take this into account to minimize the
development time.</p>
</section>
<section id="installing-synaptic">
<h2>Installing synaptic<a class="headerlink" href="#installing-synaptic" title="Link to this heading"></a></h2>
<p>If you need to install software packages, you can do it using the linux
terminal command apt-get. Another alternative process is the use of the
synaptic utility. In order to use it, you need to install it using this
command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ sudo apt-get install synaptic
</pre></div>
</div>
<p>Once installed, you can search and execute the synaptic program. When
you click two times over the package, it will show all the dependent
packages that would be installed.</p>
<a class="reference internal image-reference" href="_images/image32.png"><img alt="A screenshot of a computer Description automatically generated" src="_images/image32.png" style="width: 6.69375in; height: 3.32431in;" />
</a>
<p>Fig. 30: Synaptic window</p>
</section>
<section id="installing-putty">
<h2>Installing putty<a class="headerlink" href="#installing-putty" title="Link to this heading"></a></h2>
<p>You need to execute:</p>
<ul class="simple">
<li><p>sudo apt-get install putty</p></li>
</ul>
</section>
<section id="installing-packages-for-supporting-buildroot">
<h2>Installing packages for supporting Buildroot.<a class="headerlink" href="#installing-packages-for-supporting-buildroot" title="Link to this heading"></a></h2>
<p>Using buildroot requires some software packages that have to be
installed in the VM. These are listed in this link
<a class="reference external" href="http://buildroot.uclibc.org/downloads/manual/manual.html#requirement">http://buildroot.uclibc.org/downloads/manual/manual.html#requirement</a>.
You need to install at least:</p>
<ul class="simple">
<li><p>g++</p></li>
<li><p>git</p></li>
</ul>
</section>
<section id="installing-packages-supporting-eclipse">
<h2>Installing packages supporting Eclipse<a class="headerlink" href="#installing-packages-supporting-eclipse" title="Link to this heading"></a></h2>
<p>You need to install:</p>
<ul class="simple">
<li><p>eclipse-cdt (eclipse C/C++ programming)</p></li>
<li><p>eclipse-rse (eclipse remote explorer)</p></li>
<li><p>eclipse-cdt-launch-remote (eclipse for remote debugging)</p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="another-feature.html" class="btn btn-neutral float-left" title="More features here" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright workshop participant.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>