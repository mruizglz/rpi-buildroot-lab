<!DOCTYPE html>
<html data-content_root="./" lang="en">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <meta content="width=device-width, initial-scale=1" name="viewport"/>
  <title>
   Design of Embedded Systems with RaspberryPI 1.0 documentation
  </title>
  <link href="_static/pygments.css?v=d75fae25" rel="stylesheet" type="text/css"/>
  <link href="_static/main.css?v=a17167f9" rel="stylesheet" type="text/css"/>
  <script src="_static/jquery.js?v=5d32c60e">
  </script>
  <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c">
  </script>
  <script src="_static/documentation_options.js?v=b5f0cf65">
  </script>
  <script src="_static/doctools.js?v=9bcbadda">
  </script>
  <script src="_static/sphinx_highlight.js?v=dc90522c">
  </script>
  <link href="genindex.html" rel="index" title="Index"/>
  <link href="search.html" rel="search" title="Search"/>
 </head>
 <body>
  <article class="dont-break" id="cover">
   <div class="container">
    <!-- Logo -->
    <div class="logo">
     <p>
     </p>
    </div>
    <!-- Cover middle -->
    <div class="cover-middle">
     <div class="title">
      <h1 class="title-cover">
       Design of Embedded Systems with RaspberryPI
      </h1>
      <p class="subtitle-cover">
       Version 1.0
      </p>
      <span class="meta">
       Design of Embedded Systems with RaspberryPI.
      </span>
     </div>
     <!--
      <div class="client-logo">
        <img src="../data/logo_.png" alt="Logotipo">
      </div>
      -->
    </div>
    <!-- Footer -->
    <div class="cover-footer">
     <p>
      Build: 21.03.2025
      <br/>
      Author: Mariano Ruiz
     </p>
    </div>
   </div>
  </article>
  <div aria-label="Main" class="sphinxsidebar" role="navigation">
   <div class="sphinxsidebarwrapper">
    <div>
     <h3>
      <a href="#">
       Table of Contents
      </a>
     </h3>
     <p class="caption" role="heading">
      <span class="caption-text">
       Contents:
      </span>
     </p>
     <ul>
      <li class="toctree-l1">
       <a class="reference internal" href="#acronyms">
        1. Acronyms
       </a>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="#getting-started-with-rpi">
        2. Getting started with RPI
       </a>
       <ul>
        <li class="toctree-l2">
         <a class="reference internal" href="#reference-documentation">
          2.1. Reference Documentation
         </a>
        </li>
        <li class="toctree-l2">
         <a class="reference internal" href="#operating-system-installation">
          2.2. Operating System Installation
         </a>
         <ul>
          <li class="toctree-l3">
           <a class="reference internal" href="#downloading-and-installing-raspberry-pi-os">
            2.2.1. Downloading and installing Raspberry PI OS
           </a>
          </li>
          <li class="toctree-l3">
           <a class="reference internal" href="#setting-up-the-raspberry-pi">
            2.2.2. Setting up the Raspberry Pi
           </a>
          </li>
          <li class="toctree-l3">
           <a class="reference internal" href="#reviewing-the-sd-card-content">
            2.2.3. Reviewing the SD card content
           </a>
          </li>
          <li class="toctree-l3">
           <a class="reference internal" href="#booting-the-rpi">
            2.2.4. Booting the RPI
           </a>
          </li>
          <li class="toctree-l3">
           <a class="reference internal" href="#discovering-the-rpi-ip-address">
            2.2.5. Discovering the RPI IP address
           </a>
          </li>
          <li class="toctree-l3">
           <a class="reference internal" href="#raspberry-pi-os-update">
            2.2.6. Raspberry Pi OS Update
           </a>
          </li>
         </ul>
        </li>
        <li class="toctree-l2">
         <a class="reference internal" href="#integration-of-a-3-axis-accelerometer-with-raspberry-pi">
          2.3. Integration of a 3-axis accelerometer with Raspberry-Pi
         </a>
         <ul>
          <li class="toctree-l3">
           <a class="reference internal" href="#specifications">
            2.3.1. Specifications
           </a>
          </li>
          <li class="toctree-l3">
           <a class="reference internal" href="#suggested-improvements">
            2.3.2. Suggested Improvements
           </a>
          </li>
          <li class="toctree-l3">
           <a class="reference internal" href="#optional-python-script">
            2.3.3. Optional: Python Script
           </a>
          </li>
         </ul>
        </li>
        <li class="toctree-l2">
         <a class="reference internal" href="#compiling-linking-c-program-in-linux">
          2.4. Compiling &amp; linking C program in Linux
         </a>
        </li>
        <li class="toctree-l2">
         <a class="reference internal" href="#questions-to-be-reported-to-instructors">
          2.5. Questions to be reported to instructors
         </a>
        </li>
       </ul>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="#embedded-linux-with-rpi">
        3. Embedded Linux With RPI
       </a>
       <ul>
        <li class="toctree-l2">
         <a class="reference internal" href="#document-overview">
          3.1. Document Overview
         </a>
        </li>
        <li class="toctree-l2">
         <a class="reference internal" href="#references">
          3.2. References
         </a>
        </li>
        <li class="toctree-l2">
         <a class="reference internal" href="#building-linux-using-buildroot">
          3.3. Building Linux using buildroot
         </a>
         <ul>
          <li class="toctree-l3">
           <a class="reference internal" href="#elements-needed-for-the-execution-of-these-labs">
            3.3.1. Elements needed for the execution of these LABS
           </a>
          </li>
         </ul>
        </li>
        <li class="toctree-l2">
         <a class="reference internal" href="#starting-the-vmware">
          3.4. Starting the VMware
         </a>
        </li>
        <li class="toctree-l2">
         <a class="reference internal" href="#configuring-buildroot-for-rpi4">
          3.5. Configuring Buildroot for RPI4
         </a>
         <ul>
          <li class="toctree-l3">
           <a class="reference internal" href="#target-options">
            3.5.1. Target Options
           </a>
          </li>
          <li class="toctree-l3">
           <a class="reference internal" href="#toolchain">
            3.5.2. Toolchain
           </a>
          </li>
          <li class="toctree-l3">
           <a class="reference internal" href="#build-options">
            3.5.3. Build options
           </a>
          </li>
          <li class="toctree-l3">
           <a class="reference internal" href="#system-configuration">
            3.5.4. System Configuration
           </a>
          </li>
          <li class="toctree-l3">
           <a class="reference internal" href="#linux-kernel">
            3.5.5. Linux Kernel
           </a>
          </li>
          <li class="toctree-l3">
           <a class="reference internal" href="#target-packages">
            3.5.6. Target Packages
           </a>
          </li>
          <li class="toctree-l3">
           <a class="reference internal" href="#file-system-images">
            3.5.7. File System Images
           </a>
          </li>
          <li class="toctree-l3">
           <a class="reference internal" href="#boot-loaders">
            3.5.8. Boot-loaders
           </a>
          </li>
          <li class="toctree-l3">
           <a class="reference internal" href="#host-utilities">
            3.5.9. Host Utilities
           </a>
          </li>
         </ul>
        </li>
        <li class="toctree-l2">
         <a class="reference internal" href="#compiling-buildroot">
          3.6. Compiling buildroot
         </a>
        </li>
        <li class="toctree-l2">
         <a class="reference internal" href="#buildroot-output">
          3.7. Buildroot Output.
         </a>
        </li>
        <li class="toctree-l2">
         <a class="reference internal" href="#booting-the-raspberry-pi">
          3.8. Booting the Raspberry Pi.
         </a>
        </li>
        <li class="toctree-l2">
         <a class="reference internal" href="#connecting-the-rpi-to-the-cabled-ethernet-network">
          3.9. Connecting the RPI to the cabled ethernet network
         </a>
         <ul>
          <li class="toctree-l3">
           <a class="reference internal" href="#inspecting-the-configuration-of-the-network-interface-generated-automatically-by-buildroot">
            3.9.1. Inspecting the configuration of the network interface generated automatically by Buildroot
           </a>
          </li>
         </ul>
        </li>
        <li class="toctree-l2">
         <a class="reference internal" href="#adding-wifi-support">
          3.10. Adding WIFI support
         </a>
         <ul>
          <li class="toctree-l3">
           <a class="reference internal" href="#adding-mdev-support-to-embedded-linux">
            3.10.1. Adding mdev support to Embedded Linux
           </a>
          </li>
          <li class="toctree-l3">
           <a class="reference internal" href="#adding-the-broadcom-firmware-support-for-wireless-hardware">
            3.10.2. Adding the Broadcom firmware support for Wireless hardware
           </a>
          </li>
         </ul>
        </li>
        <li class="toctree-l2">
         <a class="reference internal" href="#customizing-the-linux-kernel">
          3.11. Customizing the Linux kernel
         </a>
         <ul>
          <li class="toctree-l3">
           <a class="reference internal" href="#kernel-configuration">
            3.11.1. Kernel configuration
           </a>
          </li>
         </ul>
        </li>
       </ul>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="#using-the-integrated-development-environment-eclipse-cdt">
        4. Using the integrated development environment Eclipse/CDT
       </a>
       <ul>
        <li class="toctree-l2">
         <a class="reference internal" href="#eclipse-ide-for-c-c-developers">
          4.1. Eclipse IDE for C/C++ developers
         </a>
        </li>
        <li class="toctree-l2">
         <a class="reference internal" href="#cross-compiling-applications-using-eclipse">
          4.2. Cross-Compiling applications using Eclipse
         </a>
        </li>
        <li class="toctree-l2">
         <a class="reference internal" href="#building-a-project">
          4.3. Building a project
         </a>
        </li>
        <li class="toctree-l2">
         <a class="reference internal" href="#moving-the-binary-to-the-target">
          4.4. Moving the binary to the target
         </a>
        </li>
        <li class="toctree-l2">
         <a class="reference internal" href="#executing-the-application">
          4.5. Executing the application
         </a>
        </li>
        <li class="toctree-l2">
         <a class="reference internal" href="#automatic-debugging-using-gdb-and-gdbserver">
          4.6. Automatic debugging using gdb and gdbserver
         </a>
        </li>
       </ul>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="#preparing-the-vmware-ubuntu-virtual-machine">
        5. Preparing the VMware Ubuntu Virtual Machine.
       </a>
       <ul>
        <li class="toctree-l2">
         <a class="reference internal" href="#download-vmware-workstation-player">
          5.1. Download VMware Workstation Player.
         </a>
        </li>
        <li class="toctree-l2">
         <a class="reference internal" href="#installing-ubuntu-24-04-01-lts-as-a-virtual-machine">
          5.2. Installing Ubuntu 24.04.01 LTS as a virtual machine.
         </a>
        </li>
        <li class="toctree-l2">
         <a class="reference internal" href="#installing-synaptic">
          5.3. Installing synaptic
         </a>
        </li>
        <li class="toctree-l2">
         <a class="reference internal" href="#installing-putty">
          5.4. Installing putty
         </a>
        </li>
        <li class="toctree-l2">
         <a class="reference internal" href="#installing-packages-for-supporting-buildroot">
          5.5. Installing packages for supporting Buildroot.
         </a>
        </li>
        <li class="toctree-l2">
         <a class="reference internal" href="#installing-packages-supporting-eclipse">
          5.6. Installing packages supporting Eclipse
         </a>
        </li>
       </ul>
      </li>
      <li class="toctree-l1">
       <a class="reference internal" href="gen">
        Index
       </a>
      </li>
     </ul>
    </div>
   </div>
  </div>
  <div class="document">
   <div class="documentwrapper">
    <div class="bodywrapper">
     <div class="body" role="main">
      <section id="building-embedded-linux-for-raspberry-pi">
       <h1>
        Building Embedded Linux for Raspberry PI
        <a class="headerlink" href="#building-embedded-linux-for-raspberry-pi" title="Link to this heading">
         
        </a>
       </h1>
       <div class="toctree-wrapper compound">
        <span id="document-acronyms">
        </span>
        <section id="acronyms">
         <h2>
          Acronyms
          <a class="headerlink" href="#acronyms" title="Link to this heading">
           
          </a>
         </h2>
         <dl class="simple glossary">
          <dt id="term-CPU">
           CPU
           <a class="headerlink" href="#term-CPU" title="Link to this term">
            
           </a>
          </dt>
          <dd>
           <p>
            Central Processing Unit
           </p>
          </dd>
          <dt id="term-EABI">
           EABI
           <a class="headerlink" href="#term-EABI" title="Link to this term">
            
           </a>
          </dt>
          <dd>
           <p>
            Extended Application Binary Interface
           </p>
          </dd>
          <dt id="term-EHCI">
           EHCI
           <a class="headerlink" href="#term-EHCI" title="Link to this term">
            
           </a>
          </dt>
          <dd>
           <p>
            Enhanced Host Controller Interface
           </p>
          </dd>
          <dt id="term-GPU">
           GPU
           <a class="headerlink" href="#term-GPU" title="Link to this term">
            
           </a>
          </dt>
          <dd>
           <p>
            Graphical Processing Unit
           </p>
          </dd>
          <dt id="term-I-O">
           I/O
           <a class="headerlink" href="#term-I-O" title="Link to this term">
            
           </a>
          </dt>
          <dd>
           <p>
            Input and Output
           </p>
          </dd>
          <dt id="term-MMC">
           MMC
           <a class="headerlink" href="#term-MMC" title="Link to this term">
            
           </a>
          </dt>
          <dd>
           <p>
            Multimedia card
           </p>
          </dd>
          <dt id="term-NAND">
           NAND
           <a class="headerlink" href="#term-NAND" title="Link to this term">
            
           </a>
          </dt>
          <dd>
           <p>
            Flash memory type for fast sequential read and write
           </p>
          </dd>
          <dt id="term-OS">
           OS
           <a class="headerlink" href="#term-OS" title="Link to this term">
            
           </a>
          </dt>
          <dd>
           <p>
            Operating system
           </p>
          </dd>
          <dt id="term-PCI">
           PCI
           <a class="headerlink" href="#term-PCI" title="Link to this term">
            
           </a>
          </dt>
          <dd>
           <p>
            Peripheral Component Interconnect &ndash; computer bus standard
           </p>
          </dd>
          <dt id="term-PCI-Express">
           PCI Express
           <a class="headerlink" href="#term-PCI-Express" title="Link to this term">
            
           </a>
          </dt>
          <dd>
           <p>
            Peripheral Component Interconnect Express
           </p>
          </dd>
          <dt id="term-UART">
           UART
           <a class="headerlink" href="#term-UART" title="Link to this term">
            
           </a>
          </dt>
          <dd>
           <p>
            Universal Asynchronous Receiver Transmitter
           </p>
          </dd>
          <dt id="term-USB">
           USB
           <a class="headerlink" href="#term-USB" title="Link to this term">
            
           </a>
          </dt>
          <dd>
           <p>
            Universal Serial Bus
           </p>
          </dd>
         </dl>
        </section>
        <span id="document-gettingstartedrpi">
        </span>
        <section id="getting-started-with-rpi">
         <h2>
          Getting started with RPI
          <a class="headerlink" href="#getting-started-with-rpi" title="Link to this heading">
           
          </a>
         </h2>
         <p>
          This document describes the essential steps students have to follow to
boot the Raspberry Pi with a Linux-based distribution such as Raspberry
PI OS. After performing the operating system installation, the student
must investigate the software tools installed and their potential.
Finally, the student must implement a software application that measures
3D acceleration using a transducer. The following variants of
application are proposed to the student:
         </p>
         <ol class="arabic simple">
          <li>
           <p>
            Develop a simple console program developed in the C language.
           </p>
          </li>
          <li>
           <p>
            (Optional) Develop an equivalent application using Python.
           </p>
          </li>
         </ol>
         <div class="admonition note">
          <p class="admonition-title">
           Note
          </p>
          <p>
           <strong>
            [Time to complete the laboratory]:
           </strong>
           The time necessary to complete steps 1 to 3 in this tutorial is approximately 4 hours.
          </p>
         </div>
         <section id="reference-documentation">
          <h3>
           Reference Documentation
           <a class="headerlink" href="#reference-documentation" title="Link to this heading">
            
           </a>
          </h3>
          <p>
           The following documentation has to be read and checked.
          </p>
          <ol class="arabic simple">
           <li>
            <p>
             <a class="reference external" href="http://www.raspberrypi.org/help/">
              http://www.raspberrypi.org/help/
             </a>
             . This web contains some guides and
documents covering a lot of topics
            </p>
           </li>
           <li>
            <p>
             <a class="reference external" href="https://projects.raspberrypi.org/en">
              https://projects.raspberrypi.org/en
             </a>
             . RPI application examples
            </p>
           </li>
           <li>
            <p>
             <a class="reference external" href="http://www.python.org">
              http://www.python.org
             </a>
             . Phyton resources, tutorial, and reference
            </p>
           </li>
           <li>
            <p>
             <a class="reference external" href="https://www.raspberrypi.org/courses/learn-python">
              https://www.raspberrypi.org/courses/learn-python
             </a>
            </p>
           </li>
           <li>
            <p>
             <a class="reference external" href="http://i2c.info/i2c-bus-specification">
              http://i2c.info/i2c-bus-specification
             </a>
            </p>
           </li>
          </ol>
         </section>
         <section id="operating-system-installation">
          <h3>
           Operating System Installation
           <a class="headerlink" href="#operating-system-installation" title="Link to this heading">
            
           </a>
          </h3>
          <section id="downloading-and-installing-raspberry-pi-os">
           <h4>
            Downloading and installing Raspberry PI OS
            <a class="headerlink" href="#downloading-and-installing-raspberry-pi-os" title="Link to this heading">
             
            </a>
           </h4>
           <p>
            Several Linux and Android distributions can be installed on the
Raspberry Pi platform. These Operating System distributions also include
multiple software applications and tools such as text editors, music
players, video editing and playing, games, development tools, etc.
           </p>
           <p>
            Follow the steps below to install the Raspbian Operating System:
           </p>
           <ol class="arabic simple">
            <li>
             <p>
              Download the
              <a class="reference external" href="https://www.raspberrypi.com/software/">
               Raspberry PI Imager
              </a>
              tool for your specific OS.
             </p>
            </li>
            <li>
             <p>
              Execute the application, and a window will be displayed (see
              <a class="reference internal" href="#imagermain">
               <span class="std std-numref">
                Fig. 2.1
               </span>
              </a>
              ). First choose
the Raspberry PI hardware (see
              <a class="reference internal" href="#imagerhw">
               <span class="std std-numref">
                Fig. 2.2
               </span>
              </a>
              ) and then, choose the Operating System (see
              <a class="reference internal" href="#imageros">
               <span class="std std-numref">
                Fig. 2.3
               </span>
              </a>
              )
and Storage options (CHOOSE STORAGE) to burn an SD card with the
Raspberry PI OS 32 bits version. Click on the NEXT button and you
will have the options (see
              <a class="reference internal" href="#imagersettings">
               <span class="std std-numref">
                Fig. 2.4
               </span>
              </a>
              ,
              <a class="reference internal" href="#imagergeneral">
               <span class="std std-numref">
                Fig. 2.5
               </span>
              </a>
              ,
              <a class="reference internal" href="#imagerservices">
               <span class="std std-numref">
                Fig. 2.6
               </span>
              </a>
              ,
              <a class="reference internal" href="#imageroptions">
               <span class="std std-numref">
                Fig. 2.7
               </span>
              </a>
              ) to apply your specific customization (
              <strong>
               enable
SSH
              </strong>
              , Username (rpi-student) and Password (rpi) , WIFI SSID and passkey, and your
keyboard language configuration). Save the configuration and continue to write
the micro SD Card.
             </p>
            </li>
           </ol>
           <figure class="align-center" id="imagermain">
            <a class="reference internal image-reference" href="_images/imagermain.png">
             <img alt="_images/imagermain.png" src="_images/imagermain.png" style="width: 10cm; height: 8cm;"/>
            </a>
            <figcaption>
             <p>
              <span class="caption-text">
               Raspberry Pi Imager main screen
              </span>
              <a class="headerlink" href="#imagermain" title="Link to this image">
               
              </a>
             </p>
            </figcaption>
           </figure>
           <figure class="align-center" id="imagerhw">
            <a class="reference internal image-reference" href="_images/imagerhwselect.png">
             <img alt="_images/imagerhwselect.png" src="_images/imagerhwselect.png" style="width: 10cm; height: 8cm;"/>
            </a>
            <figcaption>
             <p>
              <span class="caption-text">
               Raspberry Pi Imager HW model
              </span>
              <a class="headerlink" href="#imagerhw" title="Link to this image">
               
              </a>
             </p>
            </figcaption>
           </figure>
           <figure class="align-center" id="imageros">
            <a class="reference internal image-reference" href="_images/imagerosselect.png">
             <img alt="_images/imagerosselect.png" src="_images/imagerosselect.png" style="width: 10cm; height: 8cm;"/>
            </a>
            <figcaption>
             <p>
              <span class="caption-text">
               Raspberry Pi Imager OS selection
              </span>
              <a class="headerlink" href="#imageros" title="Link to this image">
               
              </a>
             </p>
            </figcaption>
           </figure>
           <figure class="align-center" id="imagersettings">
            <a class="reference internal image-reference" href="_images/imagersettings.png">
             <img alt="_images/imagersettings.png" src="_images/imagersettings.png" style="width: 10cm; height: 6cm;"/>
            </a>
            <figcaption>
             <p>
              <span class="caption-text">
               Raspberry Pi Imager Settings (
               <a class="reference external" href="https://www.raspberrypi.com/documentation/computers/getting-started.html#install-using-imager">
                more info from RPI official documentation
               </a>
               )
              </span>
              <a class="headerlink" href="#imagersettings" title="Link to this image">
               
              </a>
             </p>
            </figcaption>
           </figure>
           <figure class="align-center" id="imagergeneral">
            <a class="reference internal image-reference" href="_images/imagergeneral.png">
             <img alt="_images/imagergeneral.png" src="_images/imagergeneral.png" style="width: 8cm; height: 6cm;"/>
            </a>
            <figcaption>
             <p>
              <span class="caption-text">
               Raspberry Pi Imager General Settings
              </span>
              <a class="headerlink" href="#imagergeneral" title="Link to this image">
               
              </a>
             </p>
            </figcaption>
           </figure>
           <figure class="align-center" id="imagerservices">
            <a class="reference internal image-reference" href="_images/imagerservices.png">
             <img alt="_images/imagerservices.png" src="_images/imagerservices.png" style="width: 8cm; height: 6cm;"/>
            </a>
            <figcaption>
             <p>
              <span class="caption-text">
               Raspberry Pi Imager OS Services
              </span>
              <a class="headerlink" href="#imagerservices" title="Link to this image">
               
              </a>
             </p>
            </figcaption>
           </figure>
           <figure class="align-center" id="imageroptions">
            <a class="reference internal image-reference" href="_images/imageroptions.png">
             <img alt="_images/imageroptions.png" src="_images/imageroptions.png" style="width: 8cm; height: 6cm;"/>
            </a>
            <figcaption>
             <p>
              <span class="caption-text">
               Raspberry Pi Imager OS Options
              </span>
              <a class="headerlink" href="#imageroptions" title="Link to this image">
               
              </a>
             </p>
            </figcaption>
           </figure>
           <div class="admonition warning">
            <p class="admonition-title">
             Warning
            </p>
            <p>
             <strong>
              [VERY IMPORTANT]:
             </strong>
             Be careful in the destination device    where the image is burned because this information is not    recoverable
            </p>
           </div>
           <ol class="arabic simple" start="3">
            <li>
             <p>
              Wait until the program ends writing the SD Card
              <strong>
               (this can take up
to one hour depending on your SD card category and model)
              </strong>
              .
             </p>
            </li>
           </ol>
          </section>
          <section id="setting-up-the-raspberry-pi">
           <h4>
            Setting up the Raspberry Pi
            <a class="headerlink" href="#setting-up-the-raspberry-pi" title="Link to this heading">
             
            </a>
           </h4>
           <p>
            We need to interact with the Raspberry Pi for the activities described
in this document. There are three ways to establish this interaction:
           </p>
           <ul class="simple">
            <li>
             <p>
              The easiest one is connecting an HDMI monitor, a USB keyboard, and a
USB mouse. This configuration allows us to use the Raspberry Pi as we
would with a regular computer. Once the RPI is booted, we can set the
WiFi connections and other settings such as enable the use of a
serial line.
             </p>
            </li>
            <li>
             <p>
              Opening an SSH session between your computer and the Raspberry Pi
without connecting additional peripherals. This kind of configuration
is known as headless start (use the
              <cite>
               rpi-student
              </cite>
              login).
             </p>
            </li>
            <li>
             <p>
              Use the serial USB-TTL cable that you need to connect to the GPIO
expansion connector. This requires first to enable the serial line in
the Raspberry PI OS using the
              <a class="reference external" href="https://www.raspberrypi.com/documentation/computers/configuration.html#list-of-options">
               raspi-config
              </a>
              tool.
The connection of the USB-TTL cable is depicted in
              <a class="reference internal" href="#rpiwithconnector">
               <span class="std std-numref">
                Fig. 2.8
               </span>
              </a>
              .
             </p>
            </li>
           </ul>
           <figure class="align-center" id="rpiwithconnector">
            <a class="reference internal image-reference" href="_images/rpi3withconnector.png">
             <img alt="_images/rpi3withconnector.png" src="_images/rpi3withconnector.png" style="width: 8cm; height: 8cm;"/>
            </a>
            <figcaption>
             <p>
              <span class="caption-text">
               Detail of expansion connector highlighting the USB-TTL RS232
              </span>
              <a class="headerlink" href="#rpiwithconnector" title="Link to this image">
               
              </a>
             </p>
            </figcaption>
           </figure>
          </section>
          <section id="reviewing-the-sd-card-content">
           <h4>
            Reviewing the SD card content
            <a class="headerlink" href="#reviewing-the-sd-card-content" title="Link to this heading">
             
            </a>
           </h4>
           <ol class="arabic simple">
            <li>
             <p>
              Plug in the SD card into the computer.
             </p>
            </li>
            <li>
             <p>
              You should now see one new drive in the System Explorer (Windows)/Nautilus (Ubuntu)
named &ldquo;boot&rdquo;. In Linux you will see two partitions mounted in your
system. Open the partition/unit identified as &ldquo;boot&rdquo;.
             </p>
            </li>
           </ol>
           <div class="admonition note">
            <p class="admonition-title">
             Note
            </p>
            <p>
             <strong>
              [VERY IMPORTANT]:
             </strong>
             This is the partition used by          Raspberry to make the necessary hardware configuration before starting the operating system. Beware of not    deleting or modifying files other than those described in this  manual, or the Raspberry may not boot.
            </p>
           </div>
           <ol class="arabic simple" start="3">
            <li>
             <p>
              List the content of the boot partition (FAT32) and identify the files
as in
              <a class="reference internal" href="#usdcardfat">
               <span class="std std-numref">
                Fig. 2.9
               </span>
              </a>
              (Ubuntu Linux).
             </p>
            </li>
           </ol>
           <figure class="align-center" id="usdcardfat">
            <a class="reference internal image-reference" href="_images/usdcardfat.png">
             <img alt="_images/usdcardfat.png" src="_images/usdcardfat.png" style="width: 15cm; height: 10cm;"/>
            </a>
            <figcaption>
             <p>
              <span class="caption-text">
               Files available in the FAT32 partition
              </span>
              <a class="headerlink" href="#usdcardfat" title="Link to this image">
               
              </a>
             </p>
            </figcaption>
           </figure>
          </section>
          <section id="booting-the-rpi">
           <h4>
            Booting the RPI
            <a class="headerlink" href="#booting-the-rpi" title="Link to this heading">
             
            </a>
           </h4>
           <p>
            Insert the SD card and connect the power supply and all other cables
needed. The first time you boot your RPI you will see how the RPI is
configured (this information is only displayed in the HDMI monitor) and
rebooted. Wait 1 or 2 minutes (this depends again on your SD card
category) until the RPI is completely booted.
           </p>
           <div class="admonition note">
            <p class="admonition-title">
             Note
            </p>
            <p>
             <strong>
              [Security]:
             </strong>
             Having the default user and password supposes a security issue, more if the SSH sessions are enabled. You can always change the password by executing the command passwd once logged in.
            </p>
           </div>
          </section>
          <section id="discovering-the-rpi-ip-address">
           <h4>
            Discovering the RPI IP address
            <a class="headerlink" href="#discovering-the-rpi-ip-address" title="Link to this heading">
             
            </a>
           </h4>
           <p>
            To open an SSH session from your computer to the Raspberry Pi you need
to know its IP address. There are multiple ways to discover the
Raspberry Pi IP address:
           </p>
           <ol class="loweralpha simple">
            <li>
             <p>
              Use an
              <a class="reference external" href="https://www.softperfect.com/products/networkscanner">
               IP Scanner utility
              </a>
              ,
and scan in the range of your network. For example, you can quickly identify a
Raspberry Pi as they use the hostname &ldquo;raspberrypi.local&rdquo; by default.
This tool cannot be used at the UPM lab.
             </p>
            </li>
            <li>
             <p>
              If you know your Raspberry Pi MAC address, you can set the DHCP
server to assign a static IP to the Raspberry Pi MAC. This is
typically done in the router configuration. Please, consider that
Ethernet and WiFi ports have different MAC addresses. In the
laboratory, your Raspberry can have only a dynamically assigned IP in
the WIFI network with SSID RPI (ask your instructor to verify the
configuration).
             </p>
            </li>
            <li>
             <p>
              You could open an RS232 serial connection in the Raspberry Pi GPIO
ports and use the command line (
              <cite>
               ifconfig
              </cite>
              command) to obtain the IP or
set the desired IP and netmask.
             </p>
            </li>
           </ol>
          </section>
          <section id="raspberry-pi-os-update">
           <h4>
            Raspberry Pi OS Update
            <a class="headerlink" href="#raspberry-pi-os-update" title="Link to this heading">
             
            </a>
           </h4>
           <p>
            You can update and upgrade the OS if you have an internet connection.
Please, do not update the OS during the classes, as this operation will
require some time. You can update the OS by running the following
commands:
           </p>
           <div class="literal-block-wrapper docutils container" id="id1">
            <div class="code-block-caption">
             <span class="caption-text">
              RPI OS update
             </span>
             <a class="headerlink" href="#id1" title="Link to this code">
              
             </a>
            </div>
            <div class="highlight-bash notranslate">
             <div class="highlight">
              <pre><span></span>$<span class="w"> </span>sudo<span class="w"> </span>apt<span class="w"> </span>update
$<span class="w"> </span>sudo<span class="w"> </span>apt<span class="w"> </span>upgrade
</pre>
             </div>
            </div>
           </div>
          </section>
         </section>
         <section id="integration-of-a-3-axis-accelerometer-with-raspberry-pi">
          <h3>
           Integration of a 3-axis accelerometer with Raspberry-Pi
           <a class="headerlink" href="#integration-of-a-3-axis-accelerometer-with-raspberry-pi" title="Link to this heading">
            
           </a>
          </h3>
          <section id="specifications">
           <h4>
            Specifications
            <a class="headerlink" href="#specifications" title="Link to this heading">
             
            </a>
           </h4>
           <p>
            The student must investigate functions and commands and implement a C
program to get the following requirements:
           </p>
           <ol class="arabic simple">
            <li>
             <p>
              Show the values of the 3-axis acceleration obtained from the MPU-6000
I2C sensor.
             </p>
            </li>
            <li>
             <p>
              The measurement readings are shown every 3 seconds.
             </p>
            </li>
           </ol>
          </section>
          <section id="suggested-improvements">
           <h4>
            Suggested Improvements
            <a class="headerlink" href="#suggested-improvements" title="Link to this heading">
             
            </a>
           </h4>
           <ul class="simple">
            <li>
             <p>
              Analyses the problem of offsets in the values returned. Define and
implement a method to get corrected values
             </p>
            </li>
            <li>
             <p>
              Get stop the program if &ldquo;CRTL-C&rdquo; is typed.
             </p>
            </li>
           </ul>
          </section>
          <section id="optional-python-script">
           <h4>
            Optional: Python Script
            <a class="headerlink" href="#optional-python-script" title="Link to this heading">
             
            </a>
           </h4>
           <p>
            For advanced students, the implementation of this exercise in Python is
proposed. For this, you can use any of the multiple Python modules that
gain access to I2C interface in the Raspberry Pi.
           </p>
          </section>
         </section>
         <section id="compiling-linking-c-program-in-linux">
          <h3>
           Compiling &amp; linking C program in Linux
           <a class="headerlink" href="#compiling-linking-c-program-in-linux" title="Link to this heading">
            
           </a>
          </h3>
          <p>
           In Linux, C/c++ programs are compiled and linked using the &ldquo;make&rdquo;
command. This command searches a &ldquo;Makefile&rdquo;. A &ldquo;Makefile&rdquo; is a text file
with the necessary information to compile and link and must be in the
same directory of
           <em>
            myprogram.c
           </em>
           . The result will be
           <em>
            myprogram.o
           </em>
           and
           <em>
            myprogram
           </em>
           (executable).
          </p>
          <div class="literal-block-wrapper docutils container" id="id2">
           <div class="code-block-caption">
            <span class="caption-text">
             Detail Makefile
            </span>
            <a class="headerlink" href="#id2" title="Link to this code">
             
            </a>
           </div>
           <div class="highlight-Makefile notranslate">
            <div class="highlight">
             <pre><span></span><span class="nv">DEBUG</span><span class="o">=</span><span class="w"> </span>-O2<span class="w"> </span><span class="c1">#Debugging Level</span>

<span class="nv">CC</span><span class="o">=</span><span class="w"> </span>gcc<span class="w"> </span><span class="c1">#Compiler command</span>
<span class="nv">INCLUDE</span><span class="o">=</span><span class="w"> </span>-I/usr/local/include<span class="w"> </span><span class="c1">#Include directory</span>
<span class="nv">CFLAGS</span><span class="o">=</span><span class="w"> </span><span class="k">$(</span>DEBUG<span class="k">)</span><span class="w"> </span>-Wall<span class="w"> </span><span class="k">$(</span>INCLUDE<span class="k">)</span><span class="w"> </span>-Winline<span class="w"> </span><span class="c1">#Compiler Flags</span>
<span class="nv">LDFLAGS</span><span class="o">=</span><span class="w"> </span>-L/usr/local/lib<span class="w"> </span><span class="c1">#Linker Flags</span>

<span class="nv">LIBS</span><span class="o">=</span><span class="w"> </span>-lpthread<span class="w"> </span>-lm<span class="w"> </span><span class="c1">#Libraries used if needed</span>

<span class="nv">SRC</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>myprogram.c

<span class="nv">OBJ</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="k">$(</span>SRC:.c<span class="o">=</span>.o<span class="k">)</span>
<span class="nv">BIN</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="k">$(</span>SRC:.c<span class="o">=</span><span class="k">)</span>

<span class="nf">$(BIN)</span><span class="o">:</span><span class="w">       </span><span class="k">$(</span><span class="nv">OBJ</span><span class="k">)</span>
<span class="w">     </span>@echo<span class="w"> </span><span class="o">[</span>link<span class="o">]</span><span class="w"> </span><span class="nv">$@</span>
<span class="w">     </span><span class="k">$(</span>CC<span class="k">)</span><span class="w"> </span>-o<span class="w"> </span><span class="nv">$@</span><span class="w"> </span>$&lt;<span class="w"> </span><span class="k">$(</span>LDFLAGS<span class="k">)</span><span class="w"> </span><span class="k">$(</span>LIBS<span class="k">)</span>
<span class="nf">.c.o</span><span class="o">:</span>
<span class="w">     </span>@echo<span class="w"> </span><span class="o">[</span>Compile<span class="o">]</span><span class="w"> </span>$&lt;
<span class="w">     </span><span class="k">$(</span>CC<span class="k">)</span><span class="w"> </span>-c<span class="w"> </span><span class="k">$(</span>CFLAGS<span class="k">)</span><span class="w"> </span>$&lt;<span class="w"> </span>-o<span class="w"> </span><span class="nv">$@</span>

<span class="nf">clean</span><span class="o">:</span>
<span class="w">     </span>@rm<span class="w"> </span>-f<span class="w"> </span><span class="k">$(</span>OBJ<span class="k">)</span><span class="w"> </span><span class="k">$(</span>BIN<span class="k">)</span>
</pre>
            </div>
           </div>
          </div>
         </section>
         <section id="questions-to-be-reported-to-instructors">
          <h3>
           Questions to be reported to instructors
           <a class="headerlink" href="#questions-to-be-reported-to-instructors" title="Link to this heading">
            
           </a>
          </h3>
          <ol class="arabic simple">
           <li>
            <p>
             Explain the content of the
             <cite>
              config.txt
             </cite>
             file in the FAT32 partition of the uSDCARD of your RPI
            </p>
           </li>
           <li>
            <p>
             How the I2C interface is enabled? Is there any change in the
config.txt file?
            </p>
           </li>
           <li>
            <p>
             Could you describe the commands used to compile a C/C++ program in
Linux?
            </p>
           </li>
           <li>
            <p>
             What is a library? What is the difference between a static and a
shared library?
            </p>
           </li>
           <li>
            <p>
             Summarize the utility of the
             <cite>
              makefile
             </cite>
             file and the make command.
            </p>
           </li>
           <li>
            <p>
             What is the preferred utility to debug a C program in Linux?
            </p>
           </li>
           <li>
            <p>
             How can you obtain the serial number of your Raspberry Pi? Is there
any relation between the serial number and the MAC address?
            </p>
           </li>
          </ol>
         </section>
        </section>
        <span id="document-rpi-tutorial">
        </span>
        <img alt="_images/image1.jpeg" src="_images/image1.jpeg"/>
        <p>
         <a class="reference internal" href="_images/image2.png">
          <img alt="image1" src="_images/image2.png" style="width: 0.91667in; height: 0.32292in;"/>
         </a>
         Embedded Linux Systems: Using Buildroot for building Embedded
Linux Systems on Raspberry Pi 4 and 3 Model B by Mariano Ruiz is licensed
under a
         <a class="reference external" href="http://creativecommons.org/licenses/by-sa/4.0/">
          Creative Commons Attribution-ShareAlike 4.0 International
License
         </a>
         .
        </p>
        <section id="embedded-linux-with-rpi">
         <h2>
          Embedded Linux With RPI
          <a class="headerlink" href="#embedded-linux-with-rpi" title="Link to this heading">
           
          </a>
         </h2>
         <section id="document-overview">
          <h3>
           Document Overview
           <a class="headerlink" href="#document-overview" title="Link to this heading">
            
           </a>
          </h3>
          <p>
           This document describes the steps to develop an embedded Linux-based
system using the Raspberry PI board. The document has been specifically
written to use a Raspberry PI development system based on the BCM2837
processor. All the software elements used have a GPL license.
          </p>
          <div class="admonition note">
           <p class="admonition-title">
            Note
           </p>
           <p>
            The time necessary to  complete all the tutorial steps is approximately 8 hours.
           </p>
          </div>
          <p>
           Read all the instructions carefully before executing the practical part;
Otherwise, you will find errors, which are probably unpredicted. In
parallel, you need to review the slides available at the Moodle site or
at [RD1]
          </p>
         </section>
         <section id="references">
          <h3>
           References
           <a class="headerlink" href="#references" title="Link to this heading">
            
           </a>
          </h3>
          <ol class="arabic">
           <li>
            <p>
             Embedded Linux system development.
             <a class="reference external" href="https://moodle.upm.es/titulaciones/oficiales/course/view.php?id=1969">
              Slides
             </a>
            </p>
           </li>
           <li>
            <p>
             <a class="reference external" href="https://bootlin.com/training/embedded-linux/">
              https://bootlin.com/training/embedded-linux/
             </a>
            </p>
           </li>
           <li>
            <p>
             Mastering Embedded Linux Programming - Second Edition. Packt.
             <a class="reference external" href="https://www.packtpub.com/product/mastering-embedded-linux-programming-second-edition/9781787283282">
              https://www.packtpub.com/product/mastering-embedded-linux-programming-second-edition/9781787283282
             </a>
            </p>
           </li>
           <li>
            <p>
             Raspberry-Pi User Guide. Reference Manual.
            </p>
            <p>
             <a class="reference external" href="http://www.myraspberry-pi.org/wp-content/.../Raspberry.Pi_.User_.Guide_.pdf&lrm;">
              www.myraspberry-pi.org/wp-content/&hellip;/Raspberry.Pi_.User_.Guide_.pdf&lrm;
             </a>
            </p>
           </li>
          </ol>
         </section>
         <section id="building-linux-using-buildroot">
          <h3>
           Building Linux using buildroot
           <a class="headerlink" href="#building-linux-using-buildroot" title="Link to this heading">
            
           </a>
          </h3>
          <section id="elements-needed-for-the-execution-of-these-labs">
           <h4>
            Elements needed for the execution of these LABS
            <a class="headerlink" href="#elements-needed-for-the-execution-of-these-labs" title="Link to this heading">
             
            </a>
           </h4>
           <p>
            In order to execute this lab properly, you need the following elements:
           </p>
           <ol class="arabic simple">
            <li>
             <p>
              The VMware player software version 17.6.1 or above. Available at
              <a class="reference external" href="https://support.broadcom.com/group/ecx/productdownloads?subfamily=VMware+Workstation+Pro">
               Broadcom website
              </a>
              (free download and use but you need to register).
This software has already been installed on the laboratory desktop
computer.
             </p>
            </li>
            <li>
             <p>
              A VMWare virtual machine with Ubuntu 24.04 and all the software
packages installed is already available on the Desktop. This virtual
machine is available for your personal use. If you want to set up
your virtual machine by yourself, follow the instructions provided in
              <a class="reference external" href="#_annex_i:_Ubuntu">
               Annex I
              </a>
              .
             </p>
            </li>
            <li>
             <p>
              A Raspberry Pi, accessories and a USB cable are available at the
laboratory.
             </p>
            </li>
            <li>
             <p>
              Basic knowledge of Linux commands.
             </p>
            </li>
           </ol>
          </section>
         </section>
         <section id="starting-the-vmware">
          <h3>
           Starting the VMware
           <a class="headerlink" href="#starting-the-vmware" title="Link to this heading">
            
           </a>
          </h3>
          <p>
           Start VMware Player and open the RPI Virtual Machine. Wait until the
welcome screen is displayed (see
           <a class="reference internal" href="#vmplayer">
            <span class="std std-numref">
             Fig. 3.1
            </span>
           </a>
           and
           <a class="reference internal" href="#vmplayer-ubuntu">
            <span class="std std-numref">
             Fig. 3.2
            </span>
           </a>
           ). Login as
&ldquo;
           <em>
            ubuntu&rdquo;
           </em>
           user using the password &ldquo;ubuntu&rdquo;.
          </p>
          <figure class="align-center" id="vmplayer">
           <a class="reference internal image-reference" href="_images/image4.png">
            <img alt="_images/image4.png" src="_images/image4.png" style="width: 10cm; height: 8cm;"/>
           </a>
           <figcaption>
            <p>
             <span class="caption-text">
              Main screen of VMware player with some VM available to be executed
             </span>
             <a class="headerlink" href="#vmplayer" title="Link to this image">
              
             </a>
            </p>
           </figcaption>
          </figure>
          <figure class="align-center" id="vmplayer-ubuntu">
           <a class="reference internal image-reference" href="_images/image5.png">
            <img alt="_images/image5.png" src="_images/image5.png" style="width: 15cm; height: 10cm;"/>
           </a>
           <figcaption>
            <p>
             <span class="caption-text">
              Ubuntu Virtual Machine login screen.
             </span>
             <a class="headerlink" href="#vmplayer-ubuntu" title="Link to this image">
              
             </a>
            </p>
           </figcaption>
          </figure>
          <p>
           Open the
           <strong>
            Firefox
           </strong>
           web browser and download from
           <a class="reference external" href="https://buildroot.org/">
            https://buildroot.org/
           </a>
           , the version identified as
           <strong>
            buidlroot2024-08-1
           </strong>
           (use the download link, see
           <a class="reference internal" href="#webbuildroot">
            <span class="std std-numref">
             Fig. 3.3
            </span>
           </a>
           , and navigate searching for earlier
releases if necessary,
           <a class="reference external" href="https://buildroot.org/downloads/">
            https://buildroot.org/downloads/
           </a>
           ). Save the file
to the
           <strong>
            Documents
           </strong>
           folder in your account (
           <a class="reference internal" href="#download">
            <span class="std std-numref">
             Fig. 3.4
            </span>
           </a>
           ).
          </p>
          <figure class="align-center" id="webbuildroot">
           <a class="reference internal image-reference" href="_images/buildrootweb.png">
            <img alt="_images/buildrootweb.png" src="_images/buildrootweb.png" style="width: 10cm; height: 7cm;"/>
           </a>
           <figcaption>
            <p>
             <span class="caption-text">
              Buildroot home page.
             </span>
             <a class="headerlink" href="#webbuildroot" title="Link to this image">
              
             </a>
            </p>
           </figcaption>
          </figure>
          <p>
           Buildroot is a tool to generate embedded Linux systems in our PC, and
then this Linux will be installed in the target.
          </p>
          <figure class="align-center" id="download">
           <a class="reference internal image-reference" href="_images/buildrootdownload.png">
            <img alt="_images/buildrootdownload.png" src="_images/buildrootdownload.png" style="width: 10cm; height: 7cm;"/>
           </a>
           <figcaption>
            <p>
             <span class="caption-text">
              Example of Downloading Buildroot source code.
             </span>
             <a class="headerlink" href="#download" title="Link to this image">
              
             </a>
            </p>
           </figcaption>
          </figure>
          <p>
           Create a folder &ldquo;rpi&rdquo; in &ldquo;Documents&rdquo;. Copy the file to the
&ldquo;Documents/rpi&rdquo; folder and decompress the file (
           <a class="reference internal" href="#docfolder">
            <span class="std std-numref">
             Fig. 3.5
            </span>
           </a>
           ).
          </p>
          <figure class="align-center" id="docfolder">
           <a class="reference internal image-reference" href="_images/documentsfolder.png">
            <img alt="_images/documentsfolder.png" src="_images/documentsfolder.png" style="width: 6.69375in; height: 1.5in;"/>
           </a>
           <figcaption>
            <p>
             <span class="caption-text">
              Buildroot folder (the folder name depends on the version downloaded).
             </span>
             <a class="headerlink" href="#docfolder" title="Link to this image">
              
             </a>
            </p>
           </figcaption>
          </figure>
          <p>
           Right-click in the window and execute &ldquo;Open in Terminal&rdquo; or execute the
Terminal application from Dash home as shown in
           <a class="reference internal" href="#terminal">
            <span class="std std-numref">
             Fig. 3.6
            </span>
           </a>
           (if &ldquo;Open in
Terminal&rdquo; is not available, search how to install it in Ubuntu).
          </p>
          <figure class="align-center" id="terminal">
           <a class="reference internal image-reference" href="_images/openaterminal.png">
            <img alt="_images/openaterminal.png" src="_images/openaterminal.png" style="width: 4.20139in; height: 2.0in;"/>
           </a>
           <figcaption>
            <p>
             <span class="caption-text">
              Terminal application
             </span>
             <a class="headerlink" href="#terminal" title="Link to this image">
              
             </a>
            </p>
           </figcaption>
          </figure>
          <p>
           In some seconds, a command window is displayed. Then, execute these
commands:
          </p>
          <div class="highlight-bash notranslate">
           <div class="highlight">
            <pre><span></span>$<span class="w"> </span>mkdir<span class="w"> </span>build
$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>build
$<span class="w"> </span>make<span class="w"> </span><span class="nv">O</span><span class="o">=</span><span class="nv">$PWD</span><span class="w"> </span>-C<span class="w"> </span>/home/ubuntu/Documents/rpi/buildroot-2024.08.1/<span class="w"> </span>menuconfig
</pre>
           </div>
          </div>
          <div class="admonition important">
           <p class="admonition-title">
            Important
           </p>
           <p>
            For this course, you will need to become familiar with the Linux Terminal use. On the Moodle site of this course, you can find a cheat sheet with the basic Linux commands.
           </p>
          </div>
          <div class="admonition tip">
           <p class="admonition-title">
            Tip
           </p>
           <p>
            In a Linux terminal, the &ldquo;TAB&rdquo; key helps you to  autocomplete the commands, folders, and file names.
           </p>
          </div>
          <p>
           In some seconds, you will see a new window similar to
           <a class="reference internal" href="#buildrootsetup">
            <span class="std std-numref">
             Fig. 3.7
            </span>
           </a>
           .
          </p>
          <figure class="align-center" id="buildrootsetup">
           <a class="reference internal image-reference" href="_images/image10.png">
            <img alt="_images/image10.png" src="_images/image10.png" style="width: 6.69375in; height: 3.20208in;"/>
           </a>
           <figcaption>
            <p>
             <span class="caption-text">
              Buildroot setup screen.
             </span>
             <a class="headerlink" href="#buildrootsetup" title="Link to this image">
              
             </a>
            </p>
           </figcaption>
          </figure>
         </section>
         <section id="configuring-buildroot-for-rpi4">
          <h3>
           Configuring Buildroot for RPI4
           <a class="headerlink" href="#configuring-buildroot-for-rpi4" title="Link to this heading">
            
           </a>
          </h3>
          <p>
           Once the
           <strong>
            Buildroot
           </strong>
           configuration is started, it is necessary to
configure the different items. You need to navigate the different menus
and select the installation elements. Table I contains the specific
configuration of
           <strong>
            Buildroot
           </strong>
           for installing it in the Raspberry Pi.
Depending on the downloaded version, the organization and the items
displayed can differ. If an item of buildroot configuration does not
appear in the Table I leaves it with its default value.
          </p>
          <div class="admonition important">
           <p class="admonition-title">
            Important
           </p>
           <p>
            The Buildroot configuration is an iterative process. In order to set up your embedded Linux system, you  will need to execute the configuration several times.
           </p>
          </div>
          <div class="admonition warning">
           <p class="admonition-title">
            Warning
           </p>
           <p>
            The tables have three colums. Check that you understnad all the content shown.
           </p>
          </div>
          <section id="target-options">
           <h4>
            Target Options
            <a class="headerlink" href="#target-options" title="Link to this heading">
             
            </a>
           </h4>
           <p>
            This is the  selection of the processor to use (
            <a class="reference internal" href="#id1">
             <span class="std std-numref">
              Table 3.1
             </span>
            </a>
            ).
           </p>
           <table class="docutils align-default" id="id1">
            <caption>
             <span class="caption-text">
              Target Options
             </span>
             <a class="headerlink" href="#id1" title="Link to this table">
              
             </a>
            </caption>
            <tbody>
             <tr class="row-odd">
              <td>
               <p>
                Target Architecture
               </p>
              </td>
              <td>
               <p>
                AArch64 (little endian)
               </p>
              </td>
              <td>
               <p>
                ARM 64 bits
               </p>
              </td>
             </tr>
             <tr class="row-even">
              <td>
               <p>
                Target Architecture Variants.
               </p>
              </td>
              <td>
               <p>
                Cortex-A72
               </p>
              </td>
              <td>
              </td>
             </tr>
             <tr class="row-odd">
              <td>
               <p>
                Floating Point Strategy
               </p>
              </td>
              <td>
               <p>
                VFPv4
               </p>
              </td>
              <td>
              </td>
             </tr>
             <tr class="row-even">
              <td>
               <p>
                MMU  Page Size
               </p>
              </td>
              <td>
               <p>
                4KB
               </p>
              </td>
              <td>
              </td>
             </tr>
             <tr class="row-odd">
              <td>
               <p>
                Target Binary Format
               </p>
              </td>
              <td>
               <p>
                ELF
               </p>
              </td>
              <td>
              </td>
             </tr>
            </tbody>
           </table>
          </section>
          <section id="toolchain">
           <h4>
            Toolchain
            <a class="headerlink" href="#toolchain" title="Link to this heading">
             
            </a>
           </h4>
           <p>
            Cross Compiler, linker, and libraries to be  built to compile our embedded application. Select the options shown in the following table (
            <a class="reference internal" href="#id2">
             <span class="std std-numref">
              Table 3.2
             </span>
            </a>
            ).
           </p>
           <table class="docutils align-default" id="id2">
            <caption>
             <span class="caption-text">
              Toolchain
             </span>
             <a class="headerlink" href="#id2" title="Link to this table">
              
             </a>
            </caption>
            <colgroup>
             <col style="width: 33.3%"/>
             <col style="width: 33.3%"/>
             <col style="width: 33.3%"/>
            </colgroup>
            <tbody>
             <tr class="row-odd">
              <td>
               <p>
                Toolchain type
               </p>
              </td>
              <td>
               <p>
                Buildroot toolchain
               </p>
              </td>
              <td>
               <p>
                The Embedded Linux System will be compiled with tools integrated  into Buildroot
               </p>
              </td>
             </tr>
             <tr class="row-even">
              <td>
               <p>
                Custom toolchain vendor name.
               </p>
              </td>
              <td>
               <p>
                buildroot
               </p>
              </td>
              <td>
              </td>
             </tr>
             <tr class="row-odd">
              <td>
               <p>
                C library
               </p>
              </td>
              <td>
               <p>
                glib
               </p>
              </td>
              <td>
               <p>
                Library    containing the typical C  libraries used in  Linux    environments   (stdlib, stdio,   etc)
               </p>
              </td>
             </tr>
             <tr class="row-even">
              <td>
               <p>
                Kernel Header Options
               </p>
              </td>
              <td>
               <p>
                6.6.x kernel headers
               </p>
              </td>
              <td>
              </td>
             </tr>
             <tr class="row-odd">
              <td>
               <p>
                Binutils Version
               </p>
              </td>
              <td>
               <p>
                2.41
               </p>
              </td>
              <td>
               <p>
                Binutils contains  tools to manage    the binary files obtained in the   compilation of   the different     applications
               </p>
              </td>
             </tr>
             <tr class="row-even">
              <td>
               <p>
                GCC  compiler Version
               </p>
              </td>
              <td>
               <p>
                gcc 13.x
               </p>
              </td>
              <td>
               <p>
                GCC tools version to be installed
               </p>
              </td>
             </tr>
             <tr class="row-odd">
              <td>
               <p>
                Enable C++ support
               </p>
              </td>
              <td>
               <p>
                Yes.
               </p>
              </td>
              <td>
               <p>
                Including support for C++ programming, compiling, and    linking.
               </p>
              </td>
             </tr>
             <tr class="row-even">
              <td>
               <p>
                Build cross gdb for the host
               </p>
              </td>
              <td>
               <p>
                Yes.
               </p>
              </td>
              <td>
               <p>
                Includes the  support for GDB.
               </p>
              </td>
             </tr>
             <tr class="row-odd">
              <td>
               <p>
                Add Python support
               </p>
              </td>
              <td>
              </td>
              <td>
              </td>
             </tr>
             <tr class="row-even">
              <td>
               <p>
                GDB debugger version
               </p>
              </td>
              <td>
               <p>
                gdb 14.x
               </p>
              </td>
              <td>
              </td>
             </tr>
            </tbody>
           </table>
          </section>
          <section id="build-options">
           <h4>
            Build options
            <a class="headerlink" href="#build-options" title="Link to this heading">
             
            </a>
           </h4>
           <p>
            How Buidlroot will build the code. Leave the default values.
           </p>
          </section>
          <section id="system-configuration">
           <h4>
            System Configuration
            <a class="headerlink" href="#system-configuration" title="Link to this heading">
             
            </a>
           </h4>
           <p>
            Here you can define the basic configuration of the embedded Linux to generate and specific scripts to add additional functionality (
            <a class="reference internal" href="#sysconf">
             <span class="std std-numref">
              Table 3.3
             </span>
            </a>
            ).
           </p>
           <table class="docutils align-default" id="sysconf">
            <caption>
             <span class="caption-text">
              System-configuration
             </span>
             <a class="headerlink" href="#sysconf" title="Link to this table">
              
             </a>
            </caption>
            <tbody>
             <tr class="row-odd">
              <td>
               <p>
                Root FS skeleton
               </p>
              </td>
              <td>
               <p>
                Default target skeleton.
               </p>
              </td>
              <td>
               <p>
                Linux folder filesystem organization for skeleton the embedded system
               </p>
              </td>
             </tr>
             <tr class="row-even">
              <td>
               <p>
                System hostname
               </p>
              </td>
              <td>
               <p>
                <strong>
                 buildroot
                </strong>
               </p>
              </td>
              <td>
               <p>
                Name of the embedded system
               </p>
              </td>
             </tr>
             <tr class="row-odd">
              <td>
               <p>
                System Banner
               </p>
              </td>
              <td>
               <p>
                <strong>
                 Linux RPI 4
                </strong>
               </p>
              </td>
              <td>
               <p>
                Banner.
               </p>
              </td>
             </tr>
             <tr class="row-even">
              <td>
               <p>
                Passwords encoding
               </p>
              </td>
              <td>
               <p>
                sha 256
               </p>
              </td>
              <td>
              </td>
             </tr>
             <tr class="row-odd">
              <td>
               <p>
                Init System
               </p>
              </td>
              <td>
               <p>
                Busybox
               </p>
              </td>
              <td>
              </td>
             </tr>
             <tr class="row-even">
              <td>
               <p>
                /dev management
               </p>
              </td>
              <td>
               <p>
                Dynamic using devtmpfs + mdev
               </p>
              </td>
              <td>
              </td>
             </tr>
             <tr class="row-odd">
              <td>
               <p>
                Path to permissions for table
               </p>
              </td>
              <td>
               <p>
                <strong>
                 system/device_table.txt
                </strong>
               </p>
              </td>
              <td>
              </td>
             </tr>
             <tr class="row-even">
              <td>
               <p>
                Enable root login with password
               </p>
              </td>
              <td>
               <p>
                yes
               </p>
              </td>
              <td>
              </td>
             </tr>
             <tr class="row-odd">
              <td>
               <p>
                Root password
               </p>
              </td>
              <td>
               <p>
                rpi
               </p>
              </td>
              <td>
              </td>
             </tr>
             <tr class="row-even">
              <td>
               <p>
                Busybox&rsquo; default shell
               </p>
              </td>
              <td>
               <p>
                /bin/sh
               </p>
              </td>
              <td>
              </td>
             </tr>
             <tr class="row-odd">
              <td>
               <p>
                Run a getty after boot
               </p>
              </td>
              <td>
               <p>
                tty PORT:
                <strong>
                 console
                </strong>
                . Baudrate: keep kernel default. TERM environment variable: vt100
               </p>
              </td>
              <td>
              </td>
             </tr>
             <tr class="row-even">
              <td>
               <p>
                remount root filesystem read write during boot
               </p>
              </td>
              <td>
               <p>
                Yes
               </p>
              </td>
              <td>
              </td>
             </tr>
             <tr class="row-odd">
              <td>
               <p>
                Network interface to configure through DHCP
               </p>
              </td>
              <td>
               <p>
                eth0
               </p>
              </td>
              <td>
              </td>
             </tr>
             <tr class="row-even">
              <td>
               <p>
                Set the system&rsquo;s default PATH
               </p>
              </td>
              <td>
               <p>
                /bin:/sbin:/usr/bin:/usr/sbin
               </p>
              </td>
              <td>
              </td>
             </tr>
             <tr class="row-odd">
              <td>
               <p>
                Purge unwanted locales
               </p>
              </td>
              <td>
               <p>
                yes
               </p>
              </td>
              <td>
              </td>
             </tr>
             <tr class="row-even">
              <td>
               <p>
                Leave the default values for all others
               </p>
              </td>
              <td>
              </td>
              <td>
              </td>
             </tr>
             <tr class="row-odd">
              <td>
               <p>
                Custom scripts to run path
                <strong>
                 before
                </strong>
                creatating filesystem images
               </p>
              </td>
              <td>
               <p>
                <strong>
                 your path
                </strong>
                /buildroot-2024.08.1/board/raspberrypi4-64/post-build.sh
               </p>
              </td>
              <td>
              </td>
             </tr>
             <tr class="row-even">
              <td>
               <p>
                Custom scripts to run inside the fakeroot environment
               </p>
              </td>
              <td>
              </td>
              <td>
              </td>
             </tr>
             <tr class="row-odd">
              <td>
               <p>
                Custom scripts to run
                <strong>
                 after
                </strong>
                creating filesystem images
               </p>
              </td>
              <td>
               <p>
                <strong>
                 your path
                </strong>
                /buildroot-2024.08.1/board/raspberrypi4-64/post-image.sh
               </p>
              </td>
              <td>
              </td>
             </tr>
            </tbody>
           </table>
          </section>
          <section id="linux-kernel">
           <h4>
            Linux Kernel
            <a class="headerlink" href="#linux-kernel" title="Link to this heading">
             
            </a>
           </h4>
           <p>
            This is the configuration of the Linux kernel. The specific location and version is specified among other parameters (
            <a class="reference internal" href="#kernel">
             <span class="std std-numref">
              Table 3.4
             </span>
            </a>
            ). See thrird column for details of git repor to use.
           </p>
           <table class="docutils align-default" id="kernel">
            <caption>
             <span class="caption-text">
              kernel-configuration
             </span>
             <a class="headerlink" href="#kernel" title="Link to this table">
              
             </a>
            </caption>
            <tbody>
             <tr class="row-odd">
              <td>
               <p>
                Kernel Version
               </p>
              </td>
              <td>
               <p>
                Custom tarball.
               </p>
              </td>
              <td>
               <p>
                $(call github,raspberrypi,linux,576cc10e1ed50a9eacffc7a05c796051d7343ea4)/linux-576cc10e1ed50a9eacffc7a05c796051d7343ea4.tar.gz
               </p>
              </td>
             </tr>
             <tr class="row-even">
              <td>
               <p>
                Kernel configuration
               </p>
              </td>
              <td>
               <p>
                Using and intree defconfig file
               </p>
              </td>
              <td>
              </td>
             </tr>
             <tr class="row-odd">
              <td>
               <p>
                Defconfigname
               </p>
              </td>
              <td>
               <p>
                bcm2711
               </p>
              </td>
              <td>
               <p>
                This file contains the specific configuration of the kernel for the RPI
               </p>
              </td>
             </tr>
             <tr class="row-even">
              <td>
               <p>
                Kernel binary format
               </p>
              </td>
              <td>
               <p>
                Image
               </p>
              </td>
              <td>
              </td>
             </tr>
             <tr class="row-odd">
              <td>
               <p>
                Kernel  compression format
               </p>
              </td>
              <td>
               <p>
                gzip compression
               </p>
              </td>
              <td>
              </td>
             </tr>
             <tr class="row-even">
              <td>
               <p>
                Build aDevice Tree Blob (DTB)
               </p>
              </td>
              <td>
               <p>
                Yes
               </p>
              </td>
              <td>
              </td>
             </tr>
             <tr class="row-odd">
              <td>
               <p>
                Intree Device Tree Source file name
               </p>
              </td>
              <td>
               <p>
                broadcom/bcm2711-rpi-4-b broadcom/bcm2711-rpi-400 broadcom/bcm2711-rpi-cm4 broadcom/bcm2711-rpi-cm4s
               </p>
              </td>
              <td>
              </td>
             </tr>
             <tr class="row-even">
              <td>
               <p>
                Need host OpenSSL
               </p>
              </td>
              <td>
               <p>
                Yes
               </p>
              </td>
              <td>
              </td>
             </tr>
             <tr class="row-odd">
              <td>
               <p>
                Linux kernel Extensions
               </p>
              </td>
              <td>
               <p>
                Nothing
               </p>
              </td>
              <td>
              </td>
             </tr>
             <tr class="row-even">
              <td>
               <p>
                Linux Kernel Tools
               </p>
              </td>
              <td>
               <p>
                Nothing
               </p>
              </td>
              <td>
              </td>
             </tr>
            </tbody>
           </table>
          </section>
          <section id="target-packages">
           <h4>
            Target Packages
            <a class="headerlink" href="#target-packages" title="Link to this heading">
             
            </a>
           </h4>
           <p>
            Target packages option allows to select the software elements that will be installed in the filesystem of the embedded Linux. Additionaly, this option install the busybox package that contains the basic Linux commands (
            <a class="reference internal" href="#busybox">
             <span class="std std-numref">
              Table 3.5
             </span>
            </a>
            ). Buildroot creates the filesystem hierarchy following the Linux standard organization.
           </p>
           <table class="docutils align-default" id="busybox">
            <caption>
             <span class="caption-text">
              Busybox and target packages
             </span>
             <a class="headerlink" href="#busybox" title="Link to this table">
              
             </a>
            </caption>
            <tbody>
             <tr class="row-odd">
              <td>
               <p>
                Busybox
               </p>
              </td>
              <td>
               <p>
                yes
               </p>
              </td>
              <td>
              </td>
             </tr>
             <tr class="row-even">
              <td>
               <p>
                Busybox configuration file to use
               </p>
              </td>
              <td>
               <p>
                package/busybox/busybox.config
               </p>
              </td>
              <td>
              </td>
             </tr>
             <tr class="row-odd">
              <td>
               <p>
                Show packages that are also provided by busybox
               </p>
              </td>
              <td>
               <p>
                Yes
               </p>
              </td>
              <td>
              </td>
             </tr>
             <tr class="row-even">
              <td>
               <p>
                Audio and video applications
               </p>
              </td>
              <td>
               <p>
                Default values
               </p>
              </td>
              <td>
              </td>
             </tr>
             <tr class="row-odd">
              <td>
               <p>
                Compresssors and decompressors
               </p>
              </td>
              <td>
               <p>
                xz-utils
               </p>
              </td>
              <td>
              </td>
             </tr>
             <tr class="row-even">
              <td>
               <p>
                Debugging, profiling and benchmark
               </p>
              </td>
              <td>
               <p>
                <strong>
                 gdb, gdbserver, full debugger
                </strong>
               </p>
              </td>
              <td>
              </td>
             </tr>
             <tr class="row-odd">
              <td>
               <p>
                Developments tools
               </p>
              </td>
              <td>
               <p>
                Default values
               </p>
              </td>
              <td>
              </td>
             </tr>
             <tr class="row-even">
              <td>
               <p>
                Filesystem  and flash utilities
               </p>
              </td>
              <td>
               <p>
                Default values
               </p>
              </td>
              <td>
              </td>
             </tr>
             <tr class="row-odd">
              <td>
               <p>
                Games
               </p>
              </td>
              <td>
               <p>
                Default values
               </p>
              </td>
              <td>
              </td>
             </tr>
             <tr class="row-even">
              <td>
               <p>
                Graphic libraries and applications (graphic/text)
               </p>
              </td>
              <td>
               <p>
                Default values
               </p>
              </td>
              <td>
              </td>
             </tr>
             <tr class="row-odd">
              <td>
               <p>
                Hardware handling
               </p>
              </td>
              <td>
               <p>
                <strong>
                 Firmware&gt;rpifirmware
                </strong>
                <strong>
                 rpi4 (default)
                </strong>
               </p>
              </td>
              <td>
               <p>
                Path to a file stores as boot/config.txt:
                <strong>
                 your path
                </strong>
                /board/raspberrypi4-64/config_4_64bit.txt
               </p>
              </td>
             </tr>
             <tr class="row-even">
              <td>
               <p>
                Hardware handling
               </p>
              </td>
              <td>
               <p>
                <strong>
                 Firmware&gt;rpifirmware
                </strong>
               </p>
              </td>
              <td>
               <p>
                Path to a file stored as boot/cmdline.txt:
                <strong>
                 your path
                </strong>
                /board/raspberrypi4-64/cmdline.txt
               </p>
              </td>
             </tr>
             <tr class="row-odd">
              <td>
               <p>
                Hardware handling
               </p>
              </td>
              <td>
               <p>
                <strong>
                 Firmware&gt;rpifirmware
                </strong>
               </p>
              </td>
              <td>
               <p>
                <strong>
                 install DTB  overlays
                </strong>
               </p>
              </td>
             </tr>
             <tr class="row-even">
              <td>
               <p>
                Interpreters language and  scripting Libraries
               </p>
              </td>
              <td>
               <p>
                Python3
               </p>
              </td>
              <td>
              </td>
             </tr>
             <tr class="row-odd">
              <td>
               <p>
                Miscellaneous
               </p>
              </td>
              <td>
               <p>
                Default Values
               </p>
              </td>
              <td>
              </td>
             </tr>
             <tr class="row-even">
              <td>
               <p>
                Libraries
               </p>
              </td>
              <td>
               <p>
                Default Values
               </p>
              </td>
              <td>
              </td>
             </tr>
             <tr class="row-odd">
              <td>
               <p>
                Networking applications
               </p>
              </td>
              <td>
               <p>
                <strong>
                 ifupdown scripts
                </strong>
                ,
                <strong>
                 openssh
                </strong>
               </p>
              </td>
              <td>
              </td>
             </tr>
             <tr class="row-even">
              <td>
               <p>
                Package Managers
               </p>
              </td>
              <td>
               <p>
                Default values
               </p>
              </td>
              <td>
              </td>
             </tr>
             <tr class="row-odd">
              <td>
               <p>
                Real Time, Shell and  utilities
               </p>
              </td>
              <td>
               <p>
                Default Values
               </p>
              </td>
              <td>
              </td>
             </tr>
             <tr class="row-even">
              <td>
               <p>
                System Tools
               </p>
              </td>
              <td>
               <p>
                kmod, kmod utilities
               </p>
              </td>
              <td>
              </td>
             </tr>
             <tr class="row-odd">
              <td>
               <p>
                Text Editor and Viewers
               </p>
              </td>
              <td>
               <p>
                Default Values
               </p>
              </td>
              <td>
              </td>
             </tr>
            </tbody>
           </table>
          </section>
          <section id="file-system-images">
           <h4>
            File System Images
            <a class="headerlink" href="#file-system-images" title="Link to this heading">
             
            </a>
           </h4>
           <p>
            This option selects the format of the root filesystem and the size (
            <a class="reference internal" href="#filesystemimage">
             <span class="std std-numref">
              Table 3.6
             </span>
            </a>
            ).
           </p>
           <table class="docutils align-default" id="filesystemimage">
            <caption>
             <span class="caption-text">
              Filesystem images
             </span>
             <a class="headerlink" href="#filesystemimage" title="Link to this table">
              
             </a>
            </caption>
            <tbody>
             <tr class="row-odd">
              <td>
               <p>
                ext2/3/4 root filesystem
               </p>
              </td>
              <td>
               <p>
                ext4
               </p>
              </td>
              <td>
              </td>
             </tr>
             <tr class="row-even">
              <td>
               <p>
                filesystem label
               </p>
              </td>
              <td>
               <p>
                rootfs
               </p>
              </td>
              <td>
              </td>
             </tr>
             <tr class="row-odd">
              <td>
               <p>
                exact size
               </p>
              </td>
              <td>
               <p>
                <strong>
                 400M
                </strong>
                Leave the other default values
               </p>
              </td>
              <td>
               <p>
                Update this value with your specific needs
               </p>
              </td>
             </tr>
             <tr class="row-even">
              <td>
               <p>
                Compression method
               </p>
              </td>
              <td>
               <p>
                No compression
               </p>
              </td>
              <td>
              </td>
             </tr>
            </tbody>
           </table>
          </section>
          <section id="boot-loaders">
           <h4>
            Boot-loaders
            <a class="headerlink" href="#boot-loaders" title="Link to this heading">
             
            </a>
           </h4>
           <p>
            The Raspberry PI does not need an specific bootloader becuase it is incorporated in the firmware provided by Broadcom.
           </p>
          </section>
          <section id="host-utilities">
           <h4>
            Host Utilities
            <a class="headerlink" href="#host-utilities" title="Link to this heading">
             
            </a>
           </h4>
           <p>
            Additional tools needed for ubuntu to create all the embedded images (
            <a class="reference internal" href="#hostutils">
             <span class="std std-numref">
              Table 3.7
             </span>
            </a>
            ).
           </p>
           <table class="docutils align-default" id="hostutils">
            <caption>
             <span class="caption-text">
              Host utilities
             </span>
             <a class="headerlink" href="#hostutils" title="Link to this table">
              
             </a>
            </caption>
            <tbody>
             <tr class="row-odd">
              <td>
               <p>
                host environment setup
               </p>
              </td>
              <td>
               <p>
                Yes
               </p>
              </td>
              <td>
              </td>
             </tr>
             <tr class="row-even">
              <td>
               <p>
                host genimage
               </p>
              </td>
              <td>
               <p>
                Yes
               </p>
              </td>
              <td>
              </td>
             </tr>
             <tr class="row-odd">
              <td>
               <p>
                host dosfstools
               </p>
              </td>
              <td>
               <p>
                Yes
               </p>
              </td>
              <td>
              </td>
             </tr>
             <tr class="row-even">
              <td>
               <p>
                host kmod
               </p>
              </td>
              <td>
               <p>
                Yes, support
                <strong>
                 xz-compressed modules
                </strong>
               </p>
              </td>
              <td>
              </td>
             </tr>
             <tr class="row-odd">
              <td>
               <p>
                host mtools
               </p>
              </td>
              <td>
               <p>
                Yes
               </p>
              </td>
              <td>
              </td>
             </tr>
            </tbody>
           </table>
           <p>
            Once you have configured all the menus, you need to exit, saving the
values (File-&gt;Quit).
           </p>
          </section>
         </section>
         <section id="compiling-buildroot">
          <h3>
           Compiling buildroot
           <a class="headerlink" href="#compiling-buildroot" title="Link to this heading">
            
           </a>
          </h3>
          <p>
           In the Terminal Window executes the following command (
           <a class="reference internal" href="#buildbuildroot">
            <span class="std std-numref">
             Listing 3.1
            </span>
           </a>
           ):
          </p>
          <div class="literal-block-wrapper docutils container" id="buildbuildroot">
           <div class="code-block-caption">
            <span class="caption-text">
             Build Buildroot
            </span>
            <a class="headerlink" href="#buildbuildroot" title="Link to this code">
             
            </a>
           </div>
           <div class="highlight-bash notranslate">
            <div class="highlight">
             <pre><span></span><span class="w"> </span>$<span class="w"> </span>make<span class="w"> </span><span class="nv">O</span><span class="o">=</span><span class="nv">$PWD</span><span class="w"> </span>-C<span class="w"> </span>/home/ubuntu/Documents/rpi/buildroot-2024.08.1/
</pre>
            </div>
           </div>
          </div>
          <p>
           If everything is correct, you will see a final window similar to the one
represented in
           <a class="reference internal" href="#buildrootok">
            <span class="std std-numref">
             Fig. 3.8
            </span>
           </a>
           .
          </p>
          <div class="admonition warning">
           <p class="admonition-title">
            Warning
           </p>
           <p>
            In this step, buildroot will connect, using the internet, to different repositories. After downloading the code, Buildroot will compile the applications and generate a lot of files and folders. Depending on your internet speed access and the   configuration chosen, this step could take up to
            <strong>
             one hour  and a half
            </strong>
            . If you have errors in the buildroot configuration,  you could obtain errors in this compilation phase. Check your configuration correctly. Use &ldquo;make O=$PWD -C /home/ubuntu/Documents/rpi/buildroot-2024.08.1/ clean&rdquo; to clean up  your partial compilation.
           </p>
          </div>
          <div class="admonition note">
           <p class="admonition-title">
            Note
           </p>
           <p>
            <cite>
             dl
            </cite>
            subfolder in your buildroot folder contains all  the packages downloaded for the internet. If you want to  move your buildroot configuration from one computer to another, avoiding the copy of the virtual machine, you can copy this folder.                                            |
           </p>
          </div>
          <div class="admonition warning">
           <p class="admonition-title">
            Warning
           </p>
           <p>
            If your building process fails different reasons could be the origin. consider to use the following actions. Make a copy of your
            <cite>
             .config
            </cite>
            file (hidden file in Linux) to save your configuration.
           </p>
           <table class="docutils align-default" id="id3">
            <caption>
             <span class="caption-text">
              actions
             </span>
             <a class="headerlink" href="#id3" title="Link to this table">
              
             </a>
            </caption>
            <tbody>
             <tr class="row-odd">
              <td>
               <p>
                make O=$PWD -C /home/ubuntu/Documents/rpi/buildroot-2024.08.1/ clean
               </p>
              </td>
              <td>
               <p>
                Build again buildroot
               </p>
              </td>
             </tr>
             <tr class="row-even">
              <td>
               <p>
                make O=$PWD -C /home/ubuntu/Documents/rpi/buildroot-2024.08.1/ distclean
               </p>
              </td>
              <td>
               <p>
                configure and build again buildroot
               </p>
              </td>
             </tr>
            </tbody>
           </table>
          </div>
          <figure class="align-center" id="buildrootok">
           <a class="reference internal image-reference" href="_images/buildrootok.png">
            <img alt="_images/buildrootok.png" src="_images/buildrootok.png" style="width: 6.68125in; height: 4.46389in;"/>
           </a>
           <figcaption>
            <p>
             <span class="caption-text">
              Successful compilation and installation of Buildroot
             </span>
             <a class="headerlink" href="#buildrootok" title="Link to this image">
              
             </a>
            </p>
           </figcaption>
          </figure>
          <p>
           <strong>
            Buildroot
           </strong>
           has generated some folders with different files and
subfolders containing the tools for generating your Embedded Linux
System. The next paragraph explains the main outputs obtained,
          </p>
         </section>
         <section id="buildroot-output">
          <h3>
           Buildroot Output.
           <a class="headerlink" href="#buildroot-output" title="Link to this heading">
            
           </a>
          </h3>
          <p>
           The main output files of the execution of the previous steps can be
located in the folder &ldquo;build/images&rdquo;.
           <a class="reference internal" href="#operations">
            <span class="std std-numref">
             Fig. 3.9
            </span>
           </a>
           summarizes the use of
           <strong>
            Buildroot
           </strong>
           . Buildroot generates a bootloader, a kernel image, and a
file system.
          </p>
          <figure class="align-center" id="operations">
           <a class="reference internal image-reference" href="_images/buildroot.png">
            <img alt="Buildroot tool basic operation" src="_images/buildroot.png" style="width: 5.98081in; height: 2.5in;"/>
           </a>
           <figcaption>
            <p>
             <span class="caption-text">
              Schematic representation of the Buildroot tool. Buildroot generates the root file system, the kernel image, the bootloader, and
the toolchain. Figure copied from &ldquo;Bootlin&rdquo; training materials
(
              <a class="reference external" href="http://bootlins.com/training/">
               http://bootlin.com/training/
              </a>
              )
             </span>
             <a class="headerlink" href="#operations" title="Link to this image">
              
             </a>
            </p>
           </figcaption>
          </figure>
          <p>
           In our specific case, the folder content is shown in
           <a class="reference internal" href="#outbuidlroot">
            <span class="std std-numref">
             Fig. 3.10
            </span>
           </a>
          </p>
          <figure class="align-center" id="outbuidlroot">
           <a class="reference internal image-reference" href="_images/buildimages.png">
            <img alt="_images/buildimages.png" src="_images/buildimages.png" style="width: 5.98081in; height: 4.0in;"/>
           </a>
           <figcaption>
            <p>
             <span class="caption-text">
              The images folder contains the binary files for our embedded system.
             </span>
             <a class="headerlink" href="#outbuidlroot" title="Link to this image">
              
             </a>
            </p>
           </figcaption>
          </figure>
          <p>
           Copy the
           <cite>
            sdcard.img
           </cite>
           file to your SDcard using this Linux command in the
Buildroot folder (
           <cite>
            sdb
           </cite>
           is typically the device assigned to the sdcard,
unless you have other removable devices connected to the system):
          </p>
          <div class="highlight-bash notranslate">
           <div class="highlight">
            <pre><span></span>$<span class="w"> </span>sudo<span class="w"> </span>dd<span class="w"> </span><span class="k">if</span><span class="o">=</span>./images/sdcard.img<span class="w"> </span><span class="nv">of</span><span class="o">=</span>/dev/sd&lt;x&gt;<span class="w"> </span><span class="nv">bs</span><span class="o">=</span>10M
</pre>
           </div>
          </div>
          <div class="admonition warning">
           <p class="admonition-title">
            Warning
           </p>
           <p>
            &lt;x&gt; is the identification used by Linux for your microSD card,
tipically &ldquo;b&rdquo; or &ldquo;c&rdquo;.
            <strong>
             Never
            </strong>
            use &ldquo;a&rdquo; because this is the operating system hardisk
           </p>
          </div>
          <p>
           Remember to format again the microSDcard if you need to repeat this process otherwise you will have errors when Linux in booting.
          </p>
          <div class="admonition seealso">
           <p class="admonition-title">
            See also
           </p>
           <p>
            Linux
            <cite>
             gparted
            </cite>
            is an excellent tool for partitioning and formatting the SD card.
           </p>
          </div>
         </section>
         <section id="booting-the-raspberry-pi">
          <h3>
           Booting the Raspberry Pi.
           <a class="headerlink" href="#booting-the-raspberry-pi" title="Link to this heading">
            
           </a>
          </h3>
          <p>
           <a class="reference internal" href="#rpi4b">
            <span class="std std-numref">
             Fig. 3.11
            </span>
           </a>
           displays a Raspberry Pi. The description of this card, its
functionalities, interfaces, and connectors are explained in the ref
[RD2]. The fundamental connection requires:
          </p>
          <ol class="loweralpha simple">
           <li>
            <p>
             To connect a USB to RS232 adapter (provided) to the raspberry-pi
expansion header (see
             <a class="reference internal" href="#conn">
              <span class="std std-numref">
               Fig. 3.12
              </span>
             </a>
             , and
             <a class="reference internal" href="#fdti">
              <span class="std std-numref">
               Fig. 3.13
              </span>
             </a>
             ). This adapter provides the
serial line interface as a console in the Linux host operating
system.
            </p>
           </li>
           <li>
            <p>
             To connect the power supply with the micro-USB connector provided (5
v).
            </p>
           </li>
           <li>
            <p>
             To connect the Ethernet cable to the RJ45 port if it is available
(at home, not the case of UPM&rsquo;s Lab).
            </p>
           </li>
          </ol>
          <figure class="align-center" id="rpi4b">
           <a class="reference internal image-reference" href="_images/rpi4b.png">
            <img alt="_images/rpi4b.png" src="_images/rpi4b.png" style="width: 7.0cm; height: 5.0cm;"/>
           </a>
           <figcaption>
            <p>
             <span class="caption-text">
              RaspBerry-Pi 4 Model B hardware with main elements identified
             </span>
             <a class="headerlink" href="#rpi4b" title="Link to this image">
              
             </a>
            </p>
           </figcaption>
          </figure>
          <figure class="align-center" id="conn">
           <a class="reference internal image-reference" href="_images/rpiconnector.png">
            <img alt="_images/rpiconnector.png" src="_images/rpiconnector.png" style="width: 3.0cm; height: 10.0cm;"/>
           </a>
           <figcaption>
            <p>
             <span class="caption-text">
              Raspberry-PI 4 header terminal identification.
             </span>
             <a class="headerlink" href="#conn" title="Link to this image">
              
             </a>
            </p>
           </figcaption>
          </figure>
          <figure class="align-center" id="fdti">
           <a class="reference internal image-reference" href="_images/fdticable.png">
            <img alt="_images/fdticable.png" src="_images/fdticable.png" style="width: 5cm; height: 10.0cm;"/>
           </a>
           <figcaption>
            <p>
             <span class="caption-text">
              Identification of the terminals in the USB-RS232 adapter
             </span>
             <a class="headerlink" href="#fdti" title="Link to this image">
              
             </a>
            </p>
           </figcaption>
          </figure>
          <table class="docutils align-center" id="id4">
           <caption>
            <span class="caption-text">
             FDTI Terminals
            </span>
            <a class="headerlink" href="#id4" title="Link to this table">
             
            </a>
           </caption>
           <colgroup>
            <col style="width: 50.0%"/>
            <col style="width: 50.0%"/>
           </colgroup>
           <thead>
            <tr class="row-odd">
             <th class="head">
              <p>
               RPI connector
              </p>
             </th>
             <th class="head">
              <p>
               FDTI Terminal
              </p>
             </th>
            </tr>
           </thead>
           <tbody>
            <tr class="row-even">
             <td>
              <p>
               RXD UART (GPIO16) Pin 10
              </p>
             </td>
             <td>
              <p>
               Terminal 4 (Orange)
              </p>
             </td>
            </tr>
            <tr class="row-odd">
             <td>
              <p>
               TXD UART (GPIO15) Pin 8
              </p>
             </td>
             <td>
              <p>
               Terminal 5 (Yellow)
              </p>
             </td>
            </tr>
            <tr class="row-even">
             <td>
              <p>
               Ground (GND) Pin 6
              </p>
             </td>
             <td>
              <p>
               Pin 1
              </p>
             </td>
            </tr>
           </tbody>
          </table>
          <p>
           The booting process of the Raspberry Pi BCM2711
           <a class="reference external" href="https://www.raspberrypi.com/documentation/computers/processors.html#bcm2711">
            BCM2711
           </a>
           processor is depicted
in
           <a class="reference internal" href="#rpiboot">
            <span class="std std-numref">
             Fig. 3.14
            </span>
           </a>
           . Take into account that this System On Chip (SoC), the
BCM2711, contains two different processors: a
           <a class="reference internal" href="#document-acronyms#term-GPU">
            <span class="xref std std-term">
             GPU
            </span>
           </a>
           and an ARM
CPU. The programs
           <em>
            bootcode.bin
           </em>
           and
           <em>
            start.elf
           </em>
           are written
explicitly for the GPU, and the source code is unavailable. Broadcom
only provides details of this to customers who sign a commercial
agreement. The last executable (
           <em>
            start.elf
           </em>
           ) boots the ARM processor and
allows the execution of ARM programs such as Linux OS kernel or other
binaries such as u-boot bootloader.
          </p>
          <figure class="align-center" id="rpiboot">
           <a class="reference internal image-reference" href="_images/bcm2711boting.png">
            <img alt="RPI booting process" src="_images/bcm2711boting.png" style="width: 4.90093in; height: 4.28723in;"/>
           </a>
           <figcaption>
            <p>
             <span class="caption-text">
              Booting process for BCM2711 processor in the raspberry-pi.
             </span>
             <a class="headerlink" href="#rpiboot" title="Link to this image">
              
             </a>
            </p>
           </figcaption>
          </figure>
          <p>
           The config.txt file contains essential information to boot the Linux OS
and perform the configuration of different hardware elements (look at
           <a class="reference external" href="http://elinux.org/RPiconfig">
            http://elinux.org/RPiconfig
           </a>
           and check the meaning of the different
configuration parameters). Verify the content of the config.txt file
generated by buildroot and complete it as depicted below (
           <a class="reference internal" href="#aa">
            <span class="std std-numref">
             Listing 3.2
            </span>
           </a>
           ).
          </p>
          <div class="literal-block-wrapper docutils container" id="aa">
           <div class="code-block-caption">
            <span class="caption-text">
             config.txt file
            </span>
            <a class="headerlink" href="#aa" title="Link to this code">
             
            </a>
           </div>
           <div class="highlight-bash notranslate">
            <div class="highlight">
             <pre><span></span><span class="c1"># Please note that this is only a sample, we recommend you to change it to fit</span>
<span class="c1"># your needs.# You should override this file using BR2_PACKAGE_RPI_FIRMWARE_CONFIG_FILE.</span>
<span class="c1"># See http://buildroot.org/manual.html#rootfs-custom</span>
<span class="c1"># and http://elinux.org/RPiconfig for a description of config.txt syntax</span>

<span class="nv">start_file</span><span class="o">=</span>start4.elf
<span class="nv">fixup_file</span><span class="o">=</span>fixup4.dat

<span class="nv">kernel</span><span class="o">=</span>**Image**

<span class="c1"># To use an external initramfs file</span>
<span class="c1">#initramfs rootfs.cpio.gz</span>
<span class="c1"># Disable overscan assuming the display supports displaying the full resolution</span>
<span class="c1"># If the text shown on the screen disappears off the edge, comment this out</span>

<span class="nv">disable_overscan</span><span class="o">=</span><span class="m">1</span>

<span class="c1"># How much memory in MB to assign to the GPU on Pi models having</span>
<span class="c1"># 256, 512 or 1024 MB total memory</span>
<span class="nv">gpu_mem_256</span><span class="o">=</span><span class="m">100</span>
<span class="nv">gpu_mem_512</span><span class="o">=</span><span class="m">100</span>
<span class="nv">gpu_mem_1024</span><span class="o">=</span><span class="m">100</span>

<span class="c1"># Enable UART0 for serial console on ttyAMA0</span>
<span class="nv">dtoverlay</span><span class="o">=</span>miniuart-bt

<span class="c1"># enable autoprobing of Bluetooth driver without need of hciattach/btattach</span>
<span class="nv">dtparam</span><span class="o">=</span><span class="nv">krnbt</span><span class="o">=</span>on
</pre>
            </div>
           </div>
          </div>
          <p>
           In this example, once the ARM is released from reset, it executes the
Image application. This binary application is the Linux Kernel in Image
format. The parameters passed to the application specified in the
           <cite>
            kernel=&lt;&hellip;.&gt;
           </cite>
           are detailed in the
           <cite>
            cmdline.txt
           </cite>
           file. For instance, by
default, Buildroot generates this one (
           <a class="reference internal" href="#cmdline">
            <span class="std std-numref">
             Listing 3.3
            </span>
           </a>
           ):
          </p>
          <div class="literal-block-wrapper docutils container" id="cmdline">
           <div class="code-block-caption">
            <span class="caption-text">
             cmdline.txt file
            </span>
            <a class="headerlink" href="#cmdline" title="Link to this code">
             
            </a>
           </div>
           <div class="highlight-bash notranslate">
            <div class="highlight">
             <pre><span></span><span class="nv">root</span><span class="o">=</span>/dev/mmcblk0p2<span class="w"> </span>rootwait<span class="w"> </span><span class="nv">console</span><span class="o">=</span>tty1<span class="w"> </span><span class="nv">console</span><span class="o">=</span>ttyAMA0,115200
</pre>
            </div>
           </div>
          </div>
          <p>
           In the Linux machine, open a Terminal and execute the program
           <cite>
            sudo putty
           </cite>
           with
           <strong>
            sudo rights
           </strong>
           (sudo putty), in a second a window appears. Configure the
parameters using the information displayed in
           <a class="reference internal" href="#putty">
            <span class="std std-numref">
             Fig. 3.15
            </span>
           </a>
           (for the specific
case of
           <cite>
            putty
           </cite>
           ), and then press &ldquo;Open&rdquo;.
           <strong>
            Apply the power to the
Raspberry PI,
           </strong>
           and you will see the booting messages.
          </p>
          <div class="admonition tip">
           <p class="admonition-title">
            Tip
           </p>
           <p>
            <strong>
             [Serial interface identification in Linux]:
            </strong>
            In Linux the  serial devices are identified typically with the names       /dev/ttyS0, /dev/ttyS1, etc. In the figure, the example has   been checked with a serial port implemented with a USB-RS232 converter. This is the reason why the name is
            <strong>
             /dev/ttyUSB0
            </strong>
            .   In your computer, you need to find the identification of   your serial port. Use Linux
            <strong>
             dmesg
            </strong>
            command to do this.
           </p>
          </div>
          <figure class="align-center" id="putty">
           <a class="reference internal image-reference" href="_images/image19.png">
            <img alt="Putty serial line" src="_images/image19.png" style="width: 4.90093in; height: 4.28723in;"/>
           </a>
           <figcaption>
            <p>
             <span class="caption-text">
              Putty program main window.
             </span>
             <a class="headerlink" href="#putty" title="Link to this image">
              
             </a>
            </p>
           </figcaption>
          </figure>
          <p>
           After a few seconds, you will see a lot of messages displayed on the
terminal. Linux kernel is booting, and the operating system is running
its configuration and initial daemons. If the system boots correctly,
you will see an output like the one represented in
           <a class="reference internal" href="#linuxboot">
            <span class="std std-numref">
             Fig. 3.16
            </span>
           </a>
           . Introduce
the username
           <em>
            root
           </em>
           (password in case you have configured it), and the Linux shell will be available for you.
          </p>
          <figure class="align-center" id="linuxboot">
           <a class="reference internal image-reference" href="_images/image20.png">
            <img alt="_images/image20.png" src="_images/image20.png" style="width: 6.69514in; height: 2.58472in;"/>
           </a>
           <figcaption>
            <p>
             <span class="caption-text">
              Linux Running in the RaspBerry Pi
             </span>
             <a class="headerlink" href="#linuxboot" title="Link to this image">
              
             </a>
            </p>
           </figcaption>
          </figure>
          <div class="admonition tip">
           <p class="admonition-title">
            Tip
           </p>
           <p>
            <strong>
             [DHCP Server]:
            </strong>
            The DHCP server providing the IP address  to the RPI should be active in your network. In the UPM ETSIST labs, there is no cabled network, only WIFI. If you are using the RPI at home, the DHCP server is running in your router. The method used to assing IP addresses is different from one manufactures to others. If you want to know the IP address assigned, you have two options: use a serial cable connected to the RPI (
            <cite>
             ifconfig
            </cite>
            command) or check the router status web page and display the table of the DHCP clients connected. Looking for the MAC in the list, you will obtain the IP address.
           </p>
          </div>
         </section>
         <section id="connecting-the-rpi-to-the-cabled-ethernet-network">
          <h3>
           Connecting the RPI to the cabled ethernet network
           <a class="headerlink" href="#connecting-the-rpi-to-the-cabled-ethernet-network" title="Link to this heading">
            
           </a>
          </h3>
          <section id="inspecting-the-configuration-of-the-network-interface-generated-automatically-by-buildroot">
           <h4>
            Inspecting the configuration of the network interface generated automatically by Buildroot
            <a class="headerlink" href="#inspecting-the-configuration-of-the-network-interface-generated-automatically-by-buildroot" title="Link to this heading">
             
            </a>
           </h4>
           <p>
            Inspect the content of
            <cite>
             /etc/network/interfaces
            </cite>
            and
            <cite>
             /etc/init.d/S40network
            </cite>
            . You will see content similar to this in the
            <cite>
             interfaces
            </cite>
            file:
           </p>
           <div class="highlight-bash notranslate">
            <div class="highlight">
             <pre><span></span><span class="c1"># interface file auto-generated by buildroot</span>

auto<span class="w"> </span>lo
iface<span class="w"> </span>lo<span class="w"> </span>inet<span class="w"> </span>loopback

auto<span class="w"> </span>eth0
iface<span class="w"> </span>eth0<span class="w"> </span>inet<span class="w"> </span>dhcp
<span class="w">     </span>pre-up<span class="w"> </span>/etc/network/nfs_check
<span class="w">     </span>wait-delay<span class="w"> </span><span class="m">15</span>
<span class="w">     </span>hostname<span class="w"> </span><span class="k">$(</span>hostname<span class="k">)</span>
</pre>
            </div>
           </div>
           <p>
            This configuration activates the use of eth0 with DHCP support. Test the
connectivity, trying to connect to another computer in the laboratory.
Use the ping command.
           </p>
           <div class="admonition note">
            <p class="admonition-title">
             Note
            </p>
            <p>
             <strong>
              [Help]:
             </strong>
             If you run the ping command in the Raspberry   trying to connect with a computer in the laboratory, you      probably obtain a connection timeout. Consider that   computers running Windows could have the firewall activated. You can also try to run the ping on a windows computer or on Linux virtual machine. In this case, the RPI does not have a  firewall running, and the connection should be successful.
            </p>
           </div>
           <div class="admonition-question admonition">
            <p class="admonition-title">
             Question
            </p>
            <p>
             What is the MAC address of your RPI interface? Use the
             <cite>
              dmesg
             </cite>
             command to see the kernel boot parameters and identify the method used to get the MAC address from the hardware.
            </p>
           </div>
          </section>
         </section>
         <section id="adding-wifi-support">
          <h3>
           Adding WIFI support
           <a class="headerlink" href="#adding-wifi-support" title="Link to this heading">
            
           </a>
          </h3>
          <section id="adding-mdev-support-to-embedded-linux">
           <h4>
            Adding mdev support to Embedded Linux
            <a class="headerlink" href="#adding-mdev-support-to-embedded-linux" title="Link to this heading">
             
            </a>
           </h4>
           <p>
            The folder &lt;buildroot-folder&gt;
            <em>
             /package/busybox
            </em>
            contains two files
named S10mdev and mdev.conf. These files have to be added to the target
filesystem. This step is done by adding these commands to the
            <em>
             &lt;buildroot-folder&gt;/board/raspberrypi4-64/post-build.sh
            </em>
            script:
           </p>
           <div class="highlight-bash notranslate">
            <div class="highlight">
             <pre><span></span>cp<span class="w"> </span>&lt;buildroot-folder&gt;/package/busybox/S10mdev<span class="w"> </span><span class="si">${</span><span class="nv">TARGET_DIR</span><span class="si">}</span>/etc/init.d/S10mdev
chmod<span class="w"> </span><span class="m">755</span><span class="w"> </span><span class="si">${</span><span class="nv">TARGET_DIR</span><span class="si">}</span>/etc/init.d/S10mdev
cp<span class="w"> </span>&lt;buildroot-folder&gt;/package/busybox/mdev.conf<span class="w"> </span><span class="si">${</span><span class="nv">TARGET_DIR</span><span class="si">}</span>/etc/mdev.conf
</pre>
            </div>
           </div>
           <div class="admonition note">
            <p class="admonition-title">
             Note
            </p>
            <p>
             [mdev] mdev provides a method to add or remove hotplug devices in Linux.
            </p>
           </div>
          </section>
          <section id="adding-the-broadcom-firmware-support-for-wireless-hardware">
           <h4>
            Adding the Broadcom firmware support for Wireless hardware
            <a class="headerlink" href="#adding-the-broadcom-firmware-support-for-wireless-hardware" title="Link to this heading">
             
            </a>
           </h4>
           <p>
            The hardware element included in the RPI-4 for the Wireless
communication is implemented with the BCM43438 chip. It is needed to
include the software packages with the firmware&rsquo;s chip and the wireless
utilities.
           </p>
           <ol class="arabic simple">
            <li>
             <p>
              Execute &ldquo;make &hellip;&hellip;. menuconfig&rdquo;. Navigate to &ldquo;Target Packages-&gt;Hardware
Handling-&gt;Firmware-&gt; bcrmfmac-sdio-firmware-rpi&rdquo; and select the
&ldquo;bcrmfmac-sdio-firmware-rpi-wifi&rdquo;.
             </p>
            </li>
            <li>
             <p>
              Before compiling Buildroot we need to add more software supporting
the configuration of the WIFI.
             </p>
             <ol class="loweralpha simple">
              <li>
               <p>
                Navigate to &ldquo;Target Packages-&gt;Networking Applications&rdquo; and select
               </p>
               <ul class="simple">
                <li>
                 <p>
                  &ldquo;crda&rdquo;
                 </p>
                </li>
                <li>
                 <p>
                  &ldquo;ifupdown scripts&rdquo;
                 </p>
                </li>
                <li>
                 <p>
                  &ldquo;iw&rdquo;
                 </p>
                </li>
                <li>
                 <p>
                  &ldquo;wireless-regdb&rdquo;
                 </p>
                </li>
                <li>
                 <p>
                  &ldquo;wireless tools&rdquo;
                 </p>
                </li>
                <li>
                 <p>
                  &ldquo;wpa_supplicant&rdquo;
                 </p>
                 <ol class="arabic simple">
                  <li>
                   <p>
                    &ldquo;Enable EAP&rdquo;
                   </p>
                  </li>
                  <li>
                   <p>
                    &ldquo;Enable WPS&rdquo;
                   </p>
                  </li>
                  <li>
                   <p>
                    &ldquo;Install wpa_cli binary&rdquo;
                   </p>
                  </li>
                  <li>
                   <p>
                    &ldquo;Install wpa_client shared library&rdquo;
                   </p>
                  </li>
                  <li>
                   <p>
                    &ldquo;Instal wpa_passphrase binary&rdquo;
                   </p>
                  </li>
                 </ol>
                </li>
               </ul>
              </li>
              <li>
               <p>
                Add these lines to ./board/rapsberrypi4-64/post-build.sh.
               </p>
              </li>
             </ol>
            </li>
           </ol>
           <div class="highlight-bash notranslate">
            <div class="highlight">
             <pre><span></span>cp<span class="w"> </span>&lt;buildroot-folder&gt;/board/raspberrypi4-64/interfaces<span class="w"> </span><span class="si">${</span><span class="nv">TARGET_DIR</span><span class="si">}</span>/etc/network/interfaces
cp<span class="w"> </span>&lt;buildroot-folder&gt;/board/raspberrypi4-64/wpa_supplicant.conf<span class="w"> </span><span class="si">${</span><span class="nv">TARGET_DIR</span><span class="si">}</span>/etc/wpa_supplicant.conf
</pre>
            </div>
           </div>
           <ol class="loweralpha simple" start="3">
            <li>
             <p>
              Create the file
              <cite>
               *&lt;buildroot-folder&gt;*/board/raspberrypi4-64/interfaces
              </cite>
              with the highlighted content:
             </p>
            </li>
           </ol>
           <div class="highlight-bash notranslate">
            <div class="highlight">
             <pre><span></span>auto<span class="w"> </span>lo
iface<span class="w"> </span>lo<span class="w"> </span>inet<span class="w"> </span>loopback

auto<span class="w"> </span>eth0
iface<span class="w"> </span>eth0<span class="w"> </span>inet<span class="w"> </span>dhcp
<span class="w">     </span>pre-up<span class="w"> </span>/etc/network/nfs_check
<span class="w">     </span>wait-delay<span class="w"> </span><span class="m">15</span>
<span class="w">     </span>hostname<span class="w"> </span><span class="k">$(</span>hostname<span class="k">)</span>

<span class="hll">auto<span class="w"> </span>wlan0
</span><span class="hll">iface<span class="w"> </span>wlan0<span class="w"> </span>inet<span class="w"> </span>dhcp
</span><span class="hll"><span class="w">       </span>pre-up<span class="w"> </span>wpa_supplicant<span class="w"> </span>-B<span class="w"> </span>-iwlan0<span class="w"> </span>-c/etc/wpa_supplicant.conf
</span><span class="hll"><span class="w">       </span>post-down<span class="w"> </span>killall<span class="w"> </span>-q<span class="w"> </span>wpa_supplicant
</span><span class="hll"><span class="w">       </span>wait-delay<span class="w"> </span><span class="m">15</span>
</span></pre>
            </div>
           </div>
           <ol class="loweralpha simple" start="4">
            <li>
             <p>
              Create the file
              <cite>
               *&lt;buildroot-folder&gt;*/board/raspberrypi4-64/wpa_supplicant.conf
              </cite>
              with this
content (ask professors about the values to be provided as SSID and
Key-passwd). You can define as many WIFIs as you want.
             </p>
            </li>
           </ol>
           <div class="highlight-bash notranslate">
            <div class="highlight">
             <pre><span></span><span class="nv">network</span><span class="o">={</span>
<span class="w">    </span><span class="nv">ssid</span><span class="o">=</span><span class="s2">"SSID"</span>
<span class="w">    </span><span class="nv">key_mgmt</span><span class="o">=</span>WPA-PSK
<span class="w">    </span><span class="nv">psk</span><span class="o">=</span><span class="s2">"PASSWORD"</span>
<span class="w">    </span><span class="nv">priority</span><span class="o">=</span><span class="m">9</span>
<span class="o">}</span>
</pre>
            </div>
           </div>
           <ol class="arabic simple" start="3">
            <li>
             <p>
              Perform a
              <cite>
               *make*
              </cite>
              and burn again the new image in the micro SDcard. Boot the
Raspberry and check that you can connect to the wireless network.
             </p>
            </li>
           </ol>
          </section>
         </section>
         <section id="customizing-the-linux-kernel">
          <h3>
           Customizing the Linux kernel
           <a class="headerlink" href="#customizing-the-linux-kernel" title="Link to this heading">
            
           </a>
          </h3>
          <section id="kernel-configuration">
           <h4>
            Kernel configuration
            <a class="headerlink" href="#kernel-configuration" title="Link to this heading">
             
            </a>
           </h4>
           <p>
            Execute the following command to configure the Linux Kernel in Buildroot
           </p>
           <div class="highlight-bash notranslate">
            <div class="highlight">
             <pre><span></span>$<span class="w"> </span>make<span class="w">  </span><span class="nv">O</span><span class="o">=</span><span class="nv">$PWD</span><span class="w"> </span>-C<span class="w"> </span>/home/ubuntu/Documents/rpi/buildroot-2024.08.1/<span class="w"> </span>linux-menuconfig
</pre>
            </div>
           </div>
           <p>
            Using the different menus you can configure specific kernel features, add support for specific device drivers and multiple additional functionalities. The compilation of the Linux kernel package is done with this command:
           </p>
           <div class="highlight-bash notranslate">
            <div class="highlight">
             <pre><span></span>$<span class="w"> </span>make<span class="w">  </span><span class="nv">O</span><span class="o">=</span><span class="nv">$PWD</span><span class="w"> </span>-C<span class="w"> </span>/home/ubuntu/Documents/rpi/buildroot-2024.08.1/<span class="w"> </span>linux-rebuild
</pre>
            </div>
           </div>
           <p>
            In order to get the new sdcard.img file execute:
           </p>
           <blockquote>
            <div>
             <div class="highlight-bash notranslate">
              <div class="highlight">
               <pre><span></span>$<span class="w"> </span>make<span class="w">  </span><span class="nv">O</span><span class="o">=</span><span class="nv">$PWD</span><span class="w"> </span>-C<span class="w"> </span>/home/ubuntu/Documents/rpi/buildroot-2024.08.1/
</pre>
              </div>
             </div>
            </div>
           </blockquote>
          </section>
         </section>
        </section>
        <span id="document-eclipse">
        </span>
        <section id="using-the-integrated-development-environment-eclipse-cdt">
         <h2>
          Using the integrated development environment Eclipse/CDT
          <a class="headerlink" href="#using-the-integrated-development-environment-eclipse-cdt" title="Link to this heading">
           
          </a>
         </h2>
         <section id="eclipse-ide-for-c-c-developers">
          <h3>
           Eclipse IDE for C/C++ developers
           <a class="headerlink" href="#eclipse-ide-for-c-c-developers" title="Link to this heading">
            
           </a>
          </h3>
          <p>
           The Eclipse IDE CDT is installed in the virtual machine. You can execute
it running eclipse in a window terminal.
          </p>
         </section>
         <section id="cross-compiling-applications-using-eclipse">
          <h3>
           Cross-Compiling applications using Eclipse
           <a class="headerlink" href="#cross-compiling-applications-using-eclipse" title="Link to this heading">
            
           </a>
          </h3>
          <p>
           How will a program be compiled and linked? Remember that we are developing cross
applications. We are developing and compiling the code in a Linux x86_64
architecture, and we are executing it on an ARM one (see
           <a class="reference internal" href="#crosstoolschain">
            <span class="std std-numref">
             Fig. 4.1
            </span>
           </a>
           ).
          </p>
          <figure class="align-center" id="crosstoolschain">
           <a class="reference internal image-reference" href="_images/cross-toolchain.jpg">
            <img alt="_images/cross-toolchain.jpg" src="_images/cross-toolchain.jpg" style="width: 5.90168in; height: 3.83333in;"/>
           </a>
           <figcaption>
            <p>
             <span class="caption-text">
              Cross Toolchain. Figure copied from &ldquo;Free Electrons&rdquo; training materials (
              <a class="reference external" href="http://free-electrons.com/training/">
               http://free-electrons.com/training/
              </a>
              )
             </span>
             <a class="headerlink" href="#crosstoolschain" title="Link to this image">
              
             </a>
            </p>
           </figcaption>
          </figure>
          <p>
           The first question is where the cross-compiler and other cross-tools are
located. The answer is this: in the folder
           <cite>
            build/host/usr/bin
           </cite>
           . If you
inspect this folder&rsquo;s content, you can see the entire compiling,
linking, and debugging tools (see
           <a class="reference internal" href="#crosstools">
            <span class="std std-numref">
             Fig. 4.2
            </span>
           </a>
           ). These programs are executed
in your x86_64 computer, but they generate code for the ARM processor.
          </p>
          <figure class="align-center" id="crosstools">
           <a class="reference internal image-reference" href="_images/crosstools.png">
            <img alt="_images/crosstools.png" src="_images/crosstools.png" style="width: 5.90168in; height: 3.83333in;"/>
           </a>
           <figcaption>
            <p>
             <span class="caption-text">
              Cross-compiling tools installed in the host computer
             </span>
             <a class="headerlink" href="#crosstools" title="Link to this image">
              
             </a>
            </p>
           </figcaption>
          </figure>
          <p>
           In a Terminal window execute the following commands:
          </p>
          <div class="highlight-bash notranslate">
           <div class="highlight">
            <pre><span></span><span class="c1"># change the directory to the folder where `build` directory is</span>
$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>./build/host
$<span class="w"> </span><span class="nb">source</span><span class="w"> </span>environment-setup
<span class="c1"># run eclipse in the same terminal. In this case eclipse is available in your ubuntu user folder</span>
$<span class="w"> </span>/home/ubuntu/eclipse/cpp-2024-09/eclipse/eclipse<span class="w"> </span><span class="p">&amp;</span>
</pre>
           </div>
          </div>
          <p>
           The
           <strong>
            environment-setup
           </strong>
           file contains the code listed below.
          </p>
          <div class="highlight-bash notranslate">
           <div class="highlight">
            <pre><span></span>cat<span class="w"> </span><span class="s">&lt;&lt;'EOF'</span>
<span class="s"> _           _ _     _                 _</span>
<span class="s">| |__  _   _(_) | __| |_ __ ___   ___ | |_</span>
<span class="s">| '_ \| | | | | |/ _` | '__/ _ \ / _ \| __|</span>
<span class="s">| |_) | |_| | | | (_| | | | (_) | (_) | |_</span>
<span class="s">|_.__/ \__,_|_|_|\__,_|_|  \___/ \___/ \__|</span>

<span class="s">       Making embedded Linux easy!</span>

<span class="s">Some tips:</span>
<span class="s">* PATH now contains the SDK utilities</span>
<span class="s">* Standard autotools variables (CC, LD, CFLAGS) are exported</span>
<span class="s">* Kernel compilation variables (ARCH, CROSS_COMPILE, KERNELDIR) are exported</span>
<span class="s">* To configure do "./configure $CONFIGURE_FLAGS" or use</span>
<span class="s">  the "configure" alias</span>
<span class="s">* To build CMake-based projects, use the "cmake" alias</span>

<span class="s">EOF</span>
<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>x<span class="s2">"</span><span class="nv">$BASH_VERSION</span><span class="s2">"</span><span class="w"> </span>!<span class="o">=</span><span class="w"> </span>x<span class="s2">""</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">     </span><span class="nv">SDK_PATH</span><span class="o">=</span><span class="k">$(</span>dirname<span class="w"> </span><span class="k">$(</span>realpath<span class="w"> </span><span class="s2">"</span><span class="si">${</span><span class="nv">BASH_SOURCE</span><span class="p">[0]</span><span class="si">}</span><span class="s2">"</span><span class="k">))</span>
<span class="k">elif</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>x<span class="s2">"</span><span class="nv">$ZSH_VERSION</span><span class="s2">"</span><span class="w"> </span>!<span class="o">=</span><span class="w"> </span>x<span class="s2">""</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">     </span><span class="nv">SDK_PATH</span><span class="o">=</span><span class="k">$(</span>dirname<span class="w"> </span><span class="k">$(</span>realpath<span class="w"> </span><span class="nv">$0</span><span class="k">))</span>
<span class="k">else</span>
<span class="w">     </span><span class="nb">echo</span><span class="w"> </span><span class="s2">"unsupported shell"</span>
<span class="k">fi</span>
<span class="nb">export</span><span class="w"> </span><span class="s2">"AR=aarch64-buildroot-linux-gnu-gcc-ar"</span>
<span class="nb">export</span><span class="w"> </span><span class="s2">"AS=aarch64-buildroot-linux-gnu-as"</span>
<span class="nb">export</span><span class="w"> </span><span class="s2">"LD=aarch64-buildroot-linux-gnu-ld"</span>
<span class="nb">export</span><span class="w"> </span><span class="s2">"NM=aarch64-buildroot-linux-gnu-gcc-nm"</span>
<span class="nb">export</span><span class="w"> </span><span class="s2">"CC=aarch64-buildroot-linux-gnu-gcc"</span>
<span class="nb">export</span><span class="w"> </span><span class="s2">"GCC=aarch64-buildroot-linux-gnu-gcc"</span>
<span class="nb">export</span><span class="w"> </span><span class="s2">"CPP=aarch64-buildroot-linux-gnu-cpp"</span>
<span class="nb">export</span><span class="w"> </span><span class="s2">"CXX=aarch64-buildroot-linux-gnu-g++"</span>
<span class="nb">export</span><span class="w"> </span><span class="s2">"FC=aarch64-buildroot-linux-gnu-gfortran"</span>
<span class="nb">export</span><span class="w"> </span><span class="s2">"F77=aarch64-buildroot-linux-gnu-gfortran"</span>
<span class="nb">export</span><span class="w"> </span><span class="s2">"RANLIB=aarch64-buildroot-linux-gnu-gcc-ranlib"</span>
<span class="nb">export</span><span class="w"> </span><span class="s2">"READELF=aarch64-buildroot-linux-gnu-readelf"</span>
<span class="nb">export</span><span class="w"> </span><span class="s2">"STRIP=aarch64-buildroot-linux-gnu-strip"</span>
<span class="nb">export</span><span class="w"> </span><span class="s2">"OBJCOPY=aarch64-buildroot-linux-gnu-objcopy"</span>
<span class="nb">export</span><span class="w"> </span><span class="s2">"OBJDUMP=aarch64-buildroot-linux-gnu-objdump"</span>
<span class="nb">export</span><span class="w"> </span><span class="s2">"AR_FOR_BUILD=/usr/bin/ar"</span>
<span class="nb">export</span><span class="w"> </span><span class="s2">"AS_FOR_BUILD=/usr/bin/as"</span>
<span class="nb">export</span><span class="w"> </span><span class="s2">"CC_FOR_BUILD=/usr/bin/gcc"</span>
<span class="nb">export</span><span class="w"> </span><span class="s2">"GCC_FOR_BUILD=/usr/bin/gcc"</span>
<span class="nb">export</span><span class="w"> </span><span class="s2">"CXX_FOR_BUILD=/usr/bin/g++"</span>
<span class="nb">export</span><span class="w"> </span><span class="s2">"LD_FOR_BUILD=/usr/bin/ld"</span>
<span class="nb">export</span><span class="w"> </span><span class="s2">"CPPFLAGS_FOR_BUILD=-I</span><span class="nv">$SDK_PATH</span><span class="s2">/include"</span>
<span class="nb">export</span><span class="w"> </span><span class="s2">"CFLAGS_FOR_BUILD=-O2 -I</span><span class="nv">$SDK_PATH</span><span class="s2">/include"</span>
<span class="nb">export</span><span class="w"> </span><span class="s2">"CXXFLAGS_FOR_BUILD=-O2 -I</span><span class="nv">$SDK_PATH</span><span class="s2">/include"</span>
<span class="nb">export</span><span class="w"> </span><span class="s2">"LDFLAGS_FOR_BUILD=-L</span><span class="nv">$SDK_PATH</span><span class="s2">/lib -Wl,-rpath,</span><span class="nv">$SDK_PATH</span><span class="s2">/lib"</span>
<span class="nb">export</span><span class="w"> </span><span class="s2">"FCFLAGS_FOR_BUILD="</span>
<span class="nb">export</span><span class="w"> </span><span class="s2">"DEFAULT_ASSEMBLER=aarch64-buildroot-linux-gnu-as"</span>
<span class="nb">export</span><span class="w"> </span><span class="s2">"DEFAULT_LINKER=aarch64-buildroot-linux-gnu-ld"</span>
<span class="nb">export</span><span class="w"> </span><span class="s2">"CPPFLAGS=-D_LARGEFILE_SOURCE -D_LARGEFILE64_SOURCE -D_FILE_OFFSET_BITS=64"</span>
<span class="nb">export</span><span class="w"> </span><span class="s2">"CFLAGS=-D_LARGEFILE_SOURCE -D_LARGEFILE64_SOURCE -D_FILE_OFFSET_BITS=64  -Os -g0 -D_FORTIFY_SOURCE=1"</span>
<span class="nb">export</span><span class="w"> </span><span class="s2">"CXXFLAGS=-D_LARGEFILE_SOURCE -D_LARGEFILE64_SOURCE -D_FILE_OFFSET_BITS=64  -Os -g0 -D_FORTIFY_SOURCE=1"</span>
<span class="nb">export</span><span class="w"> </span><span class="s2">"LDFLAGS="</span>
<span class="nb">export</span><span class="w"> </span><span class="s2">"FCFLAGS= -Os -g0"</span>
<span class="nb">export</span><span class="w"> </span><span class="s2">"FFLAGS= -Os -g0"</span>
<span class="nb">export</span><span class="w"> </span><span class="s2">"PKG_CONFIG=pkg-config"</span>
<span class="nb">export</span><span class="w"> </span><span class="s2">"STAGING_DIR=</span><span class="nv">$SDK_PATH</span><span class="s2">/aarch64-buildroot-linux-gnu/sysroot"</span>
<span class="nb">export</span><span class="w"> </span><span class="s2">"INTLTOOL_PERL=/usr/bin/perl"</span>
<span class="nb">export</span><span class="w"> </span><span class="s2">"ARCH=arm64"</span>
<span class="nb">export</span><span class="w"> </span><span class="s2">"CROSS_COMPILE=aarch64-buildroot-linux-gnu-"</span>
<span class="nb">export</span><span class="w"> </span><span class="s2">"CONFIGURE_FLAGS=--target=aarch64-buildroot-linux-gnu --host=aarch64-buildroot-linux-gnu --build=x86_64-pc-linux-gnu --prefix=/usr --exec-prefix=/usr --sysconfdir=/etc --localstatedir=/var --program-prefix="</span>
<span class="nb">alias</span><span class="w"> </span><span class="nv">configure</span><span class="o">=</span><span class="s2">"./configure </span><span class="si">${</span><span class="nv">CONFIGURE_FLAGS</span><span class="si">}</span><span class="s2">"</span>
<span class="nb">alias</span><span class="w"> </span><span class="nv">cmake</span><span class="o">=</span><span class="s2">"cmake -DCMAKE_TOOLCHAIN_FILE=</span><span class="nv">$SDK_PATH</span><span class="s2">/share/buildroot/toolchainfile.cmake -DCMAKE_INSTALL_PREFIX=/usr"</span>
<span class="nb">export</span><span class="w"> </span><span class="s2">"PATH=</span><span class="nv">$SDK_PATH</span><span class="s2">/bin:</span><span class="nv">$SDK_PATH</span><span class="s2">/sbin:</span><span class="nv">$PATH</span><span class="s2">"</span>
<span class="nb">export</span><span class="w"> </span><span class="s2">"KERNELDIR=/home/ubuntu/Documents/rpi/build/build/linux-custom/"</span>
</pre>
           </div>
          </div>
          <p>
           This script when is sourced in a terminal window sets all the environment
variables needed to use the cross-compilation tools and adds the folder
of cross-tools to the Linux
           <cite>
            PATH
           </cite>
           variable.
          </p>
          <p>
           The execution of eclipse popups a window inviting you to enter the
workspace (see
           <a class="reference internal" href="#eclipsews">
            <span class="std std-numref">
             Fig. 4.3
            </span>
           </a>
           ). The workspace is the folder that contain
eclipse projects created by the user. You can have as many workspaces as
you want. Please specify a folder in your account.
          </p>
          <div class="admonition tip">
           <p class="admonition-title">
            Tip
           </p>
           <p>
            The figures displayed in the following  paragraphs can be different depending on the Eclipse version  installed
           </p>
          </div>
          <figure class="align-center" id="eclipsews">
           <a class="reference internal image-reference" href="_images/eclipsews.png">
            <img alt="_images/eclipsews.png" src="_images/eclipsews.png" style="width: 5.19182in; height: 2.66458in;"/>
           </a>
           <figcaption>
            <p>
             <span class="caption-text">
              Selection of the workspace for Eclipse. Use a folder in your account.
             </span>
             <a class="headerlink" href="#eclipsews" title="Link to this image">
              
             </a>
            </p>
           </figcaption>
          </figure>
          <p>
           Select Ok, and the welcome window of Eclipse will be shown ( see
           <a class="reference internal" href="#welcome">
            <span class="std std-numref">
             Fig. 4.4
            </span>
           </a>
           ).Next, close the welcome window and the main eclipse window will be displayed ( see
           <a class="reference internal" href="#main">
            <span class="std std-numref">
             Fig. 4.5
            </span>
           </a>
           ).
          </p>
          <figure class="align-center" id="welcome">
           <a class="reference internal image-reference" href="_images/eclipsewelcome.png">
            <img alt="_images/eclipsewelcome.png" src="_images/eclipsewelcome.png" style="width: 5.17708in; height: 4.13683in;"/>
           </a>
           <figcaption>
            <p>
             <span class="caption-text">
              Eclipse welcome window.
             </span>
             <a class="headerlink" href="#welcome" title="Link to this image">
              
             </a>
            </p>
           </figcaption>
          </figure>
          <figure class="align-center" id="main">
           <a class="reference internal image-reference" href="_images/eclipsemainw.png">
            <img alt="_images/eclipsemainw.png" src="_images/eclipsemainw.png" style="width: 5.78753in; height: 4.35417in;"/>
           </a>
           <figcaption>
            <p>
             <span class="caption-text">
              Eclipse main window.
             </span>
             <a class="headerlink" href="#main" title="Link to this image">
              
             </a>
            </p>
           </figcaption>
          </figure>
          <p>
           In a terminal window create an empty folder. In this folder create the
following files with the content described in
           <a class="reference internal" href="#makefile">
            <span class="std std-numref">
             Listing 4.1
            </span>
           </a>
           ,
           <a class="reference internal" href="#maincpp">
            <span class="std std-numref">
             Listing 4.2
            </span>
           </a>
           ,
           <a class="reference internal" href="#funch">
            <span class="std std-numref">
             Listing 4.3
            </span>
           </a>
           , and
           <a class="reference internal" href="#funccpp">
            <span class="std std-numref">
             Listing 4.4
            </span>
           </a>
           . The Makefile
uses the environment variables that are defined in the environment where the
           <cite>
            makefile
           </cite>
           is run.
          </p>
          <div class="literal-block-wrapper docutils container" id="makefile">
           <div class="code-block-caption">
            <span class="caption-text">
             Makefile
            </span>
            <a class="headerlink" href="#makefile" title="Link to this code">
             
            </a>
           </div>
           <div class="highlight-Makefile notranslate">
            <div class="highlight">
             <pre><span></span><span class="linenos"> 1</span><span class="nv">LIBS</span><span class="o">=</span><span class="w"> </span>-lpthread<span class="w"> </span>-lm<span class="w"> </span><span class="c1">#Libraries used if needed</span>
<span class="linenos"> 2</span><span class="nv">SRCS</span><span class="o">=</span><span class="w"> </span>main.cpp<span class="w"> </span>func.cpp
<span class="linenos"> 3</span><span class="nv">BIN</span><span class="o">=</span>app
<span class="linenos"> 4</span><span class="nv">CFLAGS</span><span class="o">+=</span><span class="w"> </span>-g<span class="w"> </span>-O0
<span class="linenos"> 5</span><span class="nv">OBJS</span><span class="o">=</span><span class="k">$(</span>subst<span class="w"> </span>.cpp,.o,<span class="k">$(</span>SRCS<span class="k">))</span>
<span class="linenos"> 6</span><span class="nf">all </span><span class="o">:</span><span class="w"> </span><span class="k">$(</span><span class="nv">BIN</span><span class="k">)</span>
<span class="linenos"> 7</span><span class="nf">$(BIN)</span><span class="o">:</span><span class="w"> </span><span class="k">$(</span><span class="nv">OBJS</span><span class="k">)</span>
<span class="linenos"> 8</span><span class="w">    </span>@echo<span class="w"> </span><span class="o">[</span>link<span class="o">]</span><span class="w"> </span><span class="nv">$@</span>
<span class="linenos"> 9</span><span class="w">    </span><span class="k">$(</span>CXX<span class="k">)</span><span class="w"> </span>-o<span class="w"> </span><span class="nv">$@</span><span class="w"> </span><span class="k">$(</span>OBJS<span class="k">)</span><span class="w"> </span><span class="k">$(</span>LDFLAGS<span class="k">)</span><span class="w"> </span><span class="k">$(</span>LIBS<span class="k">)</span>
<span class="linenos">10</span><span class="nf">%.o</span><span class="o">:</span><span class="w"> </span>%.<span class="n">cpp</span>
<span class="linenos">11</span><span class="w">    </span>@echo<span class="w"> </span><span class="o">[</span>Compile<span class="o">]</span><span class="w"> </span>$&lt;
<span class="linenos">12</span><span class="w">    </span><span class="k">$(</span>CXX<span class="k">)</span><span class="w"> </span>-c<span class="w"> </span><span class="k">$(</span>CFLAGS<span class="k">)</span><span class="w"> </span>$&lt;<span class="w"> </span>-o<span class="w"> </span><span class="nv">$@</span>
<span class="linenos">13</span><span class="nf">clean</span><span class="o">:</span>
<span class="linenos">14</span><span class="w">    </span>@rm<span class="w"> </span>-f<span class="w"> </span><span class="k">$(</span>OBJS<span class="k">)</span><span class="w"> </span><span class="k">$(</span>BIN<span class="k">)</span>
</pre>
            </div>
           </div>
          </div>
          <div class="literal-block-wrapper docutils container" id="maincpp">
           <div class="code-block-caption">
            <span class="caption-text">
             main.cpp
            </span>
            <a class="headerlink" href="#maincpp" title="Link to this code">
             
            </a>
           </div>
           <div class="highlight-cpp notranslate">
            <div class="highlight">
             <pre><span></span><span class="linenos">1</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">"func.h"</span>
<span class="linenos">2</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iostream&gt;</span>
<span class="linenos">3</span><span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
<span class="linenos">4</span><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">b</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span>
<span class="linenos">5</span><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">"A is: "</span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">fun</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="linenos">6</span><span class="p">}</span>
</pre>
            </div>
           </div>
          </div>
          <div class="literal-block-wrapper docutils container" id="funch">
           <div class="code-block-caption">
            <span class="caption-text">
             func.h
            </span>
            <a class="headerlink" href="#funch" title="Link to this code">
             
            </a>
           </div>
           <div class="highlight-cpp notranslate">
            <div class="highlight">
             <pre><span></span><span class="linenos">1</span><span class="cp">#ifndef __FUNC_H</span>
<span class="linenos">2</span><span class="cp">#define __FUNC_H</span>
<span class="linenos">3</span><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="nf">fun</span><span class="p">(</span><span class="kt">int</span><span class="p">);</span>
<span class="linenos">4</span><span class="cp">#endif</span>
</pre>
            </div>
           </div>
          </div>
          <div class="literal-block-wrapper docutils container" id="funccpp">
           <div class="code-block-caption">
            <span class="caption-text">
             func.cpp
            </span>
            <a class="headerlink" href="#funccpp" title="Link to this code">
             
            </a>
           </div>
           <div class="highlight-cpp notranslate">
            <div class="highlight">
             <pre><span></span><span class="linenos">1</span><span class="kt">int</span><span class="w"> </span><span class="nf">fun</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">b</span><span class="p">){</span>
<span class="linenos">2</span><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">a</span><span class="o">=</span><span class="n">b</span><span class="o">*</span><span class="mi">2</span><span class="p">;</span>
<span class="linenos">3</span><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">a</span><span class="p">;</span>
<span class="linenos">4</span><span class="p">}</span>
</pre>
            </div>
           </div>
          </div>
          <p>
           In Eclipse select in the left part of the windows
           <cite>
            Import projects
           </cite>
           . A
new window is popup, select then
           <em>
            C/C++
           </em>
           and the option
           <em>
            Existing Code
as Makefile Project
           </em>
           . The window shown in
           <a class="reference internal" href="#import">
            <span class="std std-numref">
             Fig. 4.6
            </span>
           </a>
           is displayed. Complete
the name of the project, select the folder with the code and check
           <em>
            Cross GCC in Toolchain for Indexer Settings
           </em>
           .
          </p>
          <figure class="align-center" id="import">
           <a class="reference internal image-reference" href="_images/import.png">
            <img alt="_images/import.png" src="_images/import.png" style="width: 4.45148in; height: 4.95833in;"/>
           </a>
           <figcaption>
            <p>
             <span class="caption-text">
              Importing the code.
             </span>
             <a class="headerlink" href="#import" title="Link to this image">
              
             </a>
            </p>
           </figcaption>
          </figure>
         </section>
         <section id="building-a-project">
          <h3>
           Building a project
           <a class="headerlink" href="#building-a-project" title="Link to this heading">
            
           </a>
          </h3>
          <p>
           Once you have configured the cross-chain in Eclipse you can build your
project using Project-&gt;Build Project. If everything is correct, you will
see the eclipse project as represented in
           <a class="reference internal" href="#buildeclipse">
            <span class="std std-numref">
             Fig. 4.7
            </span>
           </a>
           . You can clean the
project (remove the executable and objects) with
           <em>
            Clean
           </em>
           .
          </p>
          <figure class="align-center" id="buildeclipse">
           <a class="reference internal image-reference" href="_images/eclipsebuild.png">
            <img alt="_images/eclipsebuild.png" src="_images/eclipsebuild.png" style="width: 6.69375in; height: 4.17014in;"/>
           </a>
           <figcaption>
            <p>
             <span class="caption-text">
              Eclipse project compiled (Binaries has been generated)
             </span>
             <a class="headerlink" href="#buildeclipse" title="Link to this image">
              
             </a>
            </p>
           </figcaption>
          </figure>
          <div class="admonition note">
           <p class="admonition-title">
            Note
           </p>
           <p>
            <strong>
             [Console in Eclipse]:
            </strong>
            Have a look at the messages displayed in the Console. You will see how eclipse is calling the cross compiler with different parameters.
           </p>
          </div>
         </section>
         <section id="moving-the-binary-to-the-target">
          <h3>
           Moving the binary to the target
           <a class="headerlink" href="#moving-the-binary-to-the-target" title="Link to this heading">
            
           </a>
          </h3>
          <p>
           In order to copy the executable to the target, you have different
options. You can use the Linux application called
           <cite>
            scp
           </cite>
           or other similar
applications. In our case, we are going to use the &ldquo;Other Locations&hellip;.&rdquo;
utility included in the nautilus explorer (
           <a class="reference internal" href="#scp">
            <span class="std std-numref">
             Fig. 4.8
            </span>
           </a>
           ). Specify in Server Address
           <cite>
            ssh://&lt;ip address&gt;
           </cite>
          </p>
          <figure class="align-center" id="scp">
           <a class="reference internal image-reference" href="_images/nautilesssh.png">
            <img alt="_images/nautilesssh.png" src="_images/nautilesssh.png" style="width: 5.57399in; height: 2.93365in;"/>
           </a>
           <figcaption>
            <p>
             <span class="caption-text">
              Connect to Server&rdquo; option in Nautilus explorer
             </span>
             <a class="headerlink" href="#scp" title="Link to this image">
              
             </a>
            </p>
           </figcaption>
          </figure>
         </section>
         <section id="executing-the-application">
          <h3>
           Executing the application
           <a class="headerlink" href="#executing-the-application" title="Link to this heading">
            
           </a>
          </h3>
          <p>
           You can run the Raspberry PI program using putty (remember that once you
have a network connection available in the RPI you can also use putty to
connect to it).
          </p>
          <figure class="align-center" id="putty">
           <a class="reference internal image-reference" href="_images/image29.png">
            <img alt="_images/image29.png" src="_images/image29.png" style="width: 4.45in; height: 2.90434in;"/>
           </a>
           <figcaption>
            <p>
             <span class="caption-text">
              Run test program in Raspberry Pi
             </span>
             <a class="headerlink" href="#putty" title="Link to this image">
              
             </a>
            </p>
           </figcaption>
          </figure>
          <div class="admonition warning">
           <p class="admonition-title">
            Warning
           </p>
           <p>
            Warning. If you experiment problems using ssh, delete the
            <cite>
             .ssh
            </cite>
            folder in your home directory.
           </p>
          </div>
         </section>
         <section id="automatic-debugging-using-gdb-and-gdbserver">
          <h3>
           Automatic debugging using gdb and gdbserver
           <a class="headerlink" href="#automatic-debugging-using-gdb-and-gdbserver" title="Link to this heading">
            
           </a>
          </h3>
          <p>
           You can directly debug the program running in the RPI using Eclipse.
There are two methods to do it: manually and automatically. In the
manual method, firstly, you need to copy the executable program to the
RPI, change the file permissions to &ldquo;executable&rdquo; and execute the program
to be debugged using
           <em>
            gdbserver
           </em>
           utility. Of course, this is a
time-consuming process and very inefficient. The alternative solution is
to use automatic debugging. In order to debug your applications, we need
to define a debug session and configure it. Firstly,
           <em>
            Select Run-&gt;Debug
Configurations
           </em>
           and generate a new configuration under
           <em>
            C/C++ Remote
Application
           </em>
           . You need to complete the different tabs available in this
window. The first one is the main tab (see Fig. 33). You need to
configure here the path to the C/C++ application to be debugged, the
project name, the connection with the target (you will need to create a
new one using the IP address of your RPI), the remote path where your
executable file will be downloaded, and the mode for the debugging
(Automatic Remote Debugging Launcher). Secondly, in the argument tab,
you can specify the arguments of your executable program. It is very
important here that you can also specify the working directory path
where the executable will be copied and launched (you need to have
rights in this folder).
          </p>
          <figure class="align-center" id="id1">
           <a class="reference internal image-reference" href="_images/image30.png">
            <img alt="_images/image30.png" src="_images/image30.png" style="width: 6.69375in; height: 3.94931in;"/>
           </a>
           <figcaption>
            <p>
             <span class="caption-text">
              Creating a Debug Configuration
             </span>
             <a class="headerlink" href="#id1" title="Link to this image">
              
             </a>
            </p>
           </figcaption>
          </figure>
          <p>
           In the debugger window you need to configure the path of your cross gdb
application. Remember that we are working with a cross-compiler, cross
debugging. Therefore, you need to provide here the correct path of your
gdb. The GDB command file (.gdbinit) must be specified, providing a path
with an empty file. In the Gdbserver settings tab, you need to provide
the path to the gdbserver in the target and the TCP/IP port used (by
default 2345).
          </p>
          <figure class="align-center" id="id2">
           <a class="reference internal image-reference" href="_images/eclipsedebug.png">
            <img alt="_images/eclipsedebug.png" src="_images/eclipsedebug.png" style="width: 6.03905in; height: 3.56303in;"/>
           </a>
           <figcaption>
            <p>
             <span class="caption-text">
              Debug configuration, including the path to locate the cross gdb tool.
             </span>
             <a class="headerlink" href="#id2" title="Link to this image">
              
             </a>
            </p>
           </figcaption>
          </figure>
          <p>
           Now, press Debug in Eclipse window, and you can debug your application
remotely.
          </p>
          <figure class="align-center" id="id3">
           <a class="reference internal image-reference" href="_images/image31.png">
            <img alt="_images/image31.png" src="_images/image31.png" style="width: 5.89423in; height: 3.67021in;"/>
           </a>
           <figcaption>
            <p>
             <span class="caption-text">
              Debugging session on the RPI remotely
             </span>
             <a class="headerlink" href="#id3" title="Link to this image">
              
             </a>
            </p>
           </figcaption>
          </figure>
         </section>
        </section>
        <span id="document-virtualmachine">
        </span>
        <section id="preparing-the-vmware-ubuntu-virtual-machine">
         <h2>
          Preparing the VMware Ubuntu Virtual Machine.
          <a class="headerlink" href="#preparing-the-vmware-ubuntu-virtual-machine" title="Link to this heading">
           
          </a>
         </h2>
         <section id="download-vmware-workstation-player">
          <h3>
           Download VMware Workstation Player.
           <a class="headerlink" href="#download-vmware-workstation-player" title="Link to this heading">
            
           </a>
          </h3>
          <p>
           The software can be downloaded from this
           <a class="reference external" href="https://support.broadcom.com/group/ecx/productdownloads?subfamily=VMware+Workstation+Pro">
            link
           </a>
           . Follow the instructions to set up the application on your computer.
          </p>
         </section>
         <section id="installing-ubuntu-24-04-01-lts-as-a-virtual-machine">
          <h3>
           Installing Ubuntu 24.04.01 LTS as a virtual machine.
           <a class="headerlink" href="#installing-ubuntu-24-04-01-lts-as-a-virtual-machine" title="Link to this heading">
            
           </a>
          </h3>
          <div class="admonition note">
           <p class="admonition-title">
            Note
           </p>
           <p>
            It is mandatory to install Ubuntu 24.04.01 LTS version. Use this link to download it
            <a class="reference external" href="http://ftp.rediris.es/sites/releases.ubuntu.com/noble">
             http://ftp.rediris.es/sites/releases.ubuntu.com/noble
            </a>
           </p>
          </div>
          <p>
           The first step is to download Ubuntu. You will download an
ISO image with this Linux operating System. Run WMware player and install
Ubuntu using the VMWare player instructions. Select the
           <em>
            Typical
           </em>
           configuration and
reserve at least 100G/150G for the hard disk.
In the hardware configuration select 8GByte of RAM, if possible 4 processors, and the USB 3.1 support.
The installation time will be half an hour, more or less, depending on
your computer. Moving a virtual machine from one computer to another is
a time-consuming task; therefore, take this into account to minimize the
development time.
          </p>
         </section>
         <section id="installing-synaptic">
          <h3>
           Installing synaptic
           <a class="headerlink" href="#installing-synaptic" title="Link to this heading">
            
           </a>
          </h3>
          <p>
           If you need to install software packages, you can do it using the linux
terminal command
           <em>
            apt-get
           </em>
           . Another alternative process is the use of the
synaptic utility. In order to use it, you need to install it using this
command:
          </p>
          <div class="highlight-bash notranslate">
           <div class="highlight">
            <pre><span></span>$<span class="w"> </span>sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>synaptic
</pre>
           </div>
          </div>
          <p>
           Once installed, you can search and execute the synaptic program. When
you click two times over the package, it will show all the dependent
packages that would be installed (see
           <a class="reference internal" href="#synaptic">
            <span class="std std-numref">
             Fig. 5.1
            </span>
           </a>
           ).
          </p>
          <figure class="align-center" id="synaptic">
           <a class="reference internal image-reference" href="_images/image32.png">
            <img alt="_images/image32.png" src="_images/image32.png" style="width: 6.69375in; height: 3.32431in;"/>
           </a>
           <figcaption>
            <p>
             <span class="caption-text">
              Synaptic window
             </span>
             <a class="headerlink" href="#synaptic" title="Link to this image">
              
             </a>
            </p>
           </figcaption>
          </figure>
         </section>
         <section id="installing-putty">
          <h3>
           Installing putty
           <a class="headerlink" href="#installing-putty" title="Link to this heading">
            
           </a>
          </h3>
          <p>
           You need to execute:
          </p>
          <ul class="simple">
           <li>
            <p>
             sudo apt-get install putty
            </p>
           </li>
          </ul>
         </section>
         <section id="installing-packages-for-supporting-buildroot">
          <h3>
           Installing packages for supporting Buildroot.
           <a class="headerlink" href="#installing-packages-for-supporting-buildroot" title="Link to this heading">
            
           </a>
          </h3>
          <p>
           Using buildroot requires some software packages that have to be
installed in the VM. These are listed in this link
           <a class="reference external" href="http://buildroot.uclibc.org/downloads/manual/manual.html#requirement">
            http://buildroot.uclibc.org/downloads/manual/manual.html#requirement
           </a>
           .
You need to install at least:
          </p>
          <ul class="simple">
           <li>
            <p>
             build-essential
            </p>
           </li>
           <li>
            <p>
             git
            </p>
           </li>
           <li>
            <p>
             libncurses-dev
            </p>
           </li>
          </ul>
         </section>
         <section id="installing-packages-supporting-eclipse">
          <h3>
           Installing packages supporting Eclipse
           <a class="headerlink" href="#installing-packages-supporting-eclipse" title="Link to this heading">
            
           </a>
          </h3>
          <p>
           Follow the instructions of this
           <a class="reference external" href="https://ubuntuhandbook.org/index.php/2021/05/install-eclipse-ide-ubuntu-21-04-20-04/">
            link
           </a>
           to install Eclipse.
Use the Eclipse C/C++ or the Eclipse for Embedded C/C++ developers.
          </p>
         </section>
        </section>
       </div>
      </section>
      <section id="indices-and-tables">
       <h1>
        Indices and tables
        <a class="headerlink" href="#indices-and-tables" title="Link to this heading">
         
        </a>
       </h1>
       <ul class="simple">
        <li>
         <p>
          <a class="reference internal" href="genindex.html">
           <span class="std std-ref">
            Index
           </span>
          </a>
         </p>
        </li>
       </ul>
      </section>
      <div class="clearer">
      </div>
     </div>
    </div>
   </div>
   <div class="clearer">
   </div>
  </div>
  <article id="back-cover">
   <div class="container">
    <div class="back-cover-footer">
     <p>
      &copy; Copyright Universidad Polit&eacute;cnica de Madrid.
     </p>
     <p>
      Created using
      <a href="http://sphinx-doc.org/">
       Sphinx
      </a>
      8.2.3.
     </p>
    </div>
   </div>
  </article>
 </body>
</html>
